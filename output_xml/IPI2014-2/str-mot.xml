<?xml version="1.0" encoding="utf-8"?>
<papers>
  <paper>
    <metadata>
      <annotation value="\Abst{Данное исследование посвящено проблеме построения агрегированных прогнозов объемов железнодорожных грузоперевозок. Для получения агрегированных прогнозов требуется кластеризовать временн${{ы}"/>
    </metadata>
    <fulltext>
      <literature/>
      <command value="\newcommand">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\KL">
              <braces/>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\mathrm">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="KL"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <text value="motrenko"/>
      <text value="ПОСТРОЕНИЕ АГРЕГИРОВАННЫХ ПРОГНОЗОВ ОБЪЕМОВ ЖЕЛЕЗНОДОРОЖНЫХ ГРУЗОПЕРЕВОЗОК C ИСПОЛЬЗОВАНИЕМ РАССТОЯНИЯ КУЛЬБАКА--ЛЕЙБЛЕРА$^*$"/>
      <text value="Построение агрегированных прогнозов объемов железнодорожных грузоперевозок"/>
      <text value="А."/>
      <text value="П. Мотренко, В."/>
      <text value="В. Стрижов"/>
      <text value="А."/>
      <text value="П. Мотренко$^1$, В."/>
      <text value="В. Стрижов$^2$"/>
      <command value="\titel">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\tit">
              <braces/>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\aut">
                    <braces/>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\autkol">
                          <braces/>
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <command value="\titkol">
                                <braces/>
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <command value="\renewcommand">
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <command value="\thefootnote">
                                            <braces/>
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <command value="\fnsymbol">
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <text value="footnote"/>
                                                    </braces>
                                                  </braces>
                                                  <braces/>
                                                  <braces/>
                                                </command>
                                              </braces>
                                            </braces>
                                          </command>
                                        </braces>
                                      </braces>
                                    </command>
                                  </braces>
                                </braces>
                              </command>
                            </braces>
                          </braces>
                        </command>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[1]{}"/>
        </braces>
      </command>
      <text value="Работа выполнена при поддержке РФФИ (грант 13-07-13139)."/>
      <command value="\renewcommand">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\thefootnote">
              <braces/>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\arabic">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="footnote"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[1]{}"/>
        </braces>
      </command>
      <text value="Московский физико-технический институт, anastasia.motrenko@gmail.com"/>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[2]{}"/>
        </braces>
      </command>
      <text value="Вычислительный центр Российской академии наук им."/>
      <text value="А."/>
      <text value="А. Дородницына, strijov@ccas.com"/>
      <command value="\vspace*">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="-6pt"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id1" value="$е ряды таким образом, чтобы распределения&#10;временн$"/>
      <command value="\acute">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\mbox">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="ы"/>
                </braces>
              </braces>
              <braces/>
              <braces/>
            </command>
            <formula id="id2" value="$х рядов внутри кластера совпадали. При решении задачи кластеризации&#10;требуется оценить близость между временн$"/>
            <command value="\acute">
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\mbox">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="ы"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                  <formula id="id3" value="$ми рядами, исходя из их эмпирических&#10;распределений. Вводится критерий принадлежности временн$"/>
                  <command value="\acute">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\mbox">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <text value="ы"/>
                            </braces>
                          </braces>
                          <braces/>
                          <braces/>
                        </command>
                        <formula id="id4" value="$х рядов одному&#10;распределению, основанный на расстоянии Кульбака--Лейблера между гистограммами&#10;временн$"/>
                        <command value="\acute">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <command value="\mbox">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="ы"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces/>
                              </command>
                              <formula id="id5" value="$х рядов. Приводится теоретическое и практическое исследование предложенного&#10;критерия. Решается задача кластеризации временн$"/>
                              <command value="\acute">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <command value="\mbox">
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <text value="ы"/>
                                        </braces>
                                      </braces>
                                      <braces/>
                                      <braces/>
                                    </command>
                                    <formula id="id6" value="$х рядов на основе матрицы парных&#10;расстояний между ними.}&#10;&#10;\KW{эмпирическая функция распределения; расстояние между гистограммами;&#10;расстояние Кульбака--Лейблера; задача двух выборок}&#10;&#10;\DOI{10.14357/19922264140209}&#10;&#10;\vskip 14pt plus 9pt minus 6pt&#10;&#10;      \thispagestyle{headings}&#10;&#10;      \begin{multicols}{2}&#10;&#10;            \label{st\stat}&#10;&#10;&#10;\section{Введение}&#10;Особенностью задачи прогнозирования объема погрузок по историческим данным о&#10;загружен\-ности железнодорожной сети различными группами грузов является&#10;необходимость определить оптимальный уровень&#10;детализации~\cite{Medvednikova2012, Motrenko2013}: по видам перевозимых грузов,&#10;по наборам станций, по кодам вагонов. Требуется получить прогноз как для объема&#10;погрузок в целом, так и для отдельных групп грузов. При этом спрогнозированный&#10;объем погрузок в целом может не совпадать с суммой прогнозов по отдельным группам.&#10;Для повышения согласованности полученных прогнозов&#10;предлагается~\cite{Medvdnikova2014} вместо прогноза &amp;lt;&amp;lt;в целом&amp;gt;&amp;gt; объединять ряды&#10;только в том случае, если их распределения совпадают, чтобы агрегированные данные&#10;имели тот же статистический смысл, что и исходные ряды. Для решения задачи&#10;агрегации временн$\acute{\mbox{ы}}$х рядов необходимо определить расстояние между&#10;временн$\acute{\mbox{ы}}$ми рядами&#10;таким образом, чтобы оно отражало близость эмпирических распределений между рядами.&#10;&#10;В литературе по математической статистике вводится множество коэффициентов,&#10;показывающих, что некоторые два распределения $P$ и~$Q$ близки друг к другу.&#10;Такие коэффициенты в различных источниках называются расстоянием между&#10;распределениями~\cite{Kullback1959}, мерами разделяющей&#10;информации~\cite{Chernoff1952}, мерами статистического&#10;расстояния~\cite{Kolmogorov1965}. В~работе~\cite{AliSilvey1966} описан метод&#10;порождения коэффициентов $d(P, Q)$ &amp;lt;&amp;lt;непохожести&amp;gt;&amp;gt; двух распределений, обладающих&#10;некоторыми стандартными свойствами, например:&#10;\begin{itemize}&#10;\item коэффициент $d(P, Q)$ должен быть определен на всех парах распределений&#10;с одним носителем;&#10;\item значение $d(P, Q)$ должно быть минимально при $P \hm= Q$;&#10;\item при любом измеримом преобразовании носителя распределений~$P$ и~$Q$&#10;расстояние между ними не увеличивается.&#10;\end{itemize}&#10;Идея метода~\cite{AliSilvey1966} заключается в том, чтобы рас\-смот\-реть&#10;различные выпуклые функции случайной величины $Q/P$.&#10;С~точки зрения распределения~$P$ математическое ожидание $Q/P$ независимо от~$Q$, а&#10;дисперсия стремится к нулю при $Q \hm\toP$. Также в~\cite{AliSilvey1966}&#10;показано, что многие известные функции расстояния могут быть получены этим методом.&#10;В~частности, им могут быть порождены все $f$-ди\-вер\-ген\-ции~\cite{scizar2004} и&#10;в том числе расстояние Куль\-ба\-ка--Лейб\-ле\-ра~\cite{Kullback1959}.&#10;В~работе~\cite{Gibs} приведено сравнение многих известных расстояний с&#10;точки зрения скорости схо\-ди\-мости эмпирического распределения к истинному,&#10;а также качественного поведения функции рас\-сто\-яния при сходимости. При решении&#10;задачи кластеризации в обработке изображений были введены меры~\cite{Mallows1972, Irpino}, основанные&#10;на метрике Вассерштейна.&#10;&#10;В работе~\cite{Medvednikova2012} для оценки близости распределений используется&#10;расстояние Кульбака--Лейблера между гистограммами, построенными по временн$\acute{\mbox{ы}}$м рядам.&#10;В~данной работе показано, что распределение расстояние Куль\-ба\-ка--Лейб\-ле\-ра между&#10;гис\-то\-грам\-ма\-ми из одного распределения в пределе ограничено сверху распределением~$\chi^2$.&#10;&#10;Предложен критерий для решения задачи двух выборок, основанный на расстоянии&#10;Куль\-ба\-ка--Лейб\-ле\-ра между гистограммами временн$\acute{\mbox{ы}}$х рядов. Продемонстрировано&#10;применение критерия к решению задачи двух выборок для различных пар распределений&#10;и показана его состоятельность.\linebreak Для набора временн$\acute{\mbox{ы}}$х рядов о железнодорожных&#10;грузоперевозках решается задача кластеризации с помощью алгоритма кратчайшего&#10;незамкнутого пути~\cite{Dvoenko1999} на основе матрицы парных\linebreak&#10;расстояний~\cite{StrijovRudakov, Dvoenko2013} между рядами. При решении задачи&#10;кластеризации ряды группируются по типу груза.&#10;&#10;\section{Постановка задачи}&#10;&#10;Задан набор временн$\acute{\mbox{ы}}$х рядов&#10;$\mathbf{X}\hm= \{\mathbf{x}_1, \dots, \mathbf{x}_S\}$, где каждый ряд&#10;$\mathbf{x}_j \hm= \{x_j(i)\in\mathbb{R}\}_{i = 1}^{m_j}$~--- это&#10;последовательность реализаций некоторого стационарного случайного процесса.&#10;Требуется кластеризовать набор&#10;\begin{multline}&#10;\label{eq:clastering}&#10;\mathbf{X} = \bigsqcup\limits_{k = 1}^{K} \mathbf{X}_k\,,\quad&#10;\mathbf{X}_k = \{\mathbf{x}_j,\,j\in \mathcal{A}_k\}\,,\\&#10;\{1,\dots , S\} =&#10;= \bigsqcup\limits_{k=1}^{K} \mathcal{A}_k\,,&#10;\end{multline}&#10;разбив набор $\mathbf{X}$ на $K$ наборов $\mathbf{X}_k$ временн$\acute{\mbox{ы}}$х&#10;рядов таких, что все ряды в $\mathbf{X}_k$ принадлежат одному и тому же&#10;распределению. Здесь $\mathcal{A}_k$~--- множество индексов временн$\acute{\mbox{ы}}$х рядов&#10;$k$-го кластера.&#10;&#10;В силу стационарности случайного процесса~$\mathbf{x}$&#10;пренебрежем последовательностью значений ряда~$\mathbf{x}$. Представим временной&#10;ряд~$\mathbf{x}$ как выборку~$X$ реализаций некоторой случайной величины с&#10;распределением~$P$:&#10;\begin{multline}&#10;\label{eq:TS2sample}&#10;X = \{x\in\mathbb{R} | \mbox{~для некоторого\ } i\in\{1, \dots, m\}:\\&#10; x(i) = x\}\,.&#10;\end{multline}&#10; Для решения задачи об агрегировании временн$\acute{\mbox{ы}}$х рядов~$\mathbf{x}$ и~$\mathbf{x}&amp;apos;$&#10; будем сравнивать гистограммы, построенные по выборкам~$X$ и~$X&amp;apos;$,&#10; сопоставленным каждому из рядов в соответствии с~\eqref{eq:TS2sample}.&#10; Опишем подробнее процедуру построения гистограммы.&#10;&#10; Пусть объемы выборок~$X$ и~$X&amp;apos;$ равны~$m$ и~$m&amp;apos;$ соответственно.&#10; Разобьем область значений случайной величины из~$P$ на $N$ промежутков&#10; $[a_{i}, a_{i+1}]$  и обозначим $p_i \hm= P(a_{i} \hm&amp;lt; x \hm\leq a_{i+1})$&#10; вероятность случайной величине с распределением~$P$ принять значение из $i$-го&#10; промежутка; $n_i$ и~$n&amp;apos;_i$~--- количество объектов выборок~$X$ и~$X&amp;apos;$, попавших&#10; в $i$-й промежуток. Обозначим $\hat{P}_{m}$ гистограмму, построенную по выборке~$X$&#10; объема~$m$ из распределения~$P$. Гистограмма~$\hat{P}_{m}$ задается&#10; набором оценок&#10;&#10; \noindent&#10;\begin{multline}&#10;\hat{P}_m(a_{i} &amp;lt; x \leq a_{i+1}) = \fr{n_{i}}{m} = \hat{p}_i\,,\\&#10;i = 1,\dots,N-1\,,&#10;\label{eq:hist}&#10;\end{multline}&#10; вероятности~$p_i$.&#10;&#10; Для решения задачи кластеризации~\eqref{eq:clastering} вос\-пользуемся&#10; алгоритмом нахождения кратчайшего незамкнутого пути между временными&#10; рядами. Результатом применения алгоритма является минимальное остовное дерево:&#10; граф  с $n-1$ ребрами, покрывающий все $n$ вершин, ребра которого обладают&#10; минимальной суммарной длиной. Удалив из минимального остовного дерева $K-1$&#10; самых длинных ребер, получим кластеризацию вершин графа на $K$ кластеров~$\mathbf{X}_k$.&#10; Вершинами графа являются исследуемые временн$\acute{\mbox{ы}}$е ряды~$\mathbf{x}_j$;&#10; длина ребра, соединяющего две вершины, равна расстоянию между соответствующими&#10; временн$\acute{\mbox{ы}}$ми рядами. Найдя расстояние между всеми парами рядов,&#10; получим матрицу парных расстояний~$D$. В~качестве расстояний между&#10; рядами~$\mathbf{x}_r$ и~$\mathbf{x}_s$ будем использовать симметризованное&#10; расстояние Куль\-ба\-ка--Лейб\-ле\-ра между&#10; гистограммами $\hat{P}_{m_r}$ и $\hat{P}_{m_s}$, построенными по&#10; временн$\acute{\mbox{ы}}$м рядам:&#10;   \begin{multline}&#10;   \label{eq:matKLdist}&#10;   D(r, s) = {}\\&#10;\hspace*{-1.5mm}{}=\fr{2m_rm_s}{m_r + m_s}\!\left(\!D_{\KL}(\hat{P}_{m_r}||\hat{P}_{m_s}) +&#10;   D_{\KL}(\hat{P}_{m_s}||\hat{P}_{m_r})\!\right)\!.\!\!\!\!&#10;   \end{multline}&#10;  Первый сомножитель в правой части снимает зависимость от объема выборки.&#10;  Необходимость его введения будет объяснена  в следующем разделе.&#10;&#10;Конечной целью кластеризации временн$\acute{\mbox{ы}}$х рядов с учетом расстояний между&#10;ними является повыше\-ние согласованности агрегированных прогнозов.&#10;Для оценки качества кластеризации будем рассматривать несогласованность&#10;\begin{equation}&#10;\label{eq:inconsistency}&#10;\delta(i) = \left|\sum\limits_k^{K} \mathbf{\hat{X}}_k(i) -&#10;\sum\limits_j^{n} \mathbf{\hat{x}}_j(i) \right|&#10;\end{equation}&#10; при прогнозировании  по наборам~$\mathbf{X}_k$ временн$\acute{\mbox{ы}}$х&#10; рядов и отдельным временн$\acute{\mbox{ы}}$м рядам~$\mathbf{x}_j$. Здесь&#10; $\hat{\mathbf{X}}_k(i)$~--- прогноз агрегированного ряда в момент~$i$;&#10; $\hat{x}_j(i)$~--- прогноз $j$-го ряда в момент времени~$i$.&#10; Чем меньше несогласованность, тем качественнее выполнена кластеризация.&#10; Очевидно, что наименьшее значение $\delta_{\min} \hm= 0$&#10; выражения~\eqref{eq:inconsistency} достигается при $K\hm= S$, поэтому&#10; предлагается ограничить чис\-ло~$K$ или ввести в~\eqref{eq:inconsistency}&#10; штраф $h(K)$ за его повышение:&#10;  $$&#10;  K = \argmin\limits_{K} \left(\sum\limits_{i = 1}^{m} \delta(i) + h(K)\right).&#10;  $$&#10;  В данной работе ограничимся рассмотрением предложенного критерия принадлежности&#10;  временн$\acute{\mbox{ы}}$х рядов к одному распределению и кластеризации&#10;  временн$\acute{\mbox{ы}}$х рядов на основе расстояния между \mbox{ними}.&#10;&#10;\section{Статистическая значимость расстояния Кульбака--Лейблера}&#10;\label{Sec:KLsignificance}&#10;&#10;Чтобы показать, что результаты кластеризации временн$\acute{\mbox{ы}}$х&#10;рядов на основе расстояния Кульбака--Лейб\-ле\-ра между ними статистически значимы,&#10;необходимо исследовать распределение рас\-сто\-яния Куль\-ба\-ка--Лейб\-ле\-ра между&#10;гистограммами, построенными по выборкам~$X$ и~$X&amp;apos;$ из одного распределения~$P$.&#10;В~данном разделе будет показано, что, хотя расстояние Кульбака--Лейблера не имеет&#10;предельного распределения, для него можно получить предельные оценки сверху.&#10;&#10;Пусть пока выборки $X$ и $X&amp;apos;$ имеют одинаковый объем~$m$. Рассмотрим расстояние&#10;$D_{\KL}(\hat{P}_m||\hat{P}&amp;apos;_{m})$ между гистограммами~$\hat{P}_m$ и~$\hat{P}&amp;apos;_m$.&#10;По определению расстояние Кульбака--Лейблера $D_{\KL}(Q||P)$&#10;между распределениями~$Q$ и~$P$ равно&#10;\begin{equation}&#10;\label{eq:dKL}&#10;D_{\KL}(Q||P) = \int P{f}\left(\fr{Q}{P}\right),&#10;\end{equation}&#10;где $f(t) \hm= t\ln{t}$. Функция~$f$ строго выпукла и дваж\-ды дифференцируема в&#10;единице, и, повторяя рассуждения из~\cite{scizar2004}, разложим подынтегральное&#10;выражение из правой части~\eqref{eq:dKL} по~$f$ в окрестности единицы:&#10;\begin{multline*}&#10;P(x)f\left(\fr{Q(x)}{P(x)}\right) = f(1) + f&amp;apos;(1)(Q(x) - P(x)) + {}\\&#10;{}+&#10;\fr{f&amp;apos;&amp;apos;(1)}{2}\,\fr{(Q(x)-P(x))^2}{P(x)} + P(x)o\left(\!\left(\fr{Q(x)}{P(x)} -&#10;1\right)^3\!\right),&#10;\end{multline*}&#10;где $f(1) = 0$;  $f&amp;apos;&amp;apos;(1) \hm= 1$.&#10;Подставив вместо~$Q$ распределение $\hat{P}_m$, определяемое~\eqref{eq:hist},&#10;и просуммировав по~$i$, получим соотношение:&#10;&#10;\noindent&#10;\begin{multline*}&#10;D_{\KL}(\hat{P}_m||P)  = \sum\limits_{i = 1}^{N}p_i{f}\left(&#10;\fr{\hat{p}_i}{p_i}\right) ={}\\&#10;{} = \fr{1}{2}\sum\limits_i^{N}\fr{(\hat{p}_i - p_i)^2}{p_i} +&#10;\sum\limits_{i = 1}^{N}p_i\cdot&#10;\varepsilon\left(\left(\fr{\hat{p}_i}{p_i} - 1\right)^3\right)\sim{}\\&#10;{}\sim&#10;\fr{1}{2m}\sum\limits_i^{N}\fr{(n_i - mp_i)^2}{mp_i}&#10;\end{multline*}&#10; и следующий предельный переход:&#10; \begin{multline}&#10; \label{eq:step1}&#10; 2m {D}_{\KL}(\hat{P}_m||Q) \sim m\sum\limits_{i=1}^{N}&#10; \fr{(\hat{p}_i - p_i)^2}{p_i} ={}\\&#10; {}=  \sum\limits_{i=1}^{N}\fr{(n_i - mp_i)^2}{mp_i}&#10; \rightarrow  \chi_{\mathcal{N}}^2\mbox{~~при~}m\rightarrow\infty\,.&#10; \end{multline}&#10;Докажем следующую теорему:&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Теорема~1.}\&#10;\textit{Случайная величина&#10;$"/>
                                    <text value="2m"/>
                                  </braces>
                                </braces>
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="D"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces>
                                  <text value="_"/>
                                </braces>
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <command value="\KL">
                                      <braces/>
                                      <braces>
                                        <text value="(Q||"/>
                                      </braces>
                                    </command>
                                    <command value="\hat">
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <text value="P"/>
                                        </braces>
                                      </braces>
                                      <braces/>
                                      <braces>
                                        <text value="_m)"/>
                                      </braces>
                                    </command>
                                    <command value="\hm"/>
                                    <command value="\rightarrow"/>
                                    <command value="\chi">
                                      <braces>
                                        <text value="_"/>
                                      </braces>
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <command value="\mathcal">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="N"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                            <braces/>
                                            <braces>
                                              <text value="^2"/>
                                            </braces>
                                          </command>
                                          <formula id="id7" value="$&#10;по распределению при $"/>
                                          <text value="m"/>
                                          <command value="\hm"/>
                                          <command value="\rightarrow"/>
                                          <command value="\infty"/>
                                          <formula id="id8" value="$}.&#10;&#10;&#10;\smallskip&#10;&#10;\noindent&#10;Д\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о\,.\ \&#10;Аналогично доказательству предельного перехода~\eqref{eq:step1}&#10;разложим $D_{\KL}(Q||\hat{P}_m)$ по степеням $f(t)$ вблизи единицы и получим:&#10;\begin{multline*}&#10;D_{\KL}(Q||\hat{P}_m) \sim \fr{1}{2} \sum\limits_{i=1}^{N}&#10;\fr{(\hat{P}_m(\xi_i) - Q(\xi_i))^2}{\hat{P}_m(\xi)} = {}\\&#10;{}=\fr{1}{2m}&#10;\sum\limits_{i=1}^{N}\fr{(n_i - mp_i)^2}{n_i}.&#10;\end{multline*}&#10;Пусть $G_m(x)$~--- функция распределения случайной величины&#10;$\sum\limits_{i=1}^{N} {(n_i - mp_i)^2}/(mp_i)$; $F_m(x)$~---&#10;случайной величины $\sum\limits_{i=1}^{N}{(n_i - mp_i)^2}/{n_i}$. Так как&#10;$G_m(x)$ сходится поточечно к $F_{\chi^2_{N-1}}$ при $m\hm\rightarrow\infty$, имеем:&#10;$$&#10;\left\vert G_m(x) - F_{\chi_{N-1}^2}\right\vert &amp;lt;&#10;\fr{\epsilon}{2} \quad \forall m &amp;gt; m&amp;apos;.&#10;$$&#10;&#10;Докажем, что $|G_m(x) - F_m(x)|\hm\rightarrow0$ при $m\hm\rightarrow\infty$.&#10;Для этого покажем, что $\forall \varepsilon\hm&amp;gt; 0$ найдется объем выборки~$m_0$&#10;такой, что для всех $m \hm&amp;gt; m_0$ выполняется&#10;\begin{equation}&#10;\mathrm{P}\left(\left|\fr{(n_i - mp_i)^2}{n_i} - \fr{(n_i - mp_i)^2}{mp_i}\right| \leq \frac{\varepsilon}{N}\right) &amp;gt; 1 - \varepsilon.&#10;\!\!&#10;\label{eq:statement}&#10;\end{equation}&#10;Согласно центральной предельной теореме,&#10;$$&#10;\fr{n_i - mp_i}{p_i(1-p_i)\sqrt{m}} \rightarrow \mathcal{N}(0,1)&#10;$$&#10;по распределению при $m\rightarrow \infty$,&#10;причем для скорости сходимости имеет место неравенство Берри--Эссеена:&#10;$$&#10;\left\vert Q_m(x) - \Phi(x)\right\vert \leq \fr{A}{\sqrt{m}}\,,&#10;$$&#10;где $Q_m(x)$~--- функция распределения величины&#10;$(n_i - mp_i)/(p_i(1-p_i)\sqrt{m})$;&#10;$\Phi(x)$~--- функция стандартного нормального распределения;&#10;$A$~--- некоторая константа. Тогда вероятность&#10;\begin{multline}&#10;\label{eq:CLT}&#10;\mathrm{P}\left(\left|\fr{n_i - mp_i}{p_i(1-p_i)\sqrt{m}}\right| &amp;lt;&#10;C\right) = Q_m(C) - Q_m(-C) \geq {}\\&#10;{}\geq 2\Phi(C) - 1 - \fr{2A}{\sqrt{m}}\,.&#10;\end{multline}&#10;Пусть, кроме того, выполняется $0 \hm&amp;lt; 1 \hm- p \hm\leq p_i \hm\leq p \hm&amp;lt; 1$.&#10;Тогда с вероятностью $\mathrm{P}_{C} \hm\geq 2\Phi(C)\hm- 1$ выполняется&#10;\begin{multline*}&#10;\left|\fr{(n_i - mp_i)^2}{n_i} - \fr{(n_i - mp_i)^2}{mp_i}\right| =&#10;\fr{|n_i - mp_i|^3}{mn_ip_i} \leq{}\\&#10;{}\leq \fr{C^3(1-p_i)^3p_i^2}{n_i}\sqrt{m} \leq&#10; \fr{C^3(1-p)^3p}{\sqrt{m} - C(1-p)}\,.&#10; \end{multline*}&#10;Обозначим $m_1 = [4C^2(1\hm-p)^2]$, тогда при $m\hm&amp;gt; m_1$ имеет место&#10;$\sqrt{m} \hm- C(1-p_i)&amp;gt; (1/2)\sqrt{m}$ и&#10;$$&#10;\left|\fr{(n_i - mp_i)^2}{n_i} - \fr{(n_i - mp_i)^2}{mp_i}\right| \leq&#10;\fr{2C^3(1-p_i)^3p_i}{\sqrt{m}}\,.&#10;$$&#10;Тогда для фиксированного~$\varepsilon$ определим&#10;\begin{gather*}&#10;C_{\varepsilon} = \fr{\epsilon^{1/3}m^{1/6}}{(1-p_i)(2p_iN)^{1/3}}\,;\\&#10;\mathrm{P}_m(\varepsilon) = 2\Phi(C_{\varepsilon}) - 1 - \fr{2A}{\sqrt{m}}\,.&#10;\end{gather*}&#10;При заданном $\varepsilon$ вероятность $\mathrm{P}_m(\varepsilon) \hm\rightarrow 1$&#10;при $m\hm\rightarrow\infty$, поэтому найдется~$m_2$ такое, что&#10;для любого $m \hm&amp;gt; m_2$ выполнено $\mathrm{P}_m(\varepsilon) \hm&amp;gt; 1 \hm- \varepsilon$.&#10;Выбрав $m_0 \hm= \max(m_1, m_2)$, получим утверждение~\eqref{eq:statement}.&#10;Тогда&#10;\begin{multline*}&#10;\left|\sum\limits_{i = 1}^{N}\fr{(n_i - mp)^2}{n_i} -&#10;\fr{(n_i - mp)^2}{mp} \right| \leq {}\\&#10;{}\leq&#10;\sum\limits_{i = 1}^{N}\left|\fr{(n_i - mp)^2}{n_i} - \fr{(n_i - mp)^2}{mp} \right|&#10;&amp;lt; \varepsilon \mbox{ при~}m &amp;gt; m_0.\hspace*{-5.0964pt}&#10;\end{multline*}&#10;&#10;Из только что доказанного следует, что $|F_m(x) \hm- G_m(x)| \hm\rightarrow 0 $&#10;при $m\hm\rightarrow 0$. Тогда $\forall \epsilon \hm&amp;gt; 0 \;\exists m&amp;apos;&amp;apos;:$&#10;при $m \hm&amp;gt; m&amp;apos;&amp;apos;$ выполняется&#10;\begin{multline*}&#10;\left\vert F_m(x) - F_{\chi^2_{N-1}}\right\vert&#10;&amp;lt; \left\vert F_m(x) - G_m(x)\right\vert + {}\\&#10;{}+\left\vert G_m(x) - F_{\chi^2_{N-1}}\right\vert&#10;&amp;lt; \fr{\epsilon}{2} + \fr{\epsilon}{2}\,.&#10;\end{multline*}&#10;&#10;&#10;\smallskip&#10;&#10;Доказанная теорема и утверждение~\eqref{eq:step1} позволяют получить&#10;оценки распределения случайных величин $2m{D}_{\KL}(\hat{P}_m||Q)$ и&#10;$2m{D}_{\KL}(Q||\hat{P}_m)$ при больших~$m$. Для решения задачи&#10;кластеризации~\eqref{eq:clastering} потребуется также исследовать&#10;поведение расстояния Куль\-ба\-ка--Лейблера&#10;${D}_{\KL}(\hat{P}_m||\hat{P}_l)$ между гистограммами, построенными по выборкам~$X$&#10;и~$X&amp;apos;$ различных длин~$m$ и~$l$. Воспользовавшись неравенством треугольника&#10;$$&#10;D_{\KL}(\hat{P}_m||\hat{P}_l)  \leq D_{\KL}(\hat{P}_m||Q)&#10;+ D_{\KL}(Q||\hat{P}_l)\,,&#10;$$&#10;получим следствия из теоремы~1.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Следствие~1.}&#10;$ 2m{D}_{\KL}(\hat{P}_m||\hat{P}&amp;apos;_m)  \leq \chi^2_{2\mathcal{N}}$ в&#10;пределе при $m\hm\rightarrow\infty$. \\&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Следствие 2.} Пусть выборки $X$, $X&amp;apos;$ растут таким образом, что&#10;$ {m}/{l} \hm\rightarrow \rho$,  $0 \hm&amp;lt; \rho \hm&amp;lt; \infty.$&#10;Тогда&#10;$$&#10;2\fr{ml}{m+l}{D}_{\KL}(\hat{P}_m||\hat{P}_l)  \leq \chi^2_{2\mathcal{N}}&#10;$$ в пределе при $m, l\hm\rightarrow\infty$.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;Д\,\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о\,.\ \&#10;Действительно, при выполнении условия  $ {m}/{l} \hm\rightarrow \rho$,&#10;$0 \hm&amp;lt; \rho \hm&amp;lt; \infty,$ имеем&#10; $$&#10; \fr{l}{m+l} \rightarrow \fr{1}{1 + \rho}\,;\enskip&#10; \fr{m}{m+l} \rightarrow \fr{\rho}{1 + \rho}\,;&#10; $$&#10;\begin{multline*}&#10;2\fr{ml}{m+l}D_{\KL}(\hat{P}_m||\hat{P}_l)  \leq \fr{l}{m+l}\,2mD_{\KL}(\hat{P}_m||Q)  + {}\\&#10;{}+&#10;\fr{m}{m+l}2lD_{\KL}(Q||\hat{P}_l) \rightarrow \chi^2_{2\mathcal{N}}\,.&#10;\end{multline*}&#10;&#10;&#10;\smallskip&#10;&#10;Обозначим величину $(2ml/(m+l))D_{\KL}(\hat{P}_m||\hat{P}&amp;apos;_m)$ через~$\xi_{m,l}$.&#10;Следствие~2 дает верхнюю оценку поведения случайной величины $\xi_{m,l}$ при&#10;больших~$m$ и~$l$, а именно: пусть $\eta\hm\sim \chi_{2\mathcal{N}}^2$, тогда при&#10;достаточно больших~$m$ и~$l$ для любого элементарного исхода~$w$&#10;из вероятностного пространства~$\Omega$ выполнено  $\xi_{m,l}(w) \hm&amp;lt; \eta(w)$.&#10;Следовательно, для любого $x\hm\in\mathbb{R}$ верно&#10;\begin{equation}&#10;\label{eq:KLchi}&#10;\mathrm{P}(\xi_{m,l} &amp;lt; x) \geq \mathrm{P}(\eta &amp;lt; x)\,.&#10;\end{equation}&#10;В следующем разделе покажем, как этот факт будет использоваться для&#10;проверки принадлежности временн$\acute{\mbox{ы}}$х рядов к одному распределению.&#10;&#10;&#10;&#10;&#10;\section{Проверка принадлежности временн$"/>
                                          <command value="\acute">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <command value="\mbox">
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <text value="ы"/>
                                                    </braces>
                                                  </braces>
                                                  <braces/>
                                                  <braces/>
                                                </command>
                                                <formula id="id9" value="$х рядов к~одному распределению}&#10;&#10;Для решения задачи агрегирования временн$\acute{\mbox{ы}}$х рядов~$\mathbf{x}$ и~$\mathbf{x}&amp;apos;$&#10;необходимо уметь принимать решение о принадлежности временн$\acute{\mbox{ы}}$х&#10;рядов к одному распределению. Опишем процедуру проверки гипотезы о принадлежности&#10;выборок~$X$ и~$X&amp;apos;$, составленных~\eqref{eq:TS2sample} из временн$\acute{\mbox{ы}}$х&#10;рядов~$\mathbf{x}$ и~$\mathbf{x}&amp;apos;$.&#10;Пусть нулевая гипотеза~$H_0$ состоит в принадлежности выборок~$X$ и~$X&amp;apos;$ к одному&#10;распределению:&#10;$$&#10;H_0: P(x) = P&amp;apos;(x)\,.&#10;$$&#10;Сформулируем критерий проверки гипотезы~$H_0$ при альтернативе&#10;$H_1:\,P(x) \hm\neq P&amp;apos;(x)$. Для этого определим критическую область $U(\alpha)$&#10;для статистики $t_{m,l}$ с уровнем значимости~$\alpha$:&#10; $$&#10; U(\alpha) = \left\{t: \bar{t}_{1 -\alpha} &amp;gt; t \mbox{~или~} t &amp;gt; \bar{t}_{\alpha}\right\}\,,&#10; $$&#10; где критическое значение $\bar{t}_{\alpha}$ определяется соотношением&#10; \begin{equation}&#10; \label{eq:talpha}&#10; \mathrm{P}(t &amp;gt; \bar{t}_{\alpha}| H_0) = \alpha\,.&#10; \end{equation}&#10; Так как предельное распределение величины~$\xi_{m,l}$ неизвестно,&#10; будем использовать критическую область, задаваемую распределением~$\chi_{2\mathcal{N}}^2$.&#10; Будем говорить, что данные отвергают гипотезу~$H_0$ в случае, если&#10; статистика~$t_{m,l}$ принадлежит критической области&#10; \begin{equation}&#10; \label{eq:Uchi2}&#10;U^{\chi^2}(\alpha) = \left\{&#10;t: \bar{t}^{\chi^2}_{1 -\alpha} &amp;gt; t \mbox{~или~} t &amp;gt; \bar{t}^{\chi^2}_{\alpha}\right\},&#10;\end{equation}&#10;где $\bar{t}^{\chi^2}$~---  критическое значение величины~$\chi_{2\mathcal{N}}^2$:&#10; $$&#10; \mathrm{P}(t &amp;gt; \bar{t}^{\chi^2}_{\alpha}| t\sim\chi^2_{2\mathcal{N}}) = \alpha\,.&#10; $$&#10;  Из неравенства~\eqref{eq:KLchi} и определения~\eqref{eq:talpha}&#10;  критических значений следует, что критические области~$U$ и~$U^{\chi^2}$&#10;  не сравнимы, т.\,е.\&#10; $$&#10; \bar{t}_{1-\alpha} &amp;lt; \bar{t}_{1-\alpha}^{\chi^2}\,; \quad&#10; \bar{t}_{\alpha} &amp;lt; \bar{t}_{\alpha}^{\chi^2}\,.$$&#10; Это означает, что возможны следующие ситуации.&#10; \begin{enumerate}&#10; \item Случай $\bar{t}_{1-\alpha}^{\chi^2} \hm&amp;lt; t_{m,l} \hm&amp;lt; \bar{t}_{\alpha}$,&#10; когда статистика~$t_{m,l}$ одновременно принадлежит истинной, но неизвестной&#10; критической области~$U$ и вычислимой критической области~$U^{\chi^2}$.&#10; \item Случай $\bar{t}_{1-\alpha} \hm&amp;lt; t_{m,l}\hm&amp;lt; \bar{t}_{1-\alpha}^{\chi^2}$,&#10; когда статистика~$t_{m,l}$ принадлежит истинной, но неизвестной критической&#10; области~$U$ и не принадлежит~$U^{\chi^2}$. Так как $t_{m,l}\hm\in\,U$,&#10; то с высокой вероятностью гипотеза~$H_0$ неверна и есть риск принять&#10; неверное решение об истинности гипотезы~$H_0$. Таким образом, зазор&#10; между $\bar{t}_{1-\alpha}$ и $\bar{t}_{1-\alpha}^{\chi^2}$ повышает вероятность&#10; ошибки второго рода.&#10;  \item Случай $\bar{t}_{\alpha} \hm&amp;lt; t_{m,l} \hm&amp;lt; \bar{t}_{\alpha}^{\chi^2}$,&#10;  когда статистика~$t_{m,l}$ попадает в~$U^{\chi^2}$, хотя на самом деле~$t_{m,l}$~не&#10;  принадлежит~$U$. В~этом случае велика вероятность, что $H_0$ верна, но&#10;  решение будет принято в пользу~$H_1$. Таким образом, зазор между&#10;  $\bar{t}_{\alpha}$ и $\bar{t}_{\alpha}^{\chi^2}$ повышает вероятность&#10;  ошибки первого рода.&#10; \end{enumerate}&#10;&#10; Второй случай разрешается следующим образом: использование симметризованного&#10; рас\-сто\-яния позволяет перейти от двусторонних критериев~$U$ и~$U^{\chi^2}$&#10; вида~\eqref{eq:Uchi2} к односторонним критериям:&#10;  $$&#10;  U_1(\alpha) = \left\{t: t &amp;gt; \bar{t}_{\alpha}\right\}\,;\quad&#10;  U_1^{\chi^2}(\alpha) = \left\{t: t &amp;gt; \bar{t}^{\chi^2}_{\alpha}\right\}.&#10;  $$&#10;  В этом случае $U_1^{\chi^2}\subseteq U_1$ и справедливо следствие:&#10;$$&#10;t_{m,l}\hm\in\,U_1^{\chi^2}\hm\Rightarrow t_{m,l}\hm\in U_1\,.&#10;$$&#10;&#10;  Кроме того, далее будет показано (теорема~2), что при увеличении объема&#10;  выборки~$m$ вероятность отклонить гипотезу~$H_0$ с помощью&#10;  критерия~\eqref{eq:Uchi2} в случае, если гипотеза~$H_0$ неверна, стремится&#10;  к единице.&#10;  Влияние третьего случая на возможность применения критерия~\eqref{eq:Uchi2}&#10;  для принятия нулевой гипотезы исследуется экспериментально. Эксперименты,&#10;  приведенные ниже и в разд.~5, показывают, что при истинности нулевой гипотезы области $U$ и $U^{\chi^2}$ достаточно близки для принятия верного решения.&#10;&#10;  \begin{figure*} %fig1&#10;\vspace*{1pt}&#10;\begin{center}&#10;\mbox{%&#10;\epsfxsize=164.559mm&#10;\epsfbox{str-1.eps}&#10;}&#10;\end{center}&#10;\vspace*{-9pt}&#10;\Caption{Гистограммы, построенные по двум выборкам из нормального&#10;распределения~(\textit{а}, \textit{б}) и зашумленного~(\textit{в}, \textit{г})&#10;и зависимость статистики~$"/>
                                                <text value="t_m"/>
                                                <formula id="id10" value="$&#10;от объема выборки~(\textit{д}, \textit{е})&#10;(cплошными кривыми отмечены границы доверительного интервала для~$"/>
                                                <text value="t_m$ при&#10;$"/>
                                                <command value="\alpha"/>
                                                <command value="\hm">
                                                  <braces>
                                                    <text value="= 0"/>
                                                  </braces>
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <text value=","/>
                                                    </braces>
                                                  </braces>
                                                  <braces/>
                                                  <braces>
                                                    <text value="1"/>
                                                  </braces>
                                                </command>
                                                <formula id="id11" value="$):&#10;\textit{1}~--- $"/>
                                                <command value="\overline">
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <text value="t"/>
                                                    </braces>
                                                  </braces>
                                                  <braces/>
                                                  <braces>
                                                    <text value="_"/>
                                                  </braces>
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <text value="1-"/>
                                                      <command value="\alpha">
                                                        <braces/>
                                                        <braces>
                                                          <text value="^"/>
                                                        </braces>
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <command value="\chi">
                                                              <braces>
                                                                <text value="^2"/>
                                                              </braces>
                                                              <braces/>
                                                              <braces>
                                                                <text value="/(2m)"/>
                                                              </braces>
                                                            </command>
                                                            <formula id="id12" value="$;&#10;\textit{2}~--- $"/>
                                                            <command value="\overline">
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <text value="t"/>
                                                                </braces>
                                                              </braces>
                                                              <braces/>
                                                              <braces>
                                                                <text value="_"/>
                                                              </braces>
                                                            </command>
                                                            <command value="\alpha">
                                                              <braces>
                                                                <text value="^"/>
                                                              </braces>
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <command value="\chi">
                                                                    <braces>
                                                                      <text value="^2"/>
                                                                    </braces>
                                                                    <braces/>
                                                                    <braces>
                                                                      <text value="/(2m)"/>
                                                                    </braces>
                                                                  </command>
                                                                  <formula id="id13" value="$;&#10;\textit{3}~--- $"/>
                                                                  <text value="t_m/(2m)"/>
                                                                  <formula id="id14" value="$}\label{fg:norm}&#10;\end{figure*}&#10;&#10;\paragraph*{Пример применения критерия~(12) при истин\-ности~{\boldmath{$H_0$}}.}&#10;На рис.~\ref{fg:norm} изображены гистограммы для двух выборок из стандартного нормального распределения&#10;(рис.~\ref{fg:norm},\,\textit{а} и~1,\,\textit{б})&#10;и стандартного нормального распределения с шумом&#10;$\varepsilon\hm\sim 0{,}1{R}[0,1]$ (рис.~\ref{fg:norm},\,\textit{в} и~1,\,\textit{г}),&#10;а также зависимость расстояния Кульбака--Лейблера&#10;$D_{\KL}(\hat{P}_{m}||\hat{P}&amp;apos;_{m})$ между дискретными распределениями,&#10;задаваемыми гистограммами~$\hat{P}_{m}$ и~$\hat{P}&amp;apos;_{m}$, между выборками&#10;одинакового объема~$m$  от объема выборки~$m$ и область допустимых значений&#10;с точки зрения критерия~\eqref{eq:Uchi2}&#10;(рис.~\ref{fg:norm},\,\textit{д} и 1,\,\textit{е}).&#10;Здесь вместо критических значений $\bar{t}^{\chi^2}_{1-\alpha}$,&#10;$\bar{t}^{\chi^2}_{\alpha}$ и $t_m \hm= 2m{D}_{\KL}$ отложены величины&#10;$\bar{t}^{\chi^2}_{1-\alpha}/(2m)$,  $\bar{t}^{\chi^2}_{\alpha}/(2m)$ и $t_m/(2m)$,&#10;чтобы продемонстрировать масштаб расстояния Кульбака--Лейблера и наличие&#10;сходимости. Рисунки показывают, что в данном случае использование&#10;распределения~$\chi_{2\mathcal{N}}^2$ в качестве оценки предельного распределения статистики~$t_m$&#10;позволяет принять верное решение о принадлежности рядов к одному  распределению.&#10;Кривые~\textit{1} и~\textit{3} показывают границу области, в которую вошло $1\hm- \alpha \hm= 90\%$&#10;выборки, и задают оценку критической области для&#10;$D_{\KL}(\hat{P}_m||\hat{P}&amp;apos;_m)$. Более подробно результаты описаны в разд.~5.&#10;&#10;&#10;&#10;Покажем теперь, что критерий~\eqref{eq:Uchi2} также можно использовать&#10;для отвержения гипотезы~$H_0$.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Теорема~2.}&#10;\textit{Критерий~\eqref{eq:Uchi2} состоятелен:&#10;$"/>
                                                                  <formula id="id15" value="$&#10;\lim\limits_{m\rightarrow\infty} \mathrm{P}(t_m \in U | H_1) = 1\,,&#10;$"/>
                                                                  <formula id="id16" value="$&#10;т.\,е.\ вероятность отвергнуть гипотезу~$"/>
                                                                  <text value="H_0"/>
                                                                  <formula id="id17" value="$, если распределения&#10;временн$"/>
                                                                  <command value="\acute">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <command value="\mbox">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value="ы"/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                          <braces/>
                                                                        </command>
                                                                        <formula id="id18" value="$х рядов~$"/>
                                                                        <text value="X$ и"/>
                                                                        <escaped value="~"/>
                                                                        <text value="$X&amp;apos;"/>
                                                                        <formula id="id19" value="$ не совпадают, с увеличением выборки стремится к единице.}&#10;&#10;\begin{figure*}[b] %fig2&#10;\vspace*{1pt}&#10;\begin{center}&#10;\mbox{%&#10;\epsfxsize=164.105mm&#10;\epsfbox{str-2.eps}&#10;}&#10;\end{center}&#10;\vspace*{-9pt}&#10;\Caption{Зависимость статистики~$"/>
                                                                        <text value="t_m"/>
                                                                        <formula id="id20" value="$ от объема выборки для различных пар&#10;распределений; сплошными кривыми отмечены границы доверительного интервала&#10;для~$"/>
                                                                        <text value="t_m$ при $"/>
                                                                        <command value="\alpha"/>
                                                                        <command value="\hm">
                                                                          <braces>
                                                                            <text value="= 0"/>
                                                                          </braces>
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value=","/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                          <braces>
                                                                            <text value="1"/>
                                                                          </braces>
                                                                        </command>
                                                                        <formula id="id21" value="$:&#10;(\textit{а})~$"/>
                                                                        <command value="\mathrm">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value="Exp"/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                        </command>
                                                                      </braces>
                                                                    </braces>
                                                                  </command>
                                                                </braces>
                                                              </braces>
                                                            </command>
                                                          </braces>
                                                        </braces>
                                                      </command>
                                                    </braces>
                                                  </braces>
                                                </command>
                                              </braces>
                                            </braces>
                                          </command>
                                        </braces>
                                      </braces>
                                    </command>
                                  </braces>
                                </braces>
                              </command>
                            </braces>
                          </braces>
                        </command>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <text value="(1)||"/>
      <command value="\mathrm">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="Exp"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="(1)"/>
      <formula id="id22" value="$;&#10;(\textit{б})~$"/>
      <command value="\mathrm">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="Exp"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="(1)||"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="N"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="(0,1)"/>
        </braces>
      </command>
      <formula id="id23" value="$;&#10;(\textit{в})~$"/>
      <command value="\mathrm">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="Exp"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="(1)||R(0,1)"/>
      <formula id="id24" value="$;&#10;(\textit{г})~$"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="N"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="(0,1)||"/>
        </braces>
      </command>
      <command value="\mathrm">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="Exp"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="(1)"/>
      <formula id="id25" value="$;&#10;(\textit{д})~$"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="N"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="(0,1)||"/>
        </braces>
      </command>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="N"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="(0,1)"/>
        </braces>
      </command>
      <formula id="id26" value="$;&#10;(\textit{е})~$"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="N"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="(0,1)||R(0,1)"/>
        </braces>
      </command>
      <formula id="id27" value="$;&#10;(\textit{ж})~$"/>
      <text value="R(0,1)||"/>
      <command value="\mathrm">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="Exp"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="(1)"/>
      <formula id="id28" value="$;&#10;(\textit{з})~$"/>
      <text value="R(0,1)||"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="N"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="(0,1)"/>
        </braces>
      </command>
      <formula id="id29" value="$;&#10;(\textit{и})~$"/>
      <text value="R(0,1)||R(0,1)"/>
      <formula id="id30" value="$&#10;\label{fg:others}}&#10;\end{figure*}&#10;&#10;&#10;\smallskip&#10;&#10;\noindent&#10;Д\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о\,.\ \&#10;Пусть функции распределения~$P$ и~$P&amp;apos;$ временн$\acute{\mbox{ы}}$х&#10;рядов не совпадают. Тогда найдется $x^{*}\hm\in\mathbb{R}$, при котором&#10;значения этих функций различны: $P(x^{*})\hm\neq P&amp;apos;(x^{*})$.&#10;Следовательно, найдется такой способ разбиения пространства~$\mathbb{R}$,&#10;что для некоторого~$i$ вероятность попадания в \mbox{$"/>
      <text value="i"/>
      <formula id="id31" value="$-й} промежуток не одинакова&#10;для рассматрива\-емых случайных величин:&#10;$$&#10;P(a_i &amp;lt; x \leq a_{i+1}) = p_i \neq p&amp;apos;_i = P&amp;apos;(a_i &amp;lt; x \leq a_{i+1})\,.&#10;$$&#10;Пусть $p_i &amp;gt; p&amp;apos;_i$. Согласно~\eqref{eq:CLT} при больших~$m$ с&#10;вероятностью~$\mathrm{P} \hm&amp;gt; (2\Phi(C_1)\hm- 1)(2\Phi(C_2) \hm- 1)$ выполнено&#10;$$&#10;\left\vert n_i - mp_i\right\vert &amp;lt; C_1\sqrt{m}\,; \quad&#10;\left\vert n&amp;apos;_i - mp&amp;apos;_i\right\vert &amp;lt; C_2\sqrt{m}\,.&#10;$$&#10;Для любого $\varepsilon &amp;gt; 0$ найдется константа&#10;$C_{\varepsilon}: \mathrm{P} \hm&amp;gt; (2\Phi(C_{\varepsilon}) \hm- 1)^2 \hm&amp;gt; 1 \hm- \varepsilon$.&#10;Выберем $C_1 \hm= C_2 \hm= C_{\varepsilon}$.&#10;Тогда $(n_i - n&amp;apos;_i) \hm&amp;gt; m(p_i \hm- p&amp;apos;_i) \hm+ O(\sqrt{m})$ и&#10;\begin{equation}&#10;\label{eq:O(m)}&#10;\fr{(n_i - n&amp;apos;_i)^2}{n_i} &amp;gt; m\fr{(p_i - p&amp;apos;_i)^2}{p_i} + O(\sqrt{m}) &amp;gt; Cm\,.&#10;\end{equation}&#10;Следовательно,  для любого $\alpha \hm\in (0,1)$ при достаточно больших~$m$&#10;$$&#10;t_m = 2mD_{\KL}(\hat{P_m^1}||\hat{P_m^2}) \sim&#10;\sum\limits_{i=1}\fr{(n_i - n&amp;apos;_i)^2}{n_i} &amp;gt; Cm &amp;gt; \bar{t}_{\alpha}&#10;$$&#10;с вероятностью $\mathrm{P} &amp;gt; 1 \hm- \epsilon$, т.\,е.\&#10;вероятность $\mathrm{P}(t_m \hm&amp;gt; \bar{t}_{\alpha}) \hm\rightarrow 1$ при&#10;$m \hm\rightarrow \infty$.&#10;&#10;&#10;\smallskip&#10;&#10;     \begin{figure*}[b] %fig3&#10;     \vspace*{1pt}&#10;\begin{center}&#10;\mbox{%&#10;\epsfxsize=163.363mm&#10;\epsfbox{str-3.eps}&#10;}&#10;\end{center}&#10;\vspace*{-9pt}&#10;\Caption{Зависимость фактического уровня значимости от объема выборки при различных уровнях&#10;значимости критерия~$"/>
      <command value="\chi">
        <braces>
          <text value="_"/>
        </braces>
        <braces>
          <braces>
            <text value="{}"/>
            <text value="2"/>
            <command value="\mathcal">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="N"/>
                </braces>
              </braces>
              <braces/>
              <braces/>
              <braces>
                <text value="^2"/>
              </braces>
            </command>
            <formula id="id32" value="$ (\textit{1}~--- $"/>
            <command value="\alpha"/>
            <command value="\hm">
              <braces>
                <text value="= 10^"/>
              </braces>
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="-1"/>
                </braces>
              </braces>
              <braces/>
            </command>
            <formula id="id33" value="$;&#10;\textit{2}~--- 10$"/>
            <text value="^"/>
          </braces>
        </braces>
        <braces>
          <braces>
            <text value="{}"/>
            <text value="-2"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id34" value="$; \textit{3}~--- $"/>
      <command value="\alpha"/>
      <command value="\hm">
        <braces>
          <text value="= 10^"/>
        </braces>
        <braces>
          <braces>
            <text value="{}"/>
            <text value="-3"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id35" value="$):&#10;(\textit{a})~$"/>
      <command value="\mathrm">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="Exp"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="(1)||"/>
      <command value="\mathrm">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="Exp"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="(1)"/>
      <formula id="id36" value="$;&#10;(\textit{б})~$"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="N"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="(0,1)||"/>
        </braces>
      </command>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="N"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="(0,1)"/>
        </braces>
      </command>
      <formula id="id37" value="$;&#10;(\textit{в})~$"/>
      <text value="R(0,1)||R(0,1)"/>
      <formula id="id38" value="$\label{fg:alpha}}&#10;\end{figure*}&#10;&#10;&#10;\section{Вычислительный эксперимент}\label{sec:CompExp}&#10;&#10;Работа критерия была рассмотрена на различных парах распределений.&#10;Для выбранной пары распределений повторялась следующая процедура:&#10; \begin{enumerate}[(1)]&#10; \item генерировались выборки~$X$ и~${X&amp;apos;}$ одинакового объема~$m$;&#10; \item по выборкам строились гистограммы~$\hat{P}_m$ и~$\hat{P}^\prime_m$&#10; с фиксированным числом разбиений $N \hm= 20$ и вычислялись расстояния&#10; Кульбака--Лейблера $D_{\KL}(\hat{P}_m || \hat{P}^\prime_m)$;&#10;     \item расстояния усреднялись по 1000~генерациям выборок;&#10;     \item объем $m$ выборки увеличивался.&#10;     \end{enumerate}&#10;     На каждом из графиков на рис.~\ref{fg:others} отложены рас\-сто\-яния&#10;     $D_{\KL}(\hat{P}_m | \hat{P}^\prime_m)$ в зависимости от объема выборки и&#10;     критические значения~$\bar{t}^{\chi^2}/(2m)$ при заданном уровне&#10;     значимости~$\alpha$. Заметим, что в случае различных распределений&#10;     расстояние $D_{\KL}(\hat{P}_m | \hat{P}^\prime_m)$ быстро попадает в критическую&#10;     область и характер его зависимости от~$m$ согласуется с&#10;     оценкой~\eqref{eq:O(m)}. Отрицательные значения, не характерные для&#10;     расстояния Куль\-ба\-ка--Лейб\-ле\-ра, возникают при чис\-лен\-ном приближении&#10;     интеграла~\eqref{eq:dKL}, когда распределение в знаменателе под знаком&#10;     логарифма\linebreak имеет большую область определения. Именно из-за отрицательных&#10;     значений был использован двусторонний критерий. В дальнейших экспериментах&#10;     было использовано симметризованное расстояние&#10;     Куль\-ба\-ка--Лейб\-ле\-ра~\eqref{eq:matKLdist}, что позволило использовать&#10;     односторонний критерий. На графиках, иллюстрирующих применение критерия&#10;     к выборкам из одного распределения (рис.~\ref{fg:others},\,\textit{а}, \textit{д}, \textit{и}),&#10;     также показаны штриховыми кривыми~\textit{1} и~\textit{2}&#10;     значения $\bar{t}/(2m)$, где $\bar{t}$~---&#10;     оценки критических значений, полученные экспериментально:&#10;     $$&#10;     \bar{t}_{\alpha} = \min\left\{\bar{t} : \fr{1}{M}\sum\limits_{t\in{T}} [t &amp;gt; \bar{t}]&#10;     &amp;lt; \alpha\right\}.&#10;     $$&#10;      Здесь суммирование индикаторной функции $[t \hm&amp;gt; \bar{t}]$ ведется по&#10;      всей выборке~$T$ статистик~$t$, полученных по~$M$ генерациям пар выборок~$X$&#10;      и~$X&amp;apos;$ (в данном эксперименте $M\hm= 1000$). Видно, что, хотя критические&#10;      области~$U^{\chi^2}$ и~$U$ не совпадают, при истинности гипотезы~$H_0$&#10;      статистика~$t_m$ не попадает ни в~$U^{\chi^2}$, ни в~$U$.&#10;&#10;&#10;\paragraph*{Оценка фактического значения~{\boldmath{$\alpha$}}.}&#10;Так как распределение статистики~$t_m$ не совпадает с распределением~${\chi^2}$,&#10;уровень значимости~$\alpha$, при котором определяется критическая&#10;область~$U^{\chi^2}$, не соответствует реальному уровню значимости критерия.&#10;Чтобы оценить реальный уровень значимости решения о принятии или отвержении&#10;гипотезы~$H_0$, необходимо подсчитать долю объектов выборки~$T$,&#10;попавших в~$U^{\chi^2}$ при заданном~$\alpha$:&#10;$$&#10;\hat{\alpha} = \fr{1}{M}\sum\limits_{t\in{T}} \left[t &amp;gt; \bar{t}^{\chi^2}_{\alpha}\right]\,.&#10;$$&#10; Результаты отражены на рис.~\ref{fg:alpha}. Из рисунков следует, что для&#10; достижения уровня значимости $\alpha \hm= 0{,}1$ нужно использовать в качестве&#10; оценки~$U$ критическую область~$U^{\chi^2}$ c уровнем значимости $\alpha\hm= 0{,}001$.&#10;&#10;&#10;&#10;\paragraph*{Кластеризация временн$"/>
      <command value="\acute">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\mbox">
              <braces>
                <braces>
                  <text value="{}"/>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <command value="\textbf">
        <braces>
          <text value="\textbf{}"/>
        </braces>
        <text value="ы"/>
      </command>
      <formula id="id39" value="$х рядов, отражающих железнодорожные&#10;грузоперевозки.}&#10;Продемонстрировав таким образом статистическую значимость рассто\-яния&#10;Куль\-ба\-ка--Лейб\-ле\-ра, построим кластеризацию набора временн$\acute{\mbox{ы}}$х рядов&#10;Российских железных дорог.&#10;Данные о перевозках включают даты отправления и прибытия, станции внутри&#10;железнодорожной ветки и группы грузов. Для исследования были выбраны временн$\acute{\mbox{ы}}$е&#10;ряды с весами вагонов, нагруженных различными группами грузов, агрегированные&#10;по станциям. Вначале из рассмотрения были исключены ряды, содержащие менее&#10;50~отсчетов времени.&#10;Матрицы~$D$ симметризованных расстояний Кульбака--Лейблера~\eqref{eq:matKLdist}&#10;для набора исследуемых временн$\acute{\mbox{ы}}$х рядов изображены на рис.~\ref{fg:matKLdist}.&#10;Решая задачу кластеризации~\eqref{eq:clastering}, необходимо стремиться при\-вес\-ти&#10;матрицу~$D$ к блочному виду. В~левом столбце таблицы показано, как именно&#10;перевозимые группы грузов были разбиты на кластеры для случая $K \hm= 5$.&#10;&#10;\end{multicols}&#10;&#10;\begin{figure} %fig4&#10;     \vspace*{1pt}&#10;\begin{center}&#10;\mbox{%&#10;\epsfxsize=161.515mm&#10;\epsfbox{str-4.eps}&#10;}&#10;\end{center}&#10;\vspace*{-9pt}&#10;\Caption{Симметризованные матрицы попарных расстояний Кульбака--Лейблера между&#10;временн$"/>
      <command value="\acute">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\mbox">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="ы"/>
                </braces>
              </braces>
              <braces/>
              <braces/>
            </command>
            <formula id="id40" value="$ми рядами для различных групп грузов: до кластеризации~(\textit{a})&#10;и после нее для $"/>
            <text value="K"/>
            <command value="\hm">
              <braces>
                <text value="= 5"/>
              </braces>
            </command>
            <formula id="id41" value="$~(\textit{б}) и  10~кластеров~(\textit{в})}&#10;\label{fg:matKLdist}&#10;\end{figure}&#10;&#10;\begin{table}\small&#10;\begin{center}&#10;\begin{tabular}{|p{7.8cm}||p{7.8cm}|}&#10;\multicolumn{2}{c}{Группы грузов}\\[6pt]&#10;\hline&#10; 1~--- Каменный уголь; 2~--- Кокс;  3~--- Нефть и нефтепродукты; 7~---&#10; Руда железная и марганцевая; 8~--- Руда цветная и серное сырье;&#10; 9~--- Черные металлы; 10~--- Метизы и оборудование; 11~---&#10; Металлические конструкции;  14~--- Сельскохозяйственные машины;&#10; 15~--- Автомобили; 16~--- Цветные металлы; изделия из них и лом цветных металлов;&#10; 17~--- Химические и минеральные удобрения; 18~--- Химикаты и сода;&#10; 20~--- Промышленное сырье и формовочные материалы; 22~--- Огнеупоры;&#10; 23~--- Цемент; 25~--- Сахар; 26~--- Мясо и масло животное; 27~--- Рыба;&#10; 28~--- Картофель, овощи и фрукты; 36~--- Комбикорма;  38~--- Жмыхи;&#10; 39~--- Бумага; 42~--- Грузы в контейнерах&#10; &amp;amp;&#10; 1~--- Каменный уголь; 2~--- Кокс;  3~--- Нефть и нефтепродукты;&#10; \textbf{6~--- Флюсы}; \textbf{21~--- Шлаки гранулированные}; 7~---&#10; Руда железная и марганцевая; 8~--- Руда цветная и серное сырье;&#10; 10~--- Метизы и оборудование; 11~--- Металлические конструкции;&#10; 12~--- Метизы; 14~--- Сельскохозяйственные машины; 15~--- Автомобили;&#10; 16~--- Цветные металлы, изделия из них и лом цветных металлов; 17~---&#10; Химические и минеральные удобрения; 18~--- Химикаты и сода;  20~---&#10; Промышленное сырье и формовочные материалы; 22~--- Огнеупоры; 23~---&#10; Цемент; 25~--- Сахар; 26~--- Мясо и масло животное; 27~--- Рыба; 28~---&#10; Картофель, овощи и фрукты; 36~--- Комбикорма;  38~--- Жмыхи;   39~---&#10; Бумага; 42~--- Грузы в контейнерах\\&#10;\hline&#10;43~--- Остальные и сборные грузы; 19~--- Строительные грузы&#10;&amp;amp;&#10;9~--- Черные металлы; 12~--- Метизы\\&#10;\hline&#10;31~--- Промышленные товары народного потребления; 34~--- Зерно&#10;&amp;amp;43~--- Остальные и сборные грузы; 19~--- Строительные грузы;&#10;35~--- Продукты перемола \\&#10;\hline&#10;13~--- Лом черных металлов&#10;&amp;amp;&#10;31~--- Промышленные товары народного потребления;&#10;\textbf{29~--- Поваренная соль}; 34~--- Зерно\\&#10;\hline&#10;35~--- Продукты перемола&#10;&amp;amp; 13~--- Лом черных металлов\\&#10;\hline&#10;\end{tabular}&#10;\end{center}&#10;\end{table}&#10;&#10;\begin{multicols}{2}&#10;&#10;Ряды, содержащие менее 50~отсчетов, последовательно присоединялись к&#10;каждому из рядов, содержавших более 50~отсчетов. Затем для объединенного&#10;ряда и исходного ряда длиной более 50~отсчетов проверялась гипотеза о&#10;при\-над\-леж\-ности  рядов к одному распределению. Результаты проверки гипотезы&#10;и значения статистики~$t_{m,l}$ изоб\-ра\-же\-ны на рис.~\ref{fg:KLtest},\,\textit{а},~\textit{б}.&#10;Строки соответствуют временн$\acute{\mbox{ы}}$м рядам длиной менее 50~отсчетов,&#10;столбцы~--- длиной более 50~отсчетов. Результат проверки гипотезы~$H_0$&#10;отмечен синим цветом, если гипотеза отвергается, красным~--- если гипотеза&#10;принимается. Было выполнено слияние рядов &amp;lt;&amp;lt;Поваренная соль&amp;gt;&amp;gt; и&#10;&amp;lt;&amp;lt;Продукты промышленного потребления&amp;gt;&amp;gt;, а также &amp;lt;&amp;lt;Флюсы&amp;gt;&amp;gt; и&#10;&amp;lt;&amp;lt;Шлаки гранулированные&amp;gt;&amp;gt; с временн$\acute{\mbox{ы}}$м рядом &amp;lt;&amp;lt;Нефть и нефтепродукты&amp;gt;&amp;gt;.&#10;Затем снова была выполнена кластеризация, результаты которой занесены в&#10;правый столбец таблицы. Вид матрицы парных расстояний после слияния&#10;временн$\acute{\mbox{ы}}$х рядов и их кластеризации представлен на&#10;рис.~\ref{fg:KLtest},\,\textit{в}.&#10;&#10;\begin{figure*} %fig5&#10;\vspace*{1pt}&#10;\begin{center}&#10;\mbox{%&#10;\epsfxsize=161.515mm&#10;\epsfbox{str-5.eps}&#10;}&#10;\end{center}&#10;\vspace*{-9pt}&#10;\Caption{Результат проверки гипотезы о принадлежности исходного временн$"/>
            <command value="\acute">
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\mbox">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="о"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                  <formula id="id42" value="$го&#10;ряда и временн$"/>
                  <command value="\acute">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\mbox">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <text value="о"/>
                            </braces>
                          </braces>
                          <braces/>
                          <braces/>
                        </command>
                        <formula id="id43" value="$го ряда, получаемого присоединением к нему&#10;некоторого более короткого ряда, к одному распределению~(\textit{а});&#10;значения статистики~$"/>
                        <text value="t_"/>
                      </braces>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="m,l"/>
                      </braces>
                    </braces>
                    <braces/>
                  </command>
                  <formula id="id44" value="$ при проверке гипотезы~$"/>
                  <text value="H_0"/>
                  <formula id="id45" value="$~(\textit{б});&#10;матрица парных расстояний после объединения временн$"/>
                  <command value="\acute">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\mbox">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <text value="ы"/>
                            </braces>
                          </braces>
                          <braces/>
                          <braces/>
                        </command>
                        <formula id="id46" value="$х рядов и их&#10;кластеризации~(\textit{в})}&#10;\label{fg:KLtest}&#10;\end{figure*}&#10;&#10;&#10;&#10;&#10;&#10;&#10;\section{Заключение}&#10;&#10;Расстояние Кульбака--Лейблера широко применяется для сравнения&#10;распределений, однако считается непригодным для использования в статистических&#10;целях из-за того, что не имеет предельного распределения.&#10;В~данной работе показано, что распределение расстояния Кульбака--Лейблера&#10;в пределе ограничено сверху хи-квад\-ра\-том. Это дает, пусть и ограниченную,&#10;возможность использования расстояния Куль\-ба\-ка--Лейб\-ле\-ра между распределениями&#10;в качестве статистики для проверки гипотезы о принадлежности двух выборок&#10;одному распределению и позволяет говорить о статистической значимости&#10;расстояния Куль\-ба\-ка--Лейб\-ле\-ра. Код, позволяющий выполнить процедуру проверки&#10;нулевой гипотезы о принадлежности выборок к одному распределению на основе&#10;расстояния Кульбака--Лейблера между их гистограммами, находится в свободном&#10;доступе~\cite{KLtestCode}. В~работе продемонстрировано использование&#10;предлагаемого критерия, а также приведен пример кластеризации временн$\acute{\mbox{ы}}$х&#10;рядов на основе расстояния Кульбака--Лейблера.&#10;&#10;{\small\frenchspacing&#10;{%\baselineskip=10.8pt&#10;\addcontentsline{toc}{section}{References}&#10;\begin{thebibliography}{99}&#10;\bibitem{Medvednikova2012}&#10;\Au{Вальков~А.\,С., Кожанов~Е.\,М., Медведникова~М.\,М., Хусаинов~Ф.\,И.}&#10;Непараметрическое прогнозирование загруженности системы железнодорожных&#10;узлов по историческим данным~// Машинное обучение и анализ данных,  2012.&#10;T.~1. №\,4. C.~448--465.&#10;    \bibitem{Motrenko2013}&#10;    \Au{Вальков~А.\,С., Кожанов~Е.\,М., Мотренко~А.\,П., Хусаинов~Ф.\,И.}&#10;    Построение кросс-корреляционных зависимостей при прогнозе загруженности&#10;    железнодорожного узла~// Машинное обучение и анализ данных,  2013.&#10;    T.~1. №\,5.  C.~505--518.&#10;    \bibitem{Medvdnikova2014}&#10;    \Au{Медведникова~М.\,М.}  Согласование агрегированных&#10;    непараметрических прогнозов временн$\acute{\mbox{ы}}$х рядов~// Машинное обучение и анализ&#10;    данных, 2014  (в печати). T.~1. №\,8.&#10;\bibitem{Kullback1959}&#10;\Au{Kullback S.} Information theory and statistics. --- New York: Wiley, 1959. 395~p.&#10;\bibitem{Chernoff1952}&#10;\Au{Chernoff H.}   A~measure of asymptotic efficiency for tests of a hypothesis&#10;based on the sum of observations~// Ann.  Math. Stat., 1952.&#10;Vol.~4. No.\,23. P.~493--655.&#10;\bibitem{Kolmogorov1965}&#10;\Au{Kolmogorov~A.\,N.} On the approximation of distributions of sums of&#10;independent summands by infinitely divisible distributions~//&#10;{Contributions to statistics}.~--- Oxford: Pergamon Press, 1965. P.~158--174.&#10;    \bibitem{AliSilvey1966}&#10;    \Au{Ali~S.\,M., Silvey~S.\,D.} A~general class of coefficients of&#10;    divergence of a distribution from another~// J.~R. Stat. Soc.&#10;    Ser.~B (Methodoligical),  1966. Vol.~1. No.\,28. P.~131--142.&#10;\bibitem{scizar2004}&#10;\Au{Csiszar I., Shields P.} Information theory and statistics: A~tutorial~//&#10;Foundations Trend Comm. Inform. Theory, 2004. No.\,4. P.~417--528.&#10;\bibitem{Gibs}&#10;\Au{Gibbs A.\,L., Su F.\,E.} On choosing and bounding probability&#10;metrics~// Intern. Stat. Rev., 2002. Vol.~3. No.\,70. P.~419--435.&#10;\bibitem{Mallows1972}&#10;\Au{Mallows C.}  A~note on asymptotic joint normality~//&#10;Ann. Math. Stat., 1972. Vol.~42. No.\,2. P.~508--515.&#10;    \bibitem{Irpino}&#10;    \Au{Irpino A., Verde R., Lechevallier~Y.}&#10;    Dynamic clustering of histograms using Wasserstein metric~//&#10;    Advances in computational statistics.~--- Heidelberg: Physica-Verlag, 2006. P.~869--876.&#10;\bibitem{Dvoenko1999}&#10;\Au{Двоенко~С.\,Д.} Неиерархический дивизимный алгоритм кластеризации~//&#10;Автоматика и телемеханика, 1999. №\,4. С.~117--123.&#10;&#10;\bibitem{StrijovRudakov}&#10;\Au{Стрижов~В.\,В., Кузнецов~М.\,П., Рудаков~К.\,В.} Метрическая&#10;кластеризация последовательностей аминокислотных остатков в ранговых шкалах~//&#10;Математическая биология и биоинформатика, 2012. Т.~7. №\,1. С.~345--359.&#10;\bibitem{Dvoenko2013}&#10;\Au{Двоенко~С.\,Д., Пшеничный~Д.\,О.} О~метрической коррекции мат\-риц&#10;парных сравнений~// Машинное\linebreak обучение и анализ данных, 2013.  T.~1. №\,5.  C.~606--620.&#10;&#10;\bibitem{KLtestCode}&#10;\Au{Мотренко~А.\,П.} Статистический тест для проверки гипотезы о&#10;принадлежности двух выборок одному распределению на основе расстония&#10;Кульбака--Лейблера~// Algorithms of machine learning.~---&#10;Sourceforge, 2014.&#10;{\sf&#10;http://sourceforge.net/p/mlalgorithms/ code/HEAD/tree/Group874/Motrenko2014KL/code/ KLtest.m}.&#10;&#10;&#10;\end{thebibliography}&#10;} }&#10;&#10;\end{multicols}&#10;&#10;\vspace*{-6pt}&#10;&#10;\hfill{\small\textit{Поступила в редакцию 12.13.14}}&#10;&#10;%\newpage&#10;&#10;&#10;\vspace*{12pt}&#10;&#10;\hrule&#10;&#10;\vspace*{2pt}&#10;&#10;\hrule&#10;&#10;&#10;\def\tit{OBTAINING AN AGGREGATED FORECAST OF RAILWAY FREIGHT TRANSPORTATION USING KULLBACK--LEIBLER DISTANCE}&#10;&#10;\def\titkol{Obtaining an aggregated forecast of railway freight transportation using Kullback--Leibler distance}&#10;&#10;\def\aut{A.\,P.~Motrenko$"/>
                        <text value="^1"/>
                        <formula id="id47" value="$ and~V.\,V.~Strijov$"/>
                        <text value="^2"/>
                        <formula id="id48" value="$}&#10;\def\autkol{A.\,P.~Motrenko and~V.\,V.~Strijov}&#10;&#10;&#10;\titel{\tit}{\aut}{\autkol}{\titkol}&#10;&#10;\vspace*{-9pt}&#10;&#10;\noindent&#10;$^1$Moscow Institute of Physics and Technology, 9 Institutskiy per., Dolgoprudny, Moscow Region 141700,&#10;Russian\\&#10;$\hphantom{^1}$Federation\\&#10;$^2$Dorodnicyn Computing Centre, Russian Academy of Sciences,&#10;40 Vavilov Str., Moscow 119333, Russian\\&#10;$\hphantom{^1}$Federation&#10;&#10;&#10;&#10;\def\leftfootline{\small{\textbf{\thepage}&#10;\hfill INFORMATIKA I EE PRIMENENIYA~--- INFORMATICS AND APPLICATIONS\ \ \ 2014\ \ \ volume~8\ \ \ issue\ 2}&#10;}%&#10; \def\rightfootline{\small{INFORMATIKA I EE PRIMENENIYA~--- INFORMATICS AND APPLICATIONS\ \ \ 2014\ \ \ volume~8\ \ \ issue\ 2&#10;\hfill \textbf{\thepage}}}&#10;&#10;\vspace*{6pt}&#10;&#10;\Abste{This study addresses the problem of obtaining an aggregated forecast&#10;of railway freight transportation. To improve the quality of aggregated&#10;forecast,  the time series clusterization problem is solved in such a way that the&#10;time series in each cluster belong to the same distribution. To solve the&#10;clusterization problem, it is necessary to estimate the distance between empirical&#10;distributions of the time series. A~two-sample test  based on&#10;the Kullback--Leibler distance between histograms of the time series is introduced.&#10;Theoretical and experimental research of the suggested test is provided. Also,&#10;as a demonstration, the clusterization of a set of railway time series based&#10;on the Kullback--Leibler distance between time series is obtained.}&#10;&#10;\KWE{empirical distribution function; distance between histograms;&#10;Kullback--Leibler distance; two-sample problem}&#10;&#10;\DOI{10.14357/19922264140209}&#10;&#10;\vspace*{-12pt}&#10;&#10;\Ack&#10;\noindent&#10;The work was supported by the Russian Foundation for Basic&#10;Research (grant No.\,13-07-13139).&#10;&#10;&#10;  \begin{multicols}{2}&#10;&#10;\renewcommand{\bibname}{\protect\rmfamily References}&#10;%\renewcommand{\bibname}{\large\protect\rm References}&#10;&#10;{\small\frenchspacing&#10;{%\baselineskip=10.8pt&#10;\addcontentsline{toc}{section}{References}&#10;\begin{thebibliography}{99}&#10;&#10;\bibitem{Medvednikova2012-1}&#10;\Aue{Val&amp;apos;kov, A.\,S., E.\,M.~Kozhanov, M.\,M.~Medvednikova, and F.\,I.~Khusainov}.&#10;2012. Neparametricheskoe prognozirovanie zagruzhennosti sistemy zheleznodorozhnykh uzlov&#10;po istoricheskim dannym [Nonparametric forecasting of railroad stations&#10;occupancy according to historical data].&#10;\textit{Mashinnoe Obuchenie i Analiz Dannykh}&#10;[J.~Machine Learning and Data Analysis] 4(1):448--465.&#10;&#10;\bibitem{Motrenko2013-1}&#10;\Aue{Val&amp;apos;kov, A.\,S., E.\,M.~Kozhanov, A.\,P.~Motrenko, and F.\,I.~Khusainov}.&#10;2013. Postroenie kross-korrelyatsionnykh zavisimostey pri prognoze zagruzhennosti&#10;zheleznodorozhnogo uzla [Constructing a cross-correlation model to forecast the&#10;utilization of a railway junction station].&#10;\textit{Mashinnoe Obuchenie i Analiz Dannykh}&#10;[J.~Machine Learning and Data Analysis]. 5(1):505--518.&#10;&#10;\bibitem{Medvdnikova2014-1}&#10;\Aue{Medvednikova, M.\,M.}  2014 (in press). Soglasovanie agregirovannykh&#10;neparametricheskikh prognozov vremennykh ryadov&#10;[Matching of aggeragared nonparametric forecasts of time series].&#10;\textit{Mashinnoe Obuchenie i Analiz Dannykh}&#10;[J.~Machine Learning and Data Analysis] 8(1). [In Russian.]&#10;&#10;\columnbreak&#10;&#10;\bibitem{Kullback1959-1}&#10;\Aue{Kullback,~S.}  1959. \textit{Information theory and statistics}.&#10;New York: Wiley. 395~p.&#10;\bibitem{Chernoff1952-1}&#10;\Aue{Chernoff,~H.} 1952. A~measure of asymptotic efficiency for tests of a&#10;hypothesis based on the sum of observations. \textit{Ann. Math. Stat.} 4(23):493--655&#10;\bibitem{Kolmogorov1965-1}&#10;\Aue{Kolmogorov, A.\,N.} 1965. On the approximation of&#10;distributions of sums of independent summands by infinitely divisible&#10;distributions.&#10;\textit{Contributions to statistics}. Oxford: Pergamon Press. P.~158--174.&#10;\bibitem{AliSilvey1966-1}&#10;\Aue{Ali, S.\,M., and S.\,D.~Silvey}. 1966.&#10;A~general class of coefficients of divergence of a distribution from another.&#10;\textit{J.~R. Stat. Soc. Series B (Methodoligical)} 1(28):131--142.&#10;\bibitem{scizar2004-1}&#10;\Aue{Csiszar,~I., and P.~Shields}. 2004. Information theory and statistics:&#10;A~tutorial. \textit{Foundations Trend Comm. Inform. Theory}&#10;4:417--528.&#10;\bibitem{Gibs-1}&#10;\Aue{Gibbs, A.\,L., and F.\,E.~Su}.  2002. On choosing and bounding probability&#10;metrics. \textit{Intern. Stat. Rev.} 3(70):419--435.&#10;\bibitem{Mallows1972-1}&#10;\Aue{Mallows,~C.} 1972. A~note on asymptotic joint normality.&#10;\textit{Ann. Math. Stat.} 42(2):508--515.&#10;&#10;\pagebreak&#10;&#10;\bibitem{Irpino-1}&#10;\Aue{Irpino,~A., R.~Verde, and Y.~Lechevallier}.  2006.&#10;Dynamic clustering of histograms using Wasserstein metric.&#10;\mbox{\textit{COMPSTAT}}. 869--876.&#10;\bibitem{Dvoenko1999-1}&#10;\Aue{Dvoenko, S.\,D.}&#10;1999. Neierarkhicheskiy divizimnyy algoritm klasterizatsii&#10;[Nonhierarchical divisible clasterization algorithm].&#10;\textit{Avtomatika i Telemekhanika} [Automation and Remote Control] 4:117--123.&#10;&#10;\bibitem{StrijovRudakov-1}&#10;\Aue{Strizhov, V.\,V., M.\,P.~Kuznetsov, and K.\,V.~Rudakov}.&#10;2012. Metricheskaya klasterizatsiya posledovatel&amp;apos;nostey aminokislotnykh&#10;ostatkov v rangovykh shkalakh [Metric clustering of sequences of amino acid&#10;residues in rank scales].&#10;\textit{Matematicheskaya Biologiya i Bioinformatika}\linebreak\vspace*{-12pt}&#10;&#10;\columnbreak&#10;&#10;\noindent&#10;[Mathematical Biology and Bioinformatics] 7(1):345--359.&#10;\bibitem{Dvoenko2013-1}&#10;\Aue{Dvoenko, S.\,D., and D.\,O~Pshenichnyy}.  2013.&#10;O~metricheskoy korrektsii matrits parnykh sravneniy&#10;[On metric correction of matrices of pairwise comparisons].&#10;\textit{Mashinnoe Obuchenie i Analiz Dannykh}&#10;[J.~Machine Learning and Data Analysis]  5(1):606--620.&#10;&#10;\bibitem{KLtestCode-1}&#10;\Aue{Motrenko, A.\,P.}  2014.&#10;Statisticheskiy test dlya proverki gipotezy o prinadlezhnosti dvukh vyborok&#10;odnomu raspredeleniyu na osnove rasstoniya Kul&amp;apos;baka--Leyblera&#10;[A~statistical test for the two-sampe problem based on the Kullback--Leibler&#10;distance]. {\sf http://sourceforge.net/ p/mlalgorithms/code/HEAD/tree/Group874/ Motrenko2014KL/code/KLtest.m}.&#10;&#10;\end{thebibliography}&#10;} }&#10;&#10;&#10;\end{multicols}&#10;&#10;\vspace*{-6pt}&#10;&#10;\hfill{\small\textit{Received March 12, 2014}}&#10;&#10;\vspace*{-18pt}&#10;&#10;&#10;&#10;&#10;\Contr&#10;&#10;\noindent&#10;\textbf{Motrenko Anastasia P.} (b.\ 1992)~---&#10;student, Moscow Institute of Physics and Technology, 9 Institutskiy per., Dolgoprudny, Moscow Region 141700,&#10;Russian Federation;   anastasia.motrenko@gmail.com&#10;&#10;\vspace*{3pt}&#10;&#10;\noindent&#10;\textbf{Strijov Vadim V.} (b.\ 1967)~---&#10;Candidate of science (PhD) in physics and mathematics, associate professor,&#10;scientist, Dorodnicyn Computing Center, Russian Academy of Sciences,&#10;40 Vavilov Str., Moscow 119333, Russian Federation;   strijov@ccas.com&#10;&#10; \label{end\stat}&#10;&#10;\renewcommand{\bibname}{\protect\rm Литература}"/>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
    </fulltext>
  </paper>
</papers>