<?xml version="1.0" encoding="utf-8"?>
<papers>
  <paper>
    <metadata>
      <author value="\index{}"/>
      <author value="\index{}"/>
      <annotation value="\Abst{Рассматривается задача одновременного прогнозирования набора временн${{ы}"/>
    </metadata>
    <fulltext>
      <literature/>
      <command value="\newcommand">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\hx">
              <braces/>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\hat">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="x"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                  <command value="\newcommand">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\hy">
                          <braces/>
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <command value="\hat">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="y"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces/>
                              </command>
                              <command value="\newcommand">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <command value="\uu">
                                      <braces/>
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <command value="\mathbf">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="u"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                            <braces/>
                                          </command>
                                          <command value="\newcommand">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <command value="\x">
                                                  <braces/>
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <command value="\mathbf">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <text value="x"/>
                                                          </braces>
                                                        </braces>
                                                        <braces/>
                                                        <braces/>
                                                      </command>
                                                      <command value="\newcommand">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <command value="\hchi">
                                                              <braces/>
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <command value="\hat">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <command value="\boldsymbol">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <command value="\chi">
                                                                                <braces/>
                                                                                <braces/>
                                                                                <braces/>
                                                                              </command>
                                                                              <command value="\newcommand">
                                                                                <braces>
                                                                                  <braces>
                                                                                    <text value="{}"/>
                                                                                    <command value="\hphi">
                                                                                      <braces/>
                                                                                      <braces>
                                                                                        <braces>
                                                                                          <text value="{}"/>
                                                                                          <command value="\hat">
                                                                                            <braces>
                                                                                              <braces>
                                                                                                <text value="{}"/>
                                                                                                <command value="\boldsymbol">
                                                                                                  <braces>
                                                                                                    <braces>
                                                                                                      <text value="{}"/>
                                                                                                      <command value="\varphi">
                                                                                                        <braces/>
                                                                                                        <braces/>
                                                                                                        <braces/>
                                                                                                      </command>
                                                                                                      <command value="\newcommand">
                                                                                                        <braces>
                                                                                                          <braces>
                                                                                                            <text value="{}"/>
                                                                                                            <command value="\weight">
                                                                                                              <braces/>
                                                                                                              <braces>
                                                                                                                <braces>
                                                                                                                  <text value="{}"/>
                                                                                                                  <command value="\mathbf">
                                                                                                                    <braces>
                                                                                                                      <braces>
                                                                                                                        <text value="{}"/>
                                                                                                                        <text value="a"/>
                                                                                                                      </braces>
                                                                                                                    </braces>
                                                                                                                    <braces/>
                                                                                                                    <braces/>
                                                                                                                  </command>
                                                                                                                  <command value="\newcommand">
                                                                                                                    <braces>
                                                                                                                      <braces>
                                                                                                                        <text value="{}"/>
                                                                                                                        <command value="\pcd">
                                                                                                                          <braces/>
                                                                                                                          <braces>
                                                                                                                            <braces>
                                                                                                                              <text value="{}"/>
                                                                                                                              <text value="p("/>
                                                                                                                              <command value="\cdot">
                                                                                                                                <braces>
                                                                                                                                  <text value=")"/>
                                                                                                                                </braces>
                                                                                                                                <braces/>
                                                                                                                              </command>
                                                                                                                              <command value="\newcommand">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <command value="\q">
                                                                                                                                      <braces/>
                                                                                                                                      <braces>
                                                                                                                                        <braces>
                                                                                                                                          <text value="{}"/>
                                                                                                                                          <text value="q("/>
                                                                                                                                          <command value="\cdot">
                                                                                                                                            <braces>
                                                                                                                                              <text value=")"/>
                                                                                                                                            </braces>
                                                                                                                                            <braces/>
                                                                                                                                          </command>
                                                                                                                                        </braces>
                                                                                                                                      </braces>
                                                                                                                                    </command>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                              </command>
                                                                                                                            </braces>
                                                                                                                          </braces>
                                                                                                                        </command>
                                                                                                                      </braces>
                                                                                                                    </braces>
                                                                                                                  </command>
                                                                                                                </braces>
                                                                                                              </braces>
                                                                                                            </command>
                                                                                                          </braces>
                                                                                                        </braces>
                                                                                                      </command>
                                                                                                    </braces>
                                                                                                  </braces>
                                                                                                </command>
                                                                                              </braces>
                                                                                            </braces>
                                                                                          </command>
                                                                                        </braces>
                                                                                      </braces>
                                                                                    </command>
                                                                                  </braces>
                                                                                </braces>
                                                                              </command>
                                                                            </braces>
                                                                          </braces>
                                                                        </command>
                                                                      </braces>
                                                                    </braces>
                                                                  </command>
                                                                </braces>
                                                              </braces>
                                                            </command>
                                                          </braces>
                                                        </braces>
                                                      </command>
                                                    </braces>
                                                  </braces>
                                                </command>
                                              </braces>
                                            </braces>
                                          </command>
                                        </braces>
                                      </braces>
                                    </command>
                                  </braces>
                                </braces>
                              </command>
                            </braces>
                          </braces>
                        </command>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <text value="stenina"/>
      <text value="СОГЛАСОВАНИЕ ПРОГНОЗОВ ПРИ РЕШЕНИИ ЗАДАЧ ПРОГНОЗИРОВАНИЯ ИЕРАРХИЧЕСКИХ ВРЕМЕННЫХ РЯДОВ$^*$"/>
      <text value="Согласование прогнозов при решении задач прогнозирования иерархических временных рядов"/>
      <text value="М."/>
      <text value="М. Стенина$^1$, В."/>
      <text value="В. Стрижов$^2$"/>
      <text value="М."/>
      <text value="М. Стенина, В."/>
      <text value="В. Стрижов"/>
      <command value="\titel">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\tit">
              <braces/>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\aut">
                    <braces/>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\autkol">
                          <braces/>
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <command value="\titkol">
                                <braces/>
                              </command>
                            </braces>
                          </braces>
                        </command>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <text value="Стенина М."/>
      <text value="М."/>
      <text value="Стрижов В."/>
      <text value="В."/>
      <braces>
        <text value="{}"/>
        <command value="\renewcommand">
          <braces>
            <braces>
              <text value="{}"/>
              <command value="\thefootnote">
                <braces/>
                <braces>
                  <braces>
                    <text value="{}"/>
                    <command value="\fnsymbol">
                      <braces>
                        <braces>
                          <text value="{}"/>
                          <text value="footnote"/>
                        </braces>
                      </braces>
                      <braces/>
                      <braces/>
                    </command>
                  </braces>
                </braces>
              </command>
            </braces>
          </braces>
        </command>
      </braces>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[1]{}"/>
        </braces>
      </command>
      <text value="Работа выполнена при финансовой поддержке РФФИ (проект 13-07-13139)."/>
      <command value="\renewcommand">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\thefootnote">
              <braces/>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\arabic">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="footnote"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[1]{}"/>
        </braces>
      </command>
      <text value="Московский физико-технический институт, Национальный исследовательский университет &amp;lt;&amp;lt;Высшая школа экономики&amp;gt;&amp;gt;, mmedvednikova@gmail.com"/>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[2]{}"/>
        </braces>
      </command>
      <text value="Вычислительный центр Российской академии наук им."/>
      <text value="А."/>
      <text value="А. Дородницына, strijov@ccas.com"/>
      <formula id="id1" value="$х рядов, объединенных в~иерархическую&#10;многоуровневую структуру. Требуется, чтобы полученные прогнозы&#10;удовлетворяли физическим ограничениям и~структуре иерархии.&#10;Предложен алгоритм согласования прогнозов иерархических&#10;временн$"/>
      <command value="\acute">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\mbox">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="ы"/>
                </braces>
              </braces>
              <braces/>
              <braces/>
            </command>
            <formula id="id2" value="$х рядов GTOp (Game-theoretically optimal reconciliation),&#10;гарантирующий неухудшение качества прогнозов после проведения&#10;процедуры согласования по сравнению с~качеством прогнозов,&#10;полученных для каждого временн$"/>
            <command value="\acute">
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\mbox">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="о"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                  <formula id="id3" value="$го ряда независимо. Подход&#10;базируется на поиске равновесия Нэша в~антагонистической игре&#10;заданного вида и~сводит задачу согласования прогнозов к~задаче&#10;оптимизации с~ограничениями типа равенства и~неравенства.&#10;Доказывается, что при выполнении ряда общих предположений&#10;о~свойствах структуры иерархии, физических ограничений и~функции&#10;потерь в~игре существует равновесие Нэша в~чистых стратегиях.&#10;Работа алгоритма демонстрируется на разных типах иерархических&#10;структур с~использованием данных посуточной загруженности&#10;железнодорожных узлов.}&#10;&#10;&#10;\KW{иерархические временн$"/>
                  <command value="\acute">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\mbox">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <text value="ы"/>
                            </braces>
                          </braces>
                          <braces/>
                          <braces/>
                        </command>
                        <formula id="id4" value="$е ряды;&#10;согласование прогнозов временн$"/>
                        <command value="\acute">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <command value="\mbox">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="ы"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces/>
                              </command>
                              <formula id="id5" value="$х рядов; антагонистическая игра;&#10;равновесие Нэша}&#10;&#10;\DOI{10.14357/19922264150209}&#10;&#10;\vspace*{6pt}&#10;&#10;&#10;\vskip 14pt plus 9pt minus 6pt&#10;&#10;\thispagestyle{headings}&#10;&#10;\begin{multicols}{2}&#10;&#10;\label{st\stat}&#10;&#10;&#10;&#10;\section{Введение}&#10;&#10;Рассматривается задача одновременного прогнозирования набора&#10;временн$\acute{\mbox{ы}}$х рядов, связанных в~иерархическую многоуровневую&#10;структуру, в~которой временн$\acute{\mbox{ы}}$е ряды каждого следующего (бо-\linebreak лее&#10;высокого) уровня формируются путем поэлементного суммирования&#10;некоторой части (возможно, всех) временн$\acute{\mbox{ы}}$х рядов предыдущего&#10;уровня.&#10;%&#10;Используемые при решении этой задачи принцип равновесия&#10;и~регрессионные методы широко обсуждаются в~научной литературе,&#10;в~том числе на~страницах журнала&#10;&amp;lt;&amp;lt;Информатика и~её~применения&amp;gt;&amp;gt;~\cite{tokmakova2012hyper, vasilyev2014using}.&#10;&#10;Задача прогнозирования иерархических вре\-мен\-н$\acute{\mbox{ы}}$х рядов&#10;возникает в~различных прикладных областях. В~\cite{hong2014global}&#10;описан конкурс, проведенный в~2012~г.\ на Kaggle~\cite{kaggle},&#10;в~котором одной из задач было прогнозирование иерархических&#10;временн$\acute{\mbox{ы}}$х рядов с~требованием согласования прогнозов по иерархии.&#10;В~работе~\cite{hyndman2011optimal} обсуждается задача&#10;прогнозирования туристической активности по регионам и~целям&#10;поездок. В~статье \cite{kuznetsov2011smoothing} решается задача&#10;прогнозирования потребительского спроса на различные группы&#10;товаров в~ряде магазинов. В~\cite{stenina2014reconciliation}&#10;решается задача согласования прогнозов объемов железнодорожных&#10;перевозок различных типов грузов по ряду железнодорожных веток.&#10;&#10;В связи с~высоким интересом к~задаче разными авторами предлагаются&#10;различные подходы к~ее решению. Как правило, сперва получают&#10;ка\-ким-ли\-бо образом прогнозы всех (или некоторой части) временн$\acute{\mbox{ы}}$х&#10;рядов независимо друг от друга, а~затем корректируют (согласуют)&#10;эти прогнозы.&#10;&#10;Самыми простыми и~самыми распространенными способами&#10;согласования являются нисходящий (top-down) и~восходящий&#10;(bottom-up) подходы~[8--15]. Нисходящий подход&#10;предполагает получение прогноза на верхнем уровне иерархии&#10;(агрегированный временной ряд), а~затем деагрегирование этого&#10;прогноза на сле\-ду\-ющий (более низкий) уровень иерархии на основании&#10;долей, наблюдаемых в~истории. Восходящий подход использует&#10;прогнозы временн$\acute{\mbox{ы}}$х рядов нижнего уровня иерархии&#10;(неагрегированных), из которых получает прогнозы рядов из верхних&#10;уровней путем агрегирования. Также встречаются подходы,&#10;комбинирующие нисходящий и~восходящий.&#10;&#10;Нет единой точки зрения на то, какой из этих подходов позволяет&#10;получать более точные прогнозы. Наиболее ранние исследования&#10;проведены в~работе~\cite{grunfeld1960aggregation}, где авторы&#10;считают, что неагрегированные данные содержат много ошибок и~поэтому нисходящее прогнозирование дает более точные прогнозы.&#10;К~таким же выводам приходят авторы работ~\cite{fogarty1991production, narasimhan1995production}. В~\cite{fliedner1999investigation} также утверждается, что&#10;агрегированные прогнозы более точны. С~другой стороны, в~\cite{orcutt1968data, edwards1969should} обсуждается, что основные&#10;потери информации происходят при агрегировании и~поэтому&#10;восходящий подход предпочтительнее. В~\cite{shlifer1979aggregation} сравниваются оба подхода к~согласованию прогнозов и~утверждается, что восходящий&#10;предпочтительнее при выполнении некоторых условий на структуру&#10;иерархии и~горизонт прогноза. В~\cite{schwarzkopf1988top}&#10;исследуется смещение и~устойчивость прогнозов, получаемых с~помощью обоих подходов, и~заключается, что восходящий  надежнее,&#10;за исключением случаев с~пропусками значений и~выбросами на нижних&#10;уровнях иерархии.&#10;&#10;Авторы статьи~\cite{hyndman2011optimal} обобщают нисходящий и~восходящий подходы к~согласованию иерархических прогнозов&#10;и предлагают оптимальное согласование с~использованием регрессии,&#10;позволяющей согласовывать одновременно по всем уровням иерархии&#10;любой сложности. Однако предложенный ими алгоритм согласования&#10;предполагает, что полученные независимые прогнозы являются&#10;несмещенными оценками и~что ошибки прогнозов временн$\acute{\mbox{ы}}$х рядов&#10;удовлетворяют структуре иерархии, т.\,е.\ являются согласованными.&#10;Оба эти требования являются достаточно строгими и~сильно&#10;ограничивают применимость этого способа согласования.&#10;&#10;Предложенный в~\cite{stenina2014reconciliation} способ&#10;согласования прогнозов не требует несмещенности независимых&#10;прогнозов и~согласованности ошибок. При этом, как&#10;продемонстрировано в~статье, он не уступает методу из~\cite{hyndman2011optimal} по качеству согласованных прогнозов.&#10;Однако и~этот метод имеет ряд недостатков. Для его использования&#10;необходимо оценивать погрешность независимых прогнозов, что не&#10;всегда удается корректно сделать. Метод не гарантирует, что&#10;качество согласованных прогнозов не будет уступать качеству&#10;независимых. И согласование происходит поэтапно по узлам иерархии,&#10;что не позволяет учесть сразу всю информацию о взаимосвязи между&#10;временн$\acute{\mbox{ы}}$ми рядами.&#10;&#10;В настоящей статье предлагается обобщение алгоритма согласования&#10;из~\cite{stenina2014reconciliation} с~сохранением его преимуществ&#10;и устранением недостатков. Предлагается алгоритм согласования&#10;прогнозов GTOp,&#10;основанный на идеях из~\cite{vanerven:hal-00920559}. Алгоритм GTOp&#10;не требует оценки погрешности независимых прогнозов временн$\acute{\mbox{ы}}$х&#10;рядов, не требует не\-сме\-щен\-ности независимых прогнозов и~имеет&#10;теоретическое обоснование улучшения качества прогнозов после&#10;проведения согласования. Задача согласования прогнозов&#10;рассматривается как поиск равновесия&#10;Нэша~\cite{petrosyan1998theory, menshikov2010lections}&#10;в~антагонистической игре игрока, выбирающего согласованные прогнозы,&#10;с природой, которая выбирает действительные значения временн$\acute{\mbox{ы}}$х&#10;рядов, и~сводится к~решению оптимизационной задачи с~ограничениями&#10;типа равенства и~неравенства. Вид равновесия Нэша задает параметры&#10;оптимизационной задачи.&#10;&#10;Работа предлагаемого алгоритма демонстрируется на данных о&#10;посуточном отправлении вагонов с~37~типами грузов с~98~веток&#10;Российских желез-\linebreak ных дорог (РЖД).&#10;Проведены эксперименты по согласова\-нию прогнозов для различных&#10;типов иерархических структур и~показано, что на практике&#10;действительно наблюдается улучшение качества прогнозов после&#10;проведения согласования алгоритмом GTOp.&#10;&#10;Статья включает следующие разделы. В разд.~2 вводятся необходимые&#10;обозначения, в~разд.~3 формулируется задача согласования прогнозов&#10;иерархических временн$\acute{\mbox{ы}}$х рядов. Раздел~4 содержит  необходимые&#10;определения и~факты из теории игр, описание антагонистической&#10;игры, со\-от\-вет\-ст\-ву\-ющей задаче согласования прогнозов, и~доказательство существования в~этой игре равновесия Нэша. Раздел~5&#10; описывает оптимизационную задачу, к~которой сводится задача&#10;согласования прогнозов, а~также преимущества и~недостатки&#10;алгоритма. В~разд.~6 приводятся примеры функций потерь, для&#10;которых применим алгоритм GTOp. В~разд.~7 приведены результаты&#10;экспериментов. В~разд.~8 подводятся итоги и~делаются выводы.&#10;&#10;&#10;&#10;\section{Обозначения}&#10;&#10;В этом разделе вводится система обозначений, которая будет&#10;использоваться в~настоящей работе. Будем обозначать временной ряд&#10;через вектор $\x$, элементы временн$\acute{\mbox{о}}$го ряда будем снабжать&#10;индексом $t$, $t \hm= 1, \ldots, T$,&#10; где $T$~--- длина истории.&#10;$$&#10;    \x = \{ x_t \}_{t = 1}^T.&#10;$$&#10;&#10;Общее количество временн$\acute{\mbox{ы}}$х рядов во всей иерархии будем&#10;обозначать~$d$. Далее для наглядности будем рассматривать иерархию&#10;рядов, изображенную на рис.~1. Она&#10;содержит один временной ряд на верхнем уровне и~$n$~рядов на&#10;нижнем. Для этой иерархии $d \hm= 1\hm+ n$.&#10;&#10;Временн$\acute{\mbox{ы}}$е ряды нижнего уровня будут обозначаться $\x(i)$, $i \hm= 1,&#10;\ldots, n$, где $n$~--- число временн$\acute{\mbox{ы}}$х рядов на нижнем&#10;уровне. Временной ряд верхнего уровня обозначается как $\x(:)$. Во&#10;избежание\linebreak\vspace*{-12pt}&#10;&#10;\pagebreak&#10;&#10;\begin{center}  %fig1&#10;\vspace*{-1pt}&#10;\mbox{%&#10; \epsfxsize=76.721mm&#10; \epsfbox{ste-1.eps}&#10; }&#10;&#10;&#10;\vspace*{3pt}&#10;&#10;%\noindent&#10;{{\figurename~1}\ \ \small{Плоская двухуровневая иерархия}}&#10;&#10;\end{center}&#10;&#10;\vspace*{6pt}&#10;&#10;&#10;\addtocounter{figure}{1}&#10;&#10;&#10;&#10;&#10;\noindent&#10; путаницы условимся использовать нижние индексы для&#10;обозначения отсчетов времени, а~индексы в~скобках использовать для&#10;обозначения положения временн$\acute{\mbox{ы}}$х рядов в~структуре иерархии.&#10;Элементы временн$\acute{\mbox{ы}}$х рядов, составляющих плоскую двух\-уров\-не\-вую&#10;иерархию, обозначаются соответственно $x_t(i)$, $i \hm= 1, \ldots,&#10;n$, $x_t(:)$. Их соотношение задается формулой&#10;\begin{equation}&#10;\label{eq:2LevelsConstraint}&#10;    x_t(:) = \sum\limits_{i = 1}^n x_t(i)\,, \enskip t = 1, \ldots, T\,.&#10;\end{equation}&#10;Будем называть соотношение~(\ref{eq:2LevelsConstraint})&#10;\textbf{условием согласованности}. Прогнозы этих временн$\acute{\mbox{ы}}$х рядов&#10;будем обозначать &amp;lt;&amp;lt;шляпками&amp;gt;&amp;gt;, опуская нижние индексы, чтобы&#10;избежать излишне громоздких обозначений. Прогнозироваться будет&#10;всегда $(T \hm+ 1)$-е значение временн$\acute{\mbox{о}}$го ряда&#10;$\hat{x}(i)$, $i \hm= 1, \ldots, n$, $\hat{x}(:).$&#10;Согласованные прогнозы будут также обозначаться без нижних&#10;индексов: $\hat{y}(i)$, $i \hm= 1, \ldots, n$, $\hat{y}(:) \hm=&#10;\sum\nolimits_{i = 1}^n \hat{y}(i).$&#10;&#10;Запишем все временн$\acute{\mbox{ы}}$е ряды в~матрицу, каждая строка которой&#10;соответствует одному временн$\acute{\mbox{о}}$му ряду. Для иерархии&#10;с~рис.~1 эта матрица будет размера $(1 + n)&#10;\times T$ и~выглядеть следующим образом:&#10;\begin{equation*}&#10;%\label{eq:SeriesMatrix}&#10;    X = \left(%&#10;\begin{array}{cccc}&#10;  x_1(:) &amp;amp; x_2(:) &amp;amp; \cdots &amp;amp; x_T(:) \\[6pt]&#10;  x_1(1) &amp;amp; x_2(1) &amp;amp; \cdots &amp;amp; x_T(1) \\[6pt]&#10;  \cdots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots \\[6pt]&#10;  x_1(n) &amp;amp; x_2(n) &amp;amp; \cdots &amp;amp; x_T(n)&#10;\end{array}%&#10;\right).&#10;\end{equation*}&#10;Будем называть срезом иерархии в~момент времени~$t$ столбец&#10;матрицы~$X$, соответствующий моменту времени~$t$. Для удобства&#10;записи введем векторы, соответствующие срезу иерархии в~момент&#10;времени~$t$, прогнозам и~согласованным прогнозам. В~этих векторах&#10;значения, соответствующие разным временн$\acute{\mbox{ы}}$м рядам,&#10;записаны в~столбец, начиная с~верхнего уровня иерархии и~заканчивая нижним&#10;уровнем:&#10;&#10;\noindent&#10;$$&#10;    \boldsymbol{\chi}_t = \left(%&#10;    \begin{array}{c}&#10;        x_t(:) \\&#10;        x_t(1) \\&#10;        \vdots \\&#10;        x_t(n) \\&#10;    \end{array}%&#10;    \right)\,; \quad&#10;    \hchi = \left(%&#10;    \begin{array}{c}&#10;        \hx(:) \\&#10;        \hx(1) \\&#10;        \vdots \\&#10;        \hx(n) \\&#10;    \end{array}%&#10;    \right)\,; \quad&#10;    \hphi = \left(%&#10;    \begin{array}{c}&#10;        \hy(:) \\&#10;        \hy(1) \\&#10;        \vdots \\&#10;        \hy(n) \\&#10;    \end{array}%&#10;    \right).&#10;$$&#10;Условие~(\ref{eq:2LevelsConstraint}) для векторов&#10;$\boldsymbol{\chi}_t$ и~$\hphi$ запишем, введя мат\-ри\-цу&#10;связей размером $1 \times (n + 1)$:&#10;$$&#10;    S = \left(%&#10;        \begin{array}{cccc}&#10;            -1 &amp;amp; 1 &amp;amp; \cdots &amp;amp; 1 \\&#10;        \end{array}%&#10;        \right).&#10;$$&#10;Тогда условие согласованности запишется кратко&#10;$$&#10;    S \boldsymbol{\chi}_t = 0\,; \quad S \hphi = 0.&#10;$$&#10;&#10;В случае, когда иерархия имеет более сложную структуру, чем на&#10;рис.~1, векторы~$\boldsymbol{\chi}_t$,&#10;$\hchi$ и~$\hphi$ имеют размерность $d$, матрица $X$ имеет ровно&#10;$d$ строк, временн$\acute{\mbox{ы}}$е ряды в~ней записываются&#10;от верхних уровней к~нижним. А~размерность матрицы связи~$S$ равна $c \times d$, где&#10;$c$ --- число узлов в~графе иерархии или, другими словами,&#10;количество огра\-ни\-че\-ний-ра\-венств, наложенных на элементы срезов&#10;иерархии~$\boldsymbol{\chi}_t$.&#10;&#10;&#10;&#10;\section{Задача согласования прогнозов иерархических временных рядов}&#10;&#10;Сформулируем задачу согласования прогнозов иерархических временн$\acute{\mbox{ы}}$х&#10;рядов. Для этого введем еще ряд необходимых обозначений.&#10;&#10;Пусть дан набор из $d$ временн$\acute{\mbox{ы}}$х рядов, значения которых записаны&#10;в матрицу~$X$ размера $d \times T$:&#10;$$&#10;    X = \left(%&#10;\begin{array}{cccc}&#10;  \boldsymbol{\chi}_1 &amp;amp; \boldsymbol{\chi}_2 &amp;amp; \cdots &amp;amp; \boldsymbol{\chi}_T \\&#10;\end{array}%&#10;\right),&#10;$$&#10;где каждый столбец $\boldsymbol{\chi}_t$ соответствует срезу в~момент времени~$t$, а~каждая строка $\x_i$~--- одному&#10;временному ряду. Пусть структура иерархии задана матрицей связи $S$ так, что&#10;для всех $t \hm= 1, \ldots ,T$ выполнено условие согласованности:&#10;$$&#10;    S \boldsymbol{\chi}_t = 0\,.&#10;$$&#10;Пусть даны прогнозы  значений~$\hchi$ для всех временн$\acute{\mbox{ы}}$х рядов в~момент&#10;времени $T\hm+ 1$ и~задана функция суммарных потерь при&#10;прогнозировании иерархии&#10;\begin{equation}&#10;\label{eq:HierarchyLoss}&#10;    l_h(\hchi, \boldsymbol{\chi}_{T+1})\,.&#10;\end{equation}&#10;&#10;Определим множество&#10;\begin{equation}&#10;\label{eq:SetReconciled}&#10;    \mathcal{A} = \{ \boldsymbol{\chi} \in \mathbb{R}^d \mid S \boldsymbol{\chi} = 0 \}\,,&#10;\end{equation}&#10;где $\boldsymbol{\chi}$~--- произвольный $d$-мерный вектор, а~$S$~--- заданная матрица связи. Отметим, что все срезы $\boldsymbol{\chi}_t$, $t \hm=&#10;1, \ldots, T$, лежат в~множестве~$\mathcal{A}$. Также в~нем должны лежать&#10;согласованные прогнозы $\hphi$.&#10;&#10;В ряде задач прогнозы должны удовлетворять некоторым ограничениям,&#10;связанным с~физической природой прогнозируемой величины. В~связи&#10;с чем введем множество&#10;\begin{multline}&#10;\label{eq:SetPhysicsConstraint}&#10;    \mathcal{B} = \{ \boldsymbol{\chi} \in \mathbb{R}^d \mid \boldsymbol{\chi}(i)&#10;    \in [A_i, B_i]\,,\\&#10;     A_i, B_i \in [-\infty, +\infty]\,,\ i = 1, \ldots, d&#10;    \},&#10;\end{multline}&#10;где $\boldsymbol{\chi}$~--- произвольный $d$-мер\-ный вектор; $A_i$&#10;и~$B_i$ задают отрезок, в~котором должна находиться \mbox{$"/>
                              <text value="i"/>
                              <formula id="id6" value="$-я}&#10;компонента этого вектора. Например, в~случае $A_1 \hm= \cdots = A_d \hm=&#10;0$, $B_1 \hm= \cdots = B_d \hm= +\infty$ вектор~$\boldsymbol{\chi}$&#10;лежит в~положительном октанте, а~конечные значения $A_1, \cdots,&#10;A_d$, $B_1, \cdots, B_d$ могут задавать интервалы, в~которых&#10;должны лежать прогнозы. Отсутствие ка\-ких-ли\-бо ограничений задается&#10;значениями $A_1 \hm= \cdots = A_d \hm= -\infty$, $B_1 \hm= \cdots = B_d \hm=&#10;+\infty$.&#10;&#10;Введя все необходимые дополнительные обозначения, можно&#10;сформулировать задачу поиска согласованных прогнозов. Требуется&#10;найти вектор прогнозов~$\hphi$, удовлетворяющий следующим&#10;требованиям.&#10;\begin{description}&#10;    \item[Согласованность:] вектор прогнозов~$\hphi$ должен&#10;    удов\-ле\-тво\-рять структуре иерархии, заданной мат\-ри\-цей связи~$S$,&#10;    т.\,е.\ $\hphi \hm\in \mathcal{A}$.&#10;    \item[Ограничения:] вектор прогнозов~$\hphi$ должен&#10;    удовлетворять наложенным ограничениям, т.\,е.\ $\hphi \hm\in \mathcal{B}$.&#10;    \item[Качество:] общие потери при использовании согласованных&#10;    прогнозов не должны превышать общие потери при использовании&#10;    независимых прогнозов, т.\,е.\ ${l_h(\hphi, \boldsymbol{\chi}_{T + 1}) \hm\leq l_h(\hchi, \boldsymbol{\chi}_{T +    1})}$.&#10;\end{description}&#10;&#10;&#10;\section{Задача согласования прогнозов как поиск равновесия&#10;в~антагонистической игре}&#10;&#10;В этом разделе задача согласования прогнозов, сформулированная&#10;выше, рассматривается как\linebreak антагонистическая игра. Такое&#10;представление не влияет на решение задачи согласования прогнозов&#10;и~направлено лишь на достижение на\-гляд\-ности и~интерпретируемости&#10;полученных ре\-зультатов. В~первой части раздела приводятся&#10;необходимые определения и~факты из теории игр~[17--19],&#10; во второй части вводится&#10;антагонистическая игра, соответствующая задаче согласования&#10;прогнозов, в~треть\-ей части формулируется и~доказывается теорема о&#10;существовании в~этой игре равновесия Нэша, которая является&#10;обобщением теоремы, доказанной в~\cite{vanerven:hal-00920559},&#10;и~приводится следствие из этой теоремы, однозначно определяющее&#10;выбор оптимального вектора согласованных прогнозов.&#10;&#10;\subsection{Понятие антагонистической игры}&#10;&#10;\noindent&#10;\textbf{Определение 1.} %\label{def:antagonistic_game}&#10;\textit{Система&#10;$"/>
                              <formula id="id7" value="$&#10;    \Gamma = (\mathcal{M}, \mathcal{N}, L)\,,&#10;$"/>
                              <text value="$&#10;где $"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="M"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces>
                                  <text value="$ и"/>
                                  <escaped value="~"/>
                                  <text value="$"/>
                                </braces>
                              </command>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="N"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <formula id="id8" value="$~--- непустые множества и~функция $"/>
                              <text value="L"/>
                              <command value="\colon"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="M"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <command value="\times"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="N"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <command value="\to"/>
                              <command value="\mathbb">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="R"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <formula id="id9" value="$, называется антагонистической игрой&#10;(игрой с~нулевой суммой) в~нормальной форме. Элементы $"/>
                              <command value="\mu"/>
                              <command value="\hm"/>
                              <command value="\in"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="M"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces>
                                  <text value="$&#10;и"/>
                                  <escaped value="~"/>
                                  <text value="$"/>
                                </braces>
                              </command>
                              <command value="\nu"/>
                              <command value="\hm"/>
                              <command value="\in"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="N"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <formula id="id10" value="$ называются стратегиями игроков~$"/>
                              <text value="1$ и"/>
                              <escaped value="~"/>
                              <text value="$2"/>
                              <formula id="id11" value="$ соответственно,&#10;$"/>
                              <text value="L"/>
                              <formula id="id12" value="$~--- функцией потерь игрока~$"/>
                              <text value="1"/>
                              <formula id="id13" value="$. Потери игрока~$"/>
                              <text value="2"/>
                              <formula id="id14" value="$ полагаются равными&#10;$"/>
                              <text value="-L("/>
                              <command value="\mu">
                                <braces>
                                  <text value=","/>
                                </braces>
                              </command>
                              <command value="\nu">
                                <braces>
                                  <text value=")"/>
                                </braces>
                              </command>
                              <formula id="id15" value="$}.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Определение 2.} %\label{def:clear_strategy}&#10;\textit{Говорят, что игра разыгрывается в~чис\-тых стратегиях, если оба&#10;игрока из имеющихся наборов действий $"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="M"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces>
                                  <text value="$ и"/>
                                  <escaped value="~"/>
                                  <text value="$"/>
                                </braces>
                              </command>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="N"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <formula id="id16" value="$ выбирают по одному&#10;действию $"/>
                              <command value="\mu">
                                <braces>
                                  <text value="$ и"/>
                                  <escaped value="~"/>
                                  <text value="$"/>
                                </braces>
                              </command>
                              <command value="\nu"/>
                              <formula id="id17" value="$ соответственно}.&#10;&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Определение 3.}&#10;%\label{def:mixed_strategy}&#10;\textit{Введем на множествах стратегий~$"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="M"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces>
                                  <text value="$ и"/>
                                  <escaped value="~"/>
                                  <text value="$"/>
                                </braces>
                              </command>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="N"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <formula id="id18" value="$ вероятностные&#10;распределения $"/>
                              <text value="p("/>
                              <command value="\mu">
                                <braces>
                                  <text value=")$ и"/>
                                  <escaped value="~"/>
                                  <text value="$q("/>
                                </braces>
                              </command>
                              <command value="\nu">
                                <braces>
                                  <text value=")"/>
                                </braces>
                              </command>
                              <formula id="id19" value="$ соответственно:&#10;$"/>
                              <formula id="id20" value="$&#10;    \int\limits_{\mathcal{M}} p(\mu)\, d\mu = 1\,; \quad&#10;     \int\limits_{\mathcal{N}} q(\nu)\, d\nu =&#10;    1\,.&#10;$"/>
                              <formula id="id21" value="$&#10;Распределения $"/>
                              <text value="p("/>
                              <command value="\mu">
                                <braces>
                                  <text value=")$ и"/>
                                  <escaped value="~"/>
                                  <text value="$q("/>
                                </braces>
                              </command>
                              <command value="\nu">
                                <braces>
                                  <text value=")"/>
                                </braces>
                              </command>
                              <formula id="id22" value="$ задают смешанные стратегии в~игре~$"/>
                              <command value="\Gamma"/>
                              <formula id="id23" value="$,&#10;если игрок~$"/>
                              <text value="1"/>
                              <formula id="id24" value="$ выбирает действие в~соответствии с~распределением&#10;$"/>
                              <text value="p("/>
                              <command value="\mu">
                                <braces>
                                  <text value=")"/>
                                </braces>
                              </command>
                              <formula id="id25" value="$ и~игрок~$"/>
                              <text value="2"/>
                              <formula id="id26" value="$ выбирает действие в~соответствии с~распределением $"/>
                              <text value="q("/>
                              <command value="\nu">
                                <braces>
                                  <text value=")"/>
                                </braces>
                              </command>
                              <formula id="id27" value="$}.&#10;&#10;\smallskip&#10;&#10;&#10;Чистые стратегии являются частным случаем смешанных. Поэтому далее&#10;будут рассматриваться смешанные стратегии, за исключением&#10;специально оговоренных моментов. Обозначать стратегии будем~$\pcd$ и~$\q$.&#10;&#10;Математическое ожидание потерь игрока 1 при паре смешанных&#10;стратегий $\pcd$ и~$\q$ обозначим через&#10;$$&#10;    \bar{L}(\pcd, \q) = \int\limits_{\mathcal{M}} \int\limits_{\mathcal{N}} p(\mu) q(\nu) L(\mu,&#10;    \nu)\, d\mu \, d\nu\,.&#10;$$&#10;Игрок 1 преследует цель минимизировать эту величину при любых&#10;действиях игрока~2.&#10;&#10;\noindent&#10;\textbf{Определение 4.} %\label{def:Nash_equilibrium}&#10;Пара стратегий $(p(\cdot), q(\cdot))$ называется равновесием Нэша&#10;в~смешанных стратегиях в~игре $\Gamma$, если для любых&#10;$\pcd^{\prime}$ и~$\q^{\prime}$ выполнено неравенство:&#10;$$&#10;    \bar{L}(\pcd, \q^{\prime}) \leq \bar{L}(\pcd, \q) \leq \bar{L}(\pcd^{\prime},&#10;    \q)\,.&#10;$$&#10;&#10;&#10;При равновесии Нэша ни одному из игроков не выгодно отклоняться от&#10;равновесной стратегии, если второй продолжает придерживаться&#10;равновесной стратегии. При этом игрок~1 минимизирует свои потери в~ситуации, когда игрок~2 действует наиболее выгодным для себя&#10;образом. Отметим также, что равновесие Нэша является седловой&#10;точкой функции $\bar{L}(\pcd, \q)$.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Теорема~1.} %\label{th:equlibrium_existence}&#10;\textit{В антагонистической игре равновесие Нэша существует тогда и~только&#10;тогда, когда определена величина}&#10;$$&#10;    V = \min\limits_{\pcd^{\prime}} \max\limits_{\q^{\prime}} \bar{L}(\pcd^{\prime}\,,&#10;    \q^{\prime}) =&#10;    \max\limits_{\q^{\prime}} \min\limits_{\pcd^{\prime}} \bar{L}(\pcd^{\prime}\,,&#10;    \q^{\prime}).&#10;$$&#10;&#10;&#10;Величина $V$ называется ценой игры. Доказательство этой теоремы&#10;в~настоящей статье не приводится, при желании его можно&#10;найти в~[17--19].&#10;&#10;\subsection{Антагонистическая игра, описывающая задачу согласования~прогнозов}&#10;&#10;Вернемся к~рассмотрению введенных в~разд.~3&#10;множеств~$\mathcal{A}$~(\ref{eq:SetReconciled})&#10;и~$\mathcal{B}$~(\ref{eq:SetPhysicsConstraint}). Напомним, что множество&#10;$\mathcal{A}$ содержит все $d$-мер\-ные векторы, удовлетворяющие структуре&#10;иерархии, заданной матрицей связи~$S$. Множество~$\mathcal{B}$ содержит&#10;$d$-мер\-ные векторы, удовлетворяющие огра\-ни\-че\-ни\-ям-не\-ра\-вен\-ст\-вам&#10;рассматриваемой задачи прогнозирования.&#10;&#10;Будем рассматривать антагонистическую иг\-ру~$\Gamma$, в~которой&#10;игрок~1 выбирает вектор согласованных прогнозов~$\hphi$ из&#10;множества $\mathcal{A} \cap \mathcal{B}$, которые одновременно удовлетворяют&#10;структуре иерархии, заданной матрицей связи~$S$,&#10;и~огра\-ни\-че\-ни\-ям-не\-ра\-вен\-ст\-вам,&#10;задающим множество~$\mathcal{B}$, игрок~2 также&#10;выбирает вектор действительных значений $\boldsymbol{\chi}_{T+1}$,&#10;удовлетворяющих структуре иерархии и~физическим ограничениям&#10;(можно считать игрока~2 природой).&#10;&#10;Определим множества стратегий $\mathcal{M}$ и~$\mathcal{N}$ игроков~1 и~2 как&#10;пересечение множеств $\mathcal{A} \cap \mathcal{B}$. Функцию потерь игрока~1&#10;определим с~помощью функции потерь по иерархии~(\ref{eq:HierarchyLoss}):&#10;$$&#10;    L(\hphi, \boldsymbol{\chi}_{T+1}) = l_h(\boldsymbol{\chi}_{T+1}, \hphi) - l_h(\boldsymbol{\chi}_{T+1}, \hchi)\,,&#10;$$&#10;где вектор независимых прогнозов $\hchi$ считается заданным и~не&#10;зависит от действий, выбираемых игроками. Считается, что $\hchi&#10;\hm\in \mathcal{B}$. Такой выбор функции потерь игрока~1 связан с~тем&#10;соображением, что при $L(\hphi, \boldsymbol{\chi}_{T+1}) \hm= 0$&#10;качество согласованных прогнозов не хуже, чем качество независимых&#10;прогнозов, а~при $L(\hphi, \boldsymbol{\chi}_{T+1}) \hm&amp;lt; 0$ и~вовсе&#10;превосходит его.&#10;&#10;Таким образом, получена антагонистическая игра&#10;\begin{equation}&#10;\label{eq:game}&#10;    \Gamma = (\mathcal{A} \cap \mathcal{B},~\mathcal{A} \cap \mathcal{B},~l_h(\boldsymbol{\chi}_{T+1}, \hphi) - l_h(\boldsymbol{\chi}_{T+1}, \hchi))\,,&#10;\end{equation}&#10;где игрок~1 выбирает вектор согласованных прогнозов $\hphi$ из&#10;множества $\mathcal{A} \cap \mathcal{B}$, а~игрок~2 выбирает вектор действительных&#10;значений элементов временн$\acute{\mbox{ы}}$х рядов $\boldsymbol{\chi}_{T+1}$ из&#10;множества~$\mathcal{A} \cap \mathcal{B}$. При этом первый игрок преследует цель&#10;минимизировать свои потери, выраженные функцией $L(\hphi,&#10;\boldsymbol{\chi}_{T+1})$, при любых действиях игрока~2, т.\,е.\&#10;при любом векторе действительных значений&#10;$\boldsymbol{\chi}_{T+1}$. Эта цель достигается, если игрок~1&#10;воспользуется стратегией, входящей в~равновесие Нэша.&#10;&#10;\subsection{Существование равновесия Нэша}&#10;&#10;В этой части раздела будет показано, что при выполнении ряда&#10;естественных требований к~множествам $\mathcal{A}$~(\ref{eq:SetReconciled})&#10;и~$\mathcal{B}$~(\ref{eq:SetPhysicsConstraint}) и~функции суммарных потерь&#10;при прогнозировании иерархии $l_h$~(\ref{eq:HierarchyLoss})&#10;в~антагонистической игре (\ref{eq:game}), описывающей задачу&#10;согласования прогнозов, существует равновесие Нэша в~чис\-тых&#10;стратегиях. Также будет показано, что соответствующее этому&#10;равновесию значение функции потерь игрока~1 неположительно, что&#10;гарантирует неухудшение качества прогнозов при переходе от&#10;независимых прогнозов к~согласованным. Рас\-смот\-рим эти требования.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Определение 5.}&#10;%\label{def:ConvexSet}&#10;Множество $\mathcal{C} \subseteq \mathbb{R}^d$ называется&#10;выпуклым~\cite{boyd2009convex}, если для любых $\boldsymbol{\chi}_1 \hm\in&#10;\mathcal{C}$ и~$\boldsymbol{\chi}_2 \hm\in \mathcal{C}$ и~любого $0&#10;\hm\leq \alpha \hm\leq 1$ выполнено&#10;$$&#10;    \alpha \boldsymbol{\chi}_1 + (1 - \alpha) \boldsymbol{\chi}_2 \in \mathcal{C}\,.&#10;$$&#10;&#10;&#10;\smallskip&#10;&#10;Заметим, что множества $\mathcal{A}$ (\ref{eq:SetReconciled}) и~$\mathcal{B}$~(\ref{eq:SetPhysicsConstraint}) выпуклы и~замкнуты.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Предположение 1.}&#10;%\label{ass:Convex}&#10;\textit{Будем предполагать, что пересечение множеств&#10;$"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="A"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces>
                                  <text value="$ и"/>
                                  <escaped value="~"/>
                                  <text value="$"/>
                                </braces>
                              </command>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="B"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <formula id="id28" value="$ не пусто:&#10;$"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="A"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <command value="\cap"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="B"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <command value="\neq"/>
                              <command value="\varnothing"/>
                              <formula id="id29" value="$}.&#10;&#10;\smallskip&#10;&#10;Требование непустого пересечения этих множеств естественно, так&#10;как в~противном случае неразрешима задача поиска вектора&#10;согласованных прогнозов~$\hphi$, который должен одновременно&#10;принадлежать обоим множествам. Также отметим, что множество $\mathcal{A}&#10;\cap \mathcal{B}$ является выпуклым и~замкнутым как пересечение двух&#10;выпуклых и~замкнутых множеств~\cite{boyd2009convex}.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Предположение 2.} %\label{ass:NonNegative}&#10;\textit{Будем считать, что функция суммарных потерь~$"/>
                              <text value="l_h"/>
                              <formula id="id30" value="$}~(\ref{eq:HierarchyLoss})&#10;\textit{неотрицательна и~равна нулю только при&#10;равенстве аргументов}:&#10;$$&#10;    l_h(\boldsymbol{\chi}_{T+1}, \hchi) \geq 0 \mbox{ для\ всех } \boldsymbol{\chi}_{T+1},&#10;    \hchi\,;&#10;$$&#10;$$&#10;    l_h(\boldsymbol{\chi}_{T+1}, \hchi) = 0 \quad \Leftrightarrow \quad \boldsymbol{\chi}_{T+1} =&#10;    \hchi\,.&#10;$$&#10;&#10;\smallskip&#10;&#10;Равенство аргументов $\boldsymbol{\chi}_{T+1} \hm= \hchi$&#10;соответствует случаю, когда прогноз полностью совпадает с~действительными значениями. В~этом случае потери равны нулю. Во&#10;всех остальных случаях потери при прогнозе положительные.&#10;&#10;&#10;&#10;\noindent&#10;\textbf{Определение 6.} %\label{def:Projection}&#10;Проекцией точки $\boldsymbol{\chi}_0 \in \mathbb{R}^d$ на множество&#10;$\mathcal{C} \subseteq \mathbb{R}^d$, инициированной функцией расстояния~$f$,&#10;называется точка&#10;$$&#10;    \boldsymbol{\chi}_{\mathrm{proj}} = \argmin\limits_{\boldsymbol{\chi} \in \mathcal{C}} f(\boldsymbol{\chi},&#10;    \boldsymbol{\chi}_0)\,.&#10;$$&#10;&#10;&#10;%\smallskip&#10;&#10;\noindent&#10;\textbf{Предположение 3.}&#10;%\label{ass:Projection}&#10;\textit{Пусть существует проекция точки из $"/>
                              <command value="\mathbb">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="R"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces>
                                  <text value="^d"/>
                                </braces>
                              </command>
                              <formula id="id31" value="$, соответствующей вектору&#10;независимых прогнозов $"/>
                              <command value="\hchi"/>
                              <formula id="id32" value="$, на выпуклое и~замкнутое мно\-жество&#10;$"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="A"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <command value="\cap"/>
                              <command value="\mathcal">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="B"/>
                                  </braces>
                                </braces>
                                <braces/>
                              </command>
                              <formula id="id33" value="$, инициированная функцией суммарных потерь~$"/>
                              <text value="l_h"/>
                              <formula id="id34" value="$}:&#10;$$&#10;    \boldsymbol{\chi}_{\mathrm{proj}} = \argmin\limits_{\boldsymbol{\chi} \in \mathcal{A} \cap \mathcal{B}} l_h(\boldsymbol{\chi},&#10;    \hchi).&#10;$$&#10;&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Предположение 4.} %\label{ass:CosinusInequality}&#10;\textit{Пусть $"/>
                              <command value="\boldsymbol">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <command value="\chi">
                                      <braces/>
                                      <braces>
                                        <text value="_"/>
                                      </braces>
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <command value="\mathrm">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="proj"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                            <braces/>
                                          </command>
                                          <command value="\hm">
                                            <braces>
                                              <text value="="/>
                                            </braces>
                                          </command>
                                          <command value="\argmin"/>
                                          <command value="\limits">
                                            <braces>
                                              <text value="_"/>
                                            </braces>
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <command value="\boldsymbol">
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <command value="\chi">
                                                        <braces/>
                                                      </command>
                                                      <command value="\in"/>
                                                      <command value="\mathcal">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <text value="A"/>
                                                          </braces>
                                                        </braces>
                                                        <braces/>
                                                      </command>
                                                      <command value="\cap"/>
                                                      <command value="\mathcal">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <text value="B"/>
                                                          </braces>
                                                        </braces>
                                                        <braces/>
                                                        <braces/>
                                                        <braces>
                                                          <text value="l_h("/>
                                                        </braces>
                                                      </command>
                                                      <command value="\boldsymbol">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <command value="\chi">
                                                              <braces/>
                                                              <braces>
                                                                <text value=","/>
                                                              </braces>
                                                            </command>
                                                            <command value="\hchi">
                                                              <braces>
                                                                <text value=")"/>
                                                              </braces>
                                                            </command>
                                                            <formula id="id35" value="$. Будем предполагать, что для всех&#10;$"/>
                                                            <command value="\boldsymbol">
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <command value="\chi">
                                                                    <braces/>
                                                                  </command>
                                                                  <command value="\hm"/>
                                                                  <command value="\in"/>
                                                                  <command value="\mathcal">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <text value="B"/>
                                                                      </braces>
                                                                    </braces>
                                                                    <braces/>
                                                                  </command>
                                                                  <formula id="id36" value="$ и~для всех $"/>
                                                                  <command value="\boldsymbol">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <command value="\psi">
                                                                          <braces/>
                                                                        </command>
                                                                        <command value="\hm"/>
                                                                        <command value="\in"/>
                                                                        <command value="\mathcal">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value="A"/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                        </command>
                                                                        <command value="\cap"/>
                                                                        <command value="\mathcal">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value="B"/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                        </command>
                                                                        <formula id="id37" value="$ выполняется неравенство}&#10;$$&#10;    l_h(\boldsymbol{\psi}, \boldsymbol{\chi}) \geq&#10;    l_h(\boldsymbol{\psi}, \boldsymbol{\chi}_{\mathrm{proj}}) +&#10;    l_h(\boldsymbol{\chi}_{\mathrm{proj}},&#10;    \boldsymbol{\chi})\,.&#10;$$&#10;&#10;\smallskip&#10;&#10;Для пояснения этого требования рассмотрим частный случай, когда&#10;$\mathbb{R}^d \hm= \mathbb{R}^3$, $\mathcal{A} \subset \mathbb{R}^2$, $\mathcal{B} \subset \mathbb{R}^3$, $\mathcal{A} \cap \mathcal{B}&#10;\subset \mathbb{R}^2$ и~$l_h$~--- квадрат метрики Евклида&#10;(рис.~2). Точки&#10;$\boldsymbol{\psi}$, $\boldsymbol{\chi}$,&#10;$\boldsymbol{\chi}_{\mathrm{proj}}$ образуют треугольник. Обозначим&#10;$\theta$ угол при вершине $\boldsymbol{\chi}_{\mathrm{proj}}$ и~запишем&#10;теорему косинусов:&#10;\begin{multline*}&#10;    l_h(\boldsymbol{\psi}, \boldsymbol{\chi}) =&#10;    l_h(\boldsymbol{\psi}, \boldsymbol{\chi}_{\mathrm{proj}}) +&#10;    l_h(\boldsymbol{\chi}_{\mathrm{proj}},&#10;    \boldsymbol{\chi}) - {}\\&#10;    {}-2 \sqrt{l_h(\boldsymbol{\psi}, \boldsymbol{\chi}_{\mathrm{proj}})}&#10;    \sqrt{l_h(\boldsymbol{\chi}_{\mathrm{proj}},&#10;    \boldsymbol{\chi})} \cos \theta\,.&#10;\end{multline*}&#10;&#10;&#10;Поскольку $\boldsymbol{\chi}_{\mathrm{proj}}$ является проекцией, то&#10;угол~$\theta$ не может быть острым. Он прямой, если проецируемая точка&#10;$\boldsymbol{\chi}$ находится &amp;lt;&amp;lt;над&amp;gt;&amp;gt; множеством $\mathcal{A} \cap \mathcal{B}$, и~тупой, если точка находится &amp;lt;&amp;lt;в~стороне&amp;gt;&amp;gt;. Таким образом получаем,&#10;что $\cos \theta \hm\leq 0$, а~значит, последнее слагаемое в~теореме&#10;косинусов неотрицательное. Исключая его и~заменяя знак равенства&#10;на знак нестрогого неравенства, получаем, что предположение~4&#10;соответствует естественным свойствам проекции.&#10;&#10;\begin{center}  %fig2&#10;\vspace*{-1pt}&#10;\mbox{%&#10; \epsfxsize=69.331mm&#10; \epsfbox{ste-2.eps}&#10; }&#10;&#10;&#10;\vspace*{3pt}&#10;&#10;%\noindent&#10;{{\figurename~2}\ \ \small{Пояснение к~предположению~4}}&#10;&#10;\end{center}&#10;&#10;&#10;%\vspace*{6pt}&#10;&#10;&#10;\addtocounter{figure}{1}&#10;&#10;&#10;%\smallskip&#10;&#10;Введя предположения~1--4, сформулируем&#10;теорему.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Теорема 2.}&#10;%\label{th:saddle_point}&#10;\textit{Пусть выполнены предположения~$"/>
                                                                        <text value="1$--$4"/>
                                                                        <formula id="id38" value="$. Тогда пара стратегий&#10;$"/>
                                                                        <text value="("/>
                                                                        <command value="\boldsymbol">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <command value="\chi">
                                                                                <braces/>
                                                                                <braces>
                                                                                  <text value="_"/>
                                                                                </braces>
                                                                                <braces>
                                                                                  <braces>
                                                                                    <text value="{}"/>
                                                                                    <command value="\mathrm">
                                                                                      <braces>
                                                                                        <braces>
                                                                                          <text value="{}"/>
                                                                                          <text value="proj"/>
                                                                                        </braces>
                                                                                      </braces>
                                                                                      <braces/>
                                                                                      <braces/>
                                                                                      <braces>
                                                                                        <text value=","/>
                                                                                      </braces>
                                                                                    </command>
                                                                                    <command value="\boldsymbol">
                                                                                      <braces>
                                                                                        <braces>
                                                                                          <text value="{}"/>
                                                                                          <command value="\chi">
                                                                                            <braces/>
                                                                                            <braces>
                                                                                              <text value="_"/>
                                                                                            </braces>
                                                                                            <braces>
                                                                                              <braces>
                                                                                                <text value="{}"/>
                                                                                                <command value="\mathrm">
                                                                                                  <braces>
                                                                                                    <braces>
                                                                                                      <text value="{}"/>
                                                                                                      <text value="proj"/>
                                                                                                    </braces>
                                                                                                  </braces>
                                                                                                  <braces/>
                                                                                                  <braces/>
                                                                                                  <braces>
                                                                                                    <text value=")"/>
                                                                                                  </braces>
                                                                                                </command>
                                                                                                <formula id="id39" value="$ является&#10;равновесием Нэша в~игре~(\ref{eq:game}) и~седловой точкой функции&#10;$"/>
                                                                                                <text value="L("/>
                                                                                                <command value="\hphi">
                                                                                                  <braces>
                                                                                                    <text value=","/>
                                                                                                  </braces>
                                                                                                </command>
                                                                                                <command value="\boldsymbol">
                                                                                                  <braces>
                                                                                                    <braces>
                                                                                                      <text value="{}"/>
                                                                                                      <command value="\chi">
                                                                                                        <braces/>
                                                                                                        <braces>
                                                                                                          <text value="_"/>
                                                                                                        </braces>
                                                                                                        <braces>
                                                                                                          <braces>
                                                                                                            <text value="{}"/>
                                                                                                            <text value="T+1"/>
                                                                                                          </braces>
                                                                                                        </braces>
                                                                                                        <braces/>
                                                                                                        <braces>
                                                                                                          <text value=")"/>
                                                                                                        </braces>
                                                                                                      </command>
                                                                                                      <command value="\hm">
                                                                                                        <braces>
                                                                                                          <text value="= l_h("/>
                                                                                                        </braces>
                                                                                                      </command>
                                                                                                      <command value="\boldsymbol">
                                                                                                        <braces>
                                                                                                          <braces>
                                                                                                            <text value="{}"/>
                                                                                                            <command value="\chi">
                                                                                                              <braces/>
                                                                                                              <braces>
                                                                                                                <text value="_"/>
                                                                                                              </braces>
                                                                                                              <braces>
                                                                                                                <braces>
                                                                                                                  <text value="{}"/>
                                                                                                                  <text value="T+1"/>
                                                                                                                </braces>
                                                                                                              </braces>
                                                                                                              <braces/>
                                                                                                              <braces>
                                                                                                                <text value=","/>
                                                                                                              </braces>
                                                                                                            </command>
                                                                                                            <command value="\hphi">
                                                                                                              <braces>
                                                                                                                <text value=")"/>
                                                                                                              </braces>
                                                                                                            </command>
                                                                                                            <command value="\hm">
                                                                                                              <braces>
                                                                                                                <text value="- l_h("/>
                                                                                                              </braces>
                                                                                                            </command>
                                                                                                            <command value="\boldsymbol">
                                                                                                              <braces>
                                                                                                                <braces>
                                                                                                                  <text value="{}"/>
                                                                                                                  <command value="\chi">
                                                                                                                    <braces/>
                                                                                                                    <braces>
                                                                                                                      <text value="_"/>
                                                                                                                    </braces>
                                                                                                                    <braces>
                                                                                                                      <braces>
                                                                                                                        <text value="{}"/>
                                                                                                                        <text value="T+1"/>
                                                                                                                      </braces>
                                                                                                                    </braces>
                                                                                                                    <braces/>
                                                                                                                    <braces>
                                                                                                                      <text value=","/>
                                                                                                                    </braces>
                                                                                                                  </command>
                                                                                                                  <command value="\hchi">
                                                                                                                    <braces>
                                                                                                                      <text value=")"/>
                                                                                                                    </braces>
                                                                                                                  </command>
                                                                                                                  <formula id="id40" value="$. Цена игры при этом&#10;равна} $V \hm= -l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hchi)$.&#10;&#10;&#10;\smallskip&#10;&#10;\noindent&#10;Д\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о\,.\ \&#10;Найдем седловую точку функции $L(\hphi, \boldsymbol{\chi}_{T+1})$&#10;в соответствии с~определением~4  и~теоремой~1. Найдем максимум этой&#10;функции по второму аргументу при $\hphi \hm=&#10;\boldsymbol{\chi}_{\mathrm{proj}}$. Для этого воспользуемся предположением~4:&#10;$$&#10;    l_h(\boldsymbol{\psi}, \boldsymbol{\chi}) \geq l_h(\boldsymbol{\psi},&#10;    \boldsymbol{\chi}_{\mathrm{proj}}) + l_h(\boldsymbol{\chi}_{\mathrm{proj}},&#10;    \boldsymbol{\chi})\,.&#10;$$&#10;Применяя неравенство к~функции потерь~$L$ игрока~1 (подставляем&#10;$\boldsymbol{\psi} \hm= \boldsymbol{\chi}_{T+1}$, $\boldsymbol{\chi}&#10;\hm= \hchi$), получаем:&#10;\begin{multline*}&#10;    L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{T+1})&#10;     = l_h(\boldsymbol{\chi}_{T+1}, \boldsymbol{\chi}_{\mathrm{proj}}) -&#10;      l_h(\boldsymbol{\chi}_{T+1}, \hchi) \leq{}\\&#10;      {}\leq&#10;    l_h(\boldsymbol{\chi}_{T+1}, \hchi) -&#10;    l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hchi) -l_h(\boldsymbol{\chi}_{T+1},&#10;    \hchi) ={}&#10;\\{}&#10;    = -l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hchi) \end{multline*}&#10;     для всех $\boldsymbol{\chi}_{T+1} \in \mathcal{A} \cap \mathcal{B}$.&#10;Заметим также, что из предположения~2 вытекает&#10;\begin{multline*}&#10;    L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{\mathrm{proj}}) =&#10;    l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{\mathrm{proj}}) -&#10;    l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hchi) ={}\\&#10;    {}= - l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hchi)\,.&#10;\end{multline*}&#10;Приходим к~выводу, что&#10;$$&#10;    L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{T+1}) \leq&#10;    L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{\mathrm{proj}})&#10;    $$&#10; для всех $\boldsymbol{\chi}_{T+1} \in \mathcal{A} \cap \mathcal{B}$.&#10;&#10;&#10;Следовательно, максимум по второму аргументу достигается при&#10;$\boldsymbol{\chi}_{T+1} = \boldsymbol{\chi}_{\mathrm{proj}}$.&#10;&#10;Минимум по первому аргументу при $\boldsymbol{\chi}_{T+1}\hm=&#10;\boldsymbol{\chi}_{\mathrm{proj}}$ находим, используя&#10;предположение~2, из соотношения&#10;\begin{multline*}&#10;    \argmin\limits_{\hphi \in \mathcal{A} \cap \mathcal{B}} L(\hphi,&#10;    \boldsymbol{\chi}_{\mathrm{proj}}) ={}\\&#10;    {}=&#10;    \argmin\limits_{\hphi \in \mathcal{A} \cap \mathcal{B}}&#10;    l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hphi)&#10;    - l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hchi).&#10;\end{multline*}&#10;Второе слагаемое не зависит от~$\hphi$, а~по предположению~2&#10;функция суммарных потерь неотрицательна и~обращается в~ноль только при равенстве аргументов, поэтому&#10;получаем&#10;$$&#10;    \argmin\limits_{\hphi \in \mathcal{A} \cap \mathcal{B}}&#10;    L(\hphi, \boldsymbol{\chi}_{\mathrm{proj}}) =&#10;    \boldsymbol{\chi}_{\mathrm{proj}}\,.&#10;$$&#10;&#10;Таким образом, получаем, что&#10;\begin{multline*}&#10;   L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{T+1})  \leq&#10;   L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{\mathrm{proj}})&#10;   \leq L(\hphi, \boldsymbol{\chi}_{\mathrm{proj}})\,, \\&#10;    \boldsymbol{\chi}_{T+1},~\hphi \in \mathcal{A} \cap \mathcal{B}\,.&#10;\end{multline*}&#10;Следовательно, $(\boldsymbol{\chi}_{\mathrm{proj}},&#10;\boldsymbol{\chi}_{\mathrm{proj}})$~--- седловая точка функции $L$.&#10;И~эта пара является равновесием Нэша в~игре~(\ref{eq:game}), и~цена&#10;игры выражается как&#10;&#10;\vspace*{-4pt}&#10;&#10;\noindent&#10;\begin{multline*}&#10;    V = \min\limits_{\hphi \in \mathcal{A} \cap \mathcal{B}} \max\limits_{\boldsymbol{\chi}_{T+1} \in \mathcal{A}} L(\hphi, \boldsymbol{\chi}_{T+1}) ={}\\&#10;    {}=&#10;    \max\limits_{\boldsymbol{\chi}_{T+1} \in \mathcal{A}} \min\limits_{\hphi \in \mathcal{A} \cap&#10;    \mathcal{B}} L(\hphi, \boldsymbol{\chi}_{T+1}) ={}\\&#10;    {}=&#10;    L(\boldsymbol{\chi}_{\mathrm{proj}},&#10;    \boldsymbol{\chi}_{\mathrm{proj}})= -l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hchi)\,.&#10;\end{multline*}&#10;&#10;\smallskip&#10;&#10;&#10;\noindent&#10;\textbf{Следствие 1.} %\label{col:OptimalReconcilation}&#10;\textit{Использование в~качестве вектора согласованных прогнозов~$"/>
                                                                                                                  <command value="\hphi"/>
                                                                                                                  <formula id="id41" value="$&#10;проекции вектора независимых прогнозов $"/>
                                                                                                                  <command value="\hchi"/>
                                                                                                                  <command value="\hm"/>
                                                                                                                  <command value="\in"/>
                                                                                                                  <command value="\mathbb">
                                                                                                                    <braces>
                                                                                                                      <braces>
                                                                                                                        <text value="{}"/>
                                                                                                                        <text value="R"/>
                                                                                                                      </braces>
                                                                                                                    </braces>
                                                                                                                    <braces/>
                                                                                                                    <braces>
                                                                                                                      <text value="^d"/>
                                                                                                                    </braces>
                                                                                                                  </command>
                                                                                                                  <formula id="id42" value="$ на&#10;множество $"/>
                                                                                                                  <command value="\mathcal">
                                                                                                                    <braces>
                                                                                                                      <braces>
                                                                                                                        <text value="{}"/>
                                                                                                                        <text value="A"/>
                                                                                                                      </braces>
                                                                                                                    </braces>
                                                                                                                    <braces/>
                                                                                                                  </command>
                                                                                                                  <command value="\cap"/>
                                                                                                                  <command value="\mathcal">
                                                                                                                    <braces>
                                                                                                                      <braces>
                                                                                                                        <text value="{}"/>
                                                                                                                        <text value="B"/>
                                                                                                                      </braces>
                                                                                                                    </braces>
                                                                                                                    <braces/>
                                                                                                                  </command>
                                                                                                                  <formula id="id43" value="$, инициированной функцией&#10;суммарных потерь~$"/>
                                                                                                                  <text value="l_h"/>
                                                                                                                  <formula id="id44" value="$, гарантирует значение функции суммарных потерь не большее,&#10;чем при использовании вектора независимых прогнозов}~$\hchi$.&#10;&#10;&#10;\noindent&#10;Д\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о\,.\ \&#10;По теореме~2 цена игры~(\ref{eq:game}) равна&#10;значению функции потерь игрока~1 в~точке&#10;$(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{\mathrm{proj}})$&#10;и~неположительна в~силу предположения~2&#10;&#10;\vspace*{2pt}&#10;&#10;\noindent&#10;$$&#10;    V = L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{\mathrm{proj}})&#10;    = -l_h(\boldsymbol{\chi}_{\mathrm{proj}}, \hchi)&#10;    \leq 0\,.&#10;$$&#10;А выбор рассматриваемой функции потерь игрока~1 $L(\hphi,&#10;\boldsymbol{\chi}_{T+1})\hm= l_h(\boldsymbol{\chi}_{T+1}, \hphi) \hm-&#10;l_h(\boldsymbol{\chi}_{T+1}, \hchi)$ был обусловлен тем, что ее&#10;знак совпадает со знаком изменения суммарных потерь при переходе&#10;от вектора независимых прогнозов~$\hchi$ к~вектору согласованных&#10;прогнозов~$\hphi$. Следовательно, при $\boldsymbol{\chi}_{T+1} \hm=&#10;\boldsymbol{\chi}_{\mathrm{proj}}$ суммарные потери при согласованных&#10;прогнозах меньше, чем при независимых.&#10;&#10;Согласно определению~4 равновесия Нэша&#10;&#10;\vspace*{2pt}&#10;&#10;\noindent&#10;$$&#10;    L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{T+1}) \leq&#10;    L(\boldsymbol{\chi}_{\mathrm{proj}}, \boldsymbol{\chi}_{\mathrm{proj}}) \leq 0&#10;    $$&#10; для любых  $\boldsymbol{\chi}_{T+1} \in \mathcal{A} \cap \mathcal{B}$.&#10;Поэтому при любом векторе действительных значений&#10;$\boldsymbol{\chi}_{T+1} \hm\in \mathcal{A} \cap \mathcal{B}$ согласованные&#10;прогнозы~$\hphi$ оказываются предпочтительнее независимых&#10;прогнозов~$\hchi$.&#10;&#10;\section{Алгоритм согласования прогнозов GTOp}&#10;&#10;Согласно следствию~1 оптимальным&#10;выбором вектора согласованных прогнозов~$\hphi$ является проекция&#10;вектора независимых прогнозов~$\hchi$ на множество $\mathcal{A} \cap \mathcal{B}$,&#10;инициированная функцией суммарных потерь~$l_h$. Множество $\mathcal{A} \cap&#10;\mathcal{B}$ содержит векторы размерности~$d$, удовлетворяющие структуре&#10;иерархии, так как множество $\mathcal{A}$ задается&#10;огра\-ни\-че\-ни\-ями-ра\-вен\-ст\-ва\-ми, порожденными матрицей&#10;связи иерархии~$S$. В~то же время $\mathcal{A} \cap \mathcal{B}$ содержит&#10;\mbox{$"/>
                                                                                                                  <text value="d"/>
                                                                                                                  <formula id="id45" value="$-мер}\-ные векторы,&#10;удовлетворяющие огра\-ни\-че\-ни\-ям-не\-ра\-вен\-ст\-вам из множества~$\mathcal{B}$. Таким&#10;образом, задача поиска проекции~--- это оптимизационная задача с~ограничениями типа равенства и~неравенства:&#10;&#10;\noindent&#10;\begin{equation}&#10;\label{eq:OptimProblem}&#10;    \left\{%&#10;\begin{array}{l}&#10;    l_h(\boldsymbol{\chi}, \hchi) \rightarrow \min\limits_{\boldsymbol{\chi}}\,, \\&#10;    \boldsymbol{\chi} \in \mathcal{A}\ \mbox{(ограничения-равенства)}; \\&#10;    \boldsymbol{\chi} \in \mathcal{B}\ \mbox{(ограничения-неравенства)}. \\&#10;\end{array}%&#10;\right.&#10;\end{equation}&#10;&#10;Алгоритм согласования прогнозов иерархических временн$"/>
                                                                                                                  <command value="\acute">
                                                                                                                    <braces>
                                                                                                                      <braces>
                                                                                                                        <text value="{}"/>
                                                                                                                        <command value="\mbox">
                                                                                                                          <braces>
                                                                                                                            <braces>
                                                                                                                              <text value="{}"/>
                                                                                                                              <text value="ы"/>
                                                                                                                            </braces>
                                                                                                                          </braces>
                                                                                                                          <braces/>
                                                                                                                          <braces/>
                                                                                                                        </command>
                                                                                                                        <formula id="id46" value="$х рядов GTOp&#10;заключается в~решении оптимизационной задачи~(\ref{eq:OptimProblem}). Достоинства этого алгоритма заключаются в~том, что он требует от вектора независимых прогнозов~$"/>
                                                                                                                        <command value="\hchi"/>
                                                                                                                        <formula id="id47" value="$ лишь&#10;принадлежности множеству~$"/>
                                                                                                                        <command value="\mathcal">
                                                                                                                          <braces>
                                                                                                                            <braces>
                                                                                                                              <text value="{}"/>
                                                                                                                              <text value="B"/>
                                                                                                                            </braces>
                                                                                                                          </braces>
                                                                                                                          <braces/>
                                                                                                                        </command>
                                                                                                                        <formula id="id48" value="$, и~не требует не\-сме\-щен\-ности&#10;независимых прогнозов, а~следовательно, для получения независимых&#10;прогнозов можно использовать любой алгоритм прогнозирования. Также&#10;GTOp не требует оценки погрешностей независимых прогнозов. Самое&#10;важное, что GTOp обеспечивает неухудшение качества прогнозирования&#10;при замене независимых прогнозов на согласованные прогнозы. При&#10;этом на структуру иерархии, огра\-ни\-че\-ния-не\-ра\-вен\-ст\-ва на прогнозы и~функцию суммарных потерь накладываются лишь общие ограничения,&#10;гарантирующие существование решения оптимизационной задачи~(\ref{eq:OptimProblem}). Еще одно достоинство алгоритма GTOp в~том, что он позволяет согласовывать прогнозы для иерархий любой&#10;сложности одновременно по всем уровням, учитывая все связи в~иерархии и~решая одну оптимизационную задачу. От сложности&#10;иерархии и~количества временн$"/>
                                                                                                                        <command value="\acute">
                                                                                                                          <braces>
                                                                                                                            <braces>
                                                                                                                              <text value="{}"/>
                                                                                                                              <command value="\mbox">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <text value="ы"/>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                                <braces/>
                                                                                                                                <braces/>
                                                                                                                              </command>
                                                                                                                              <formula id="id49" value="$х рядов и~уровней в~оптимизационной&#10;задаче зависит число переменных и~ограничений.&#10;&#10;\section{Дивергенция Брегмана}&#10;&#10;В этом разделе будет описано семейство функций двух переменных,&#10;удовлетворяющих предположениям~1--4, и~приведен ряд примеров функций из&#10;этого семейства, которые можно использовать в~задаче согласования&#10;прогнозов в~качестве функции суммарных потерь~$"/>
                                                                                                                              <text value="l_h"/>
                                                                                                                              <formula id="id50" value="$~(\ref{eq:HierarchyLoss}). Все эти функции двух переменных&#10;называются дивергенциями Брегмана~\cite{cesa2006prediction, bregman1967relaxation}&#10;и~порождаются функциями одной переменной, обладающими следующими свойствами.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Определение 7.}&#10;%\label{def:Legendre_function}&#10;Функцией Лежандра~\cite{cesa2006prediction} называется функция $"/>
                                                                                                                              <text value="F"/>
                                                                                                                              <command value="\colon"/>
                                                                                                                              <command value="\mathcal">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <text value="B"/>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                                <braces/>
                                                                                                                              </command>
                                                                                                                              <command value="\to"/>
                                                                                                                              <command value="\mathbb">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <text value="R"/>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                                <braces/>
                                                                                                                              </command>
                                                                                                                              <formula id="id51" value="$, которая удовлетворяет следующим условиям:&#10;\begin{itemize}&#10;    \item $"/>
                                                                                                                              <command value="\mathcal">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <text value="B"/>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                                <braces/>
                                                                                                                              </command>
                                                                                                                              <command value="\subseteq"/>
                                                                                                                              <command value="\mathbb">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <text value="R"/>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                                <braces/>
                                                                                                                                <braces>
                                                                                                                                  <text value="^d"/>
                                                                                                                                </braces>
                                                                                                                              </command>
                                                                                                                              <formula id="id52" value="$~--- непустое множество, и~внутренность&#10;    $"/>
                                                                                                                              <command value="\mathcal">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <text value="B"/>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                                <braces/>
                                                                                                                              </command>
                                                                                                                              <formula id="id53" value="$ выпукла;&#10;    \item $"/>
                                                                                                                              <text value="F"/>
                                                                                                                              <formula id="id54" value="$~--- строго выпуклая функция с~непрерывной первой&#10;    производной на множестве~$"/>
                                                                                                                              <command value="\mathcal">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <text value="B"/>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                                <braces/>
                                                                                                                              </command>
                                                                                                                              <formula id="id55" value="$;&#10;    \item если $"/>
                                                                                                                              <command value="\boldsymbol">
                                                                                                                                <braces>
                                                                                                                                  <braces>
                                                                                                                                    <text value="{}"/>
                                                                                                                                    <command value="\chi">
                                                                                                                                      <braces/>
                                                                                                                                      <braces>
                                                                                                                                        <text value="_1,"/>
                                                                                                                                      </braces>
                                                                                                                                    </command>
                                                                                                                                    <command value="\boldsymbol">
                                                                                                                                      <braces>
                                                                                                                                        <braces>
                                                                                                                                          <text value="{}"/>
                                                                                                                                          <command value="\chi">
                                                                                                                                            <braces/>
                                                                                                                                            <braces>
                                                                                                                                              <text value="_2,"/>
                                                                                                                                            </braces>
                                                                                                                                          </command>
                                                                                                                                          <command value="\ldots"/>
                                                                                                                                          <command value="\in"/>
                                                                                                                                          <command value="\mathcal">
                                                                                                                                            <braces>
                                                                                                                                              <braces>
                                                                                                                                                <text value="{}"/>
                                                                                                                                                <text value="B"/>
                                                                                                                                              </braces>
                                                                                                                                            </braces>
                                                                                                                                            <braces/>
                                                                                                                                          </command>
                                                                                                                                          <formula id="id56" value="$~---&#10;    последовательность, сходящаяся к~граничной точке $"/>
                                                                                                                                          <command value="\mathcal">
                                                                                                                                            <braces>
                                                                                                                                              <braces>
                                                                                                                                                <text value="{}"/>
                                                                                                                                                <text value="B"/>
                                                                                                                                              </braces>
                                                                                                                                            </braces>
                                                                                                                                            <braces/>
                                                                                                                                          </command>
                                                                                                                                          <formula id="id57" value="$, то $"/>
                                                                                                                                        </braces>
                                                                                                                                      </braces>
                                                                                                                                    </command>
                                                                                                                                  </braces>
                                                                                                                                </braces>
                                                                                                                              </command>
                                                                                                                            </braces>
                                                                                                                          </braces>
                                                                                                                        </command>
                                                                                                                      </braces>
                                                                                                                    </braces>
                                                                                                                  </command>
                                                                                                                </braces>
                                                                                                              </braces>
                                                                                                            </command>
                                                                                                          </braces>
                                                                                                        </braces>
                                                                                                      </command>
                                                                                                    </braces>
                                                                                                  </braces>
                                                                                                </command>
                                                                                              </braces>
                                                                                            </braces>
                                                                                          </command>
                                                                                        </braces>
                                                                                      </braces>
                                                                                    </command>
                                                                                  </braces>
                                                                                </braces>
                                                                              </command>
                                                                            </braces>
                                                                          </braces>
                                                                        </command>
                                                                      </braces>
                                                                    </braces>
                                                                  </command>
                                                                </braces>
                                                              </braces>
                                                            </command>
                                                          </braces>
                                                        </braces>
                                                      </command>
                                                    </braces>
                                                  </braces>
                                                </command>
                                              </braces>
                                            </braces>
                                          </command>
                                        </braces>
                                      </braces>
                                    </command>
                                  </braces>
                                </braces>
                              </command>
                            </braces>
                          </braces>
                        </command>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <command value="\nabla">
        <braces>
          <text value="F("/>
        </braces>
      </command>
      <command value="\boldsymbol">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\chi">
              <braces/>
              <braces>
                <text value="_n)"/>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <command value="\hm"/>
      <command value="\rightarrow"/>
      <command value="\infty">
        <braces>
          <text value="$ при $n"/>
        </braces>
      </command>
      <command value="\hm"/>
      <command value="\rightarrow"/>
      <command value="\infty"/>
      <formula id="id58" value="$.&#10;\end{itemize}&#10;&#10;&#10;%\smallskip&#10;&#10;\noindent&#10;\textbf{Определение 8.} %\label{def:Bregman_divergence}&#10;Дивергенцией Брегмана, порожденной функцией Лежандра $"/>
      <text value="F"/>
      <command value="\colon"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <command value="\hm"/>
      <command value="\to"/>
      <command value="\mathbb">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="R"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id59" value="$, называется неотрицательная функция&#10;$"/>
      <text value="D_F"/>
      <command value="\colon"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <command value="\times"/>
      <command value="\mathrm">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="int"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="("/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=")"/>
        </braces>
      </command>
      <command value="\to"/>
      <command value="\mathbb">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="R"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id60" value="$, определенная как&#10;$"/>
      <formula id="id61" value="$&#10;    D_F(\mathbf{u}, \mathbf{v}) = F(\mathbf{u}) - F(\mathbf{v}) -&#10;    (\mathbf{u} - \mathbf{v}) \nabla F(\mathbf{v})\,.&#10;$"/>
      <formula id="id62" value="$&#10;&#10;&#10;\paragraph*{Свойства дивергенции Брегмана:}&#10;\begin{itemize}&#10;    \item для всех $"/>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="u"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="$ и"/>
          <escaped value="~"/>
          <text value="$"/>
        </braces>
      </command>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="v"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id63" value="$ выполнено $"/>
      <text value="D_F("/>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="u"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=","/>
        </braces>
      </command>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="v"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=")"/>
        </braces>
      </command>
      <command value="\geq">
        <braces>
          <text value="0"/>
        </braces>
      </command>
      <formula id="id64" value="$. Это следует из выпуклости функции $"/>
      <text value="F"/>
      <formula id="id65" value="$;&#10;    \item $"/>
      <text value="D_F("/>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="u"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=","/>
        </braces>
      </command>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="v"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=")"/>
        </braces>
      </command>
      <formula id="id66" value="$ выпукла по первому&#10;    аргументу $"/>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="u"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id67" value="$, но необязательно выпукла по второму&#10;    аргументу~$"/>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="v"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id68" value="$;&#10;    \item для любых $"/>
      <command value="\alpha">
        <braces>
          <text value=","/>
        </braces>
      </command>
      <command value="\beta"/>
      <command value="\in"/>
      <command value="\mathbb">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="R"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id69" value="$ и~любых функций&#10;    Лежандра $"/>
      <text value="F_1$ и"/>
      <escaped value="~"/>
      <text value="$F_2"/>
      <formula id="id70" value="$ выполнено&#10;    $"/>
      <formula id="id71" value="$&#10;    D_{\alpha F_1 + \beta F_2}(\mathbf{u}, \mathbf{v}) =&#10;    \alpha D_{F_1}(\mathbf{u}, \mathbf{v}) + \beta D_{F_2}(\mathbf{u},&#10;    \mathbf{v})\,.&#10;    $"/>
      <formula id="id72" value="$&#10;\end{itemize}&#10;&#10;%\smallskip&#10;&#10;\noindent&#10;\textbf{Определение 9.} %\label{def:Bregman_projection}&#10;Пусть $"/>
      <text value="F"/>
      <command value="\colon"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <command value="\hm"/>
      <command value="\to"/>
      <command value="\mathbb">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="R"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id73" value="$~--- функция Лежандра и~$"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="A"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <command value="\subset"/>
      <command value="\mathbb">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="R"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="^d"/>
        </braces>
      </command>
      <formula id="id74" value="$~--- замкнутое выпуклое множество, такое что $"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="A"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <command value="\cap"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <command value="\neq"/>
      <command value="\varnothing"/>
      <formula id="id75" value="$. Проекция Брегмана $"/>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="w"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="^"/>
        </braces>
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\prime">
              <braces/>
            </command>
            <formula id="id76" value="$ точки&#10;$"/>
            <command value="\mathbf">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="w"/>
                </braces>
              </braces>
              <braces/>
            </command>
            <command value="\hm"/>
            <command value="\in"/>
            <command value="\mathrm">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="int"/>
                </braces>
              </braces>
              <braces/>
            </command>
          </braces>
        </braces>
      </command>
      <text value="("/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=")"/>
        </braces>
      </command>
      <formula id="id77" value="$ на множество~$"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="A"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id78" value="$~--- это&#10;$"/>
      <formula id="id79" value="$&#10;    \mathbf{w}^{\prime} = \argmin\limits_{\mathbf{u} \in \mathcal{A} \cap&#10;    \mathcal{B}} D_F(\mathbf{u}, \mathbf{w})\,.&#10;$"/>
      <formula id="id80" value="$&#10;&#10;&#10;\smallskip&#10;&#10;%\smallskip&#10;&#10;\noindent&#10;\textbf{Теорема 3.}&#10;%\label{lemma:Bregman_projection}&#10;\textit{Для всех функций Лежандра $F \colon \mathcal{B} \to\mathbb{R}$, для всех замкнутых&#10;выпуклых множеств $\mathcal{A} \subset \mathbb{R}^d$, имеющих непустое пересечение&#10;$\mathcal{A} \cap \mathcal{B} \neq \varnothing$, и~для всех точек $\mathbf{w} \in&#10;\mathrm{int}\,(\mathcal{B})$ проекция Брегмана точки $\mathbf{w}$ на множество&#10;$\mathcal{A}$ существует и~единственна}.&#10;&#10;&#10;\smallskip&#10;&#10;\noindent&#10;Д\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о\ \ этой теоремы приведено в~\cite{bregman1967relaxation}.&#10;&#10;\smallskip&#10;&#10;\noindent&#10;\textbf{Теорема~4.}&#10;%\label{lemma:generalized_pythagorean_inequality}&#10;\textit{Пусть $F$~--- функция Лежандра. Для всех $\mathbf{w} \hm\in&#10;\mathrm{int}\,(\mathcal{B})$ и~для всех замкнутых выпуклых множеств $\mathcal{A}&#10;\subseteq \mathbb{R}^d$ с~непустым пересечением $\mathcal{A} \cap \mathcal{B} \neq&#10;\varnothing$, если $\mathbf{w}^{\prime}$~--- проекция Брегмана&#10;точки $\mathbf{w}$ на множество $\mathcal{A}$ $(\mathbf{w}^{\prime} \hm=&#10;\argmin\limits_{\mathbf{v} \in \mathcal{A} \cap \mathcal{B}} D_F(\mathbf{v},&#10;\mathbf{w}))$, то верно неравенство}:&#10;$"/>
      <formula id="id81" value="$&#10;    D_F(\mathbf{u}, \mathbf{w}) \geq D_F(\mathbf{u},&#10;    \mathbf{w}^{\prime}) + D_F(\mathbf{w}^{\prime}, \mathbf{w})&#10;$"/>
      <formula id="id82" value="$&#10;для всех $"/>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="u"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <command value="\in"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="A"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id83" value="$.&#10;&#10;\noindent&#10;Д\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о\ \ этого факта можно найти в~\cite{cesa2006prediction}.&#10;&#10;\smallskip&#10;&#10;Соотнесем перечисленные свойства дивергенции Брегмана и~предположения~1--4. Определение~8 и~свойство~1 дивергенции Брегмана&#10;обеспечивают выполнение предположения~2 о&#10;знаке функции суммарных потерь. В~определении~9&#10;и~тео\-ре\-ме~3 предполагается выпуклость и~замкнутость&#10;множеств $"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="A"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value="$ и"/>
          <escaped value="~"/>
          <text value="$"/>
        </braces>
      </command>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id84" value="$ и~их непустое пересечение,&#10;как и~в~предположении~1. Теорема~4 гарантирует&#10;выполнение предположения~3 о~выпуклости&#10;множеств и~существовании и~единственности проекции. Наконец,&#10;теорема~4 гарантирует&#10;выполнение предположения~4.&#10;Следовательно, для функций суммарных потерь $"/>
      <text value="l_h"/>
      <formula id="id85" value="$~(\ref{eq:HierarchyLoss}),&#10;являющихся дивергенциями Брегмана,&#10;выполнены все условия теоремы~2. Использование&#10;в качестве вектора согласованных прогнозов $"/>
      <command value="\hphi"/>
      <formula id="id86" value="$ проекции&#10;Брегмана вектора независимых прогнозов $"/>
      <command value="\hchi"/>
      <command value="\hm"/>
      <command value="\in"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id87" value="$, где&#10;множество~$"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id88" value="$ определено по формуле~(\ref{eq:SetPhysicsConstraint}) и~является выпуклым и~замкнутым,&#10;имеющим непустое пересечение&#10;с~множеством $"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="A"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id89" value="$~(\ref{eq:SetReconciled}),&#10;на множество~$"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="A"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <command value="\cap"/>
      <command value="\mathcal">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="B"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <formula id="id90" value="$, включающее векторы&#10;прогнозов, удовлетворяющих структуре иерархии, гарантирует&#10;неухудшение качества прогнозов.&#10;&#10;Следующие функции являются дивергенциями Брегмана и~могут быть&#10;использованы в~качестве функций суммарных потерь~(\ref{eq:HierarchyLoss}) при согласовании прогнозов.&#10;\begin{description}&#10;    \item[Квадрат евклидового расстояния] \&#10;&#10;    $"/>
      <text value="D_F("/>
      <command value="\uu">
        <braces>
          <text value=","/>
        </braces>
      </command>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="v"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=")"/>
        </braces>
      </command>
      <command value="\hm">
        <braces>
          <text value="="/>
        </braces>
      </command>
      <command value="\uu"/>
      <command value="\hm">
        <braces>
          <text value="-"/>
        </braces>
      </command>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="v"/>
          </braces>
        </braces>
        <braces/>
      </command>
      <text value="^2"/>
      <formula id="id91" value="$~--- канонический пример дивергенции Брегмана, порождается&#10;    функцией $"/>
      <text value="F("/>
      <command value="\uu">
        <braces>
          <text value=")"/>
        </braces>
      </command>
      <command value="\hm">
        <braces>
          <text value="="/>
        </braces>
      </command>
      <command value="\uu"/>
      <text value="^2"/>
      <formula id="id92" value="$.&#10;    \item[Квадрат расстояния Махаланобиуса]\&#10;&#10;    $"/>
      <text value="D_F("/>
      <command value="\uu">
        <braces>
          <text value=","/>
        </braces>
      </command>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="v"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=")"/>
        </braces>
      </command>
      <command value="\hm">
        <braces>
          <text value="= (1/2)("/>
        </braces>
      </command>
      <command value="\uu">
        <braces>
          <text value="-"/>
        </braces>
      </command>
      <command value="\mathbf">
        <braces>
          <braces>
            <text value="{}"/>
            <text value="v"/>
          </braces>
        </braces>
        <braces/>
        <braces>
          <text value=")^"/>
        </braces>
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\mathrm">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="T"/>
                </braces>
              </braces>
              <braces/>
              <braces/>
              <braces>
                <text value="Q ("/>
              </braces>
            </command>
            <command value="\uu"/>
            <command value="\hm">
              <braces>
                <text value="-"/>
              </braces>
            </command>
            <command value="\mathbf">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="v"/>
                </braces>
              </braces>
              <braces/>
              <braces>
                <text value=")"/>
              </braces>
            </command>
            <formula id="id93" value="$~--- обобщение евклидового расстояния, порождается&#10;    квадратичной формой $"/>
            <text value="F("/>
            <command value="\uu">
              <braces>
                <text value=")"/>
              </braces>
            </command>
            <command value="\hm">
              <braces>
                <text value="= (1/2)"/>
              </braces>
            </command>
            <command value="\uu">
              <braces>
                <text value="^"/>
              </braces>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\mathrm">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="T"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                    <braces>
                      <text value="Q"/>
                    </braces>
                  </command>
                  <command value="\uu"/>
                  <formula id="id94" value="$.&#10;    \item[Обобщенная дивергенция Куль\-ба\-ка--Лейб\-ле\-ра]\&#10;&#10;    $"/>
                  <text value="D_F("/>
                  <command value="\uu">
                    <braces>
                      <text value=","/>
                    </braces>
                  </command>
                  <command value="\mathbf">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="v"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value=")"/>
                    </braces>
                  </command>
                  <command value="\hm">
                    <braces>
                      <text value="="/>
                    </braces>
                  </command>
                  <command value="\sum"/>
                  <command value="\nolimits">
                    <braces>
                      <text value="_"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="i = 1"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="^n u_i"/>
                    </braces>
                  </command>
                  <command value="\log">
                    <braces>
                      <text value="("/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="u_i"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="/"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="v_i"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value=")"/>
                    </braces>
                  </command>
                  <command value="\hm">
                    <braces>
                      <text value="-"/>
                    </braces>
                  </command>
                  <command value="\sum"/>
                  <command value="\nolimits">
                    <braces>
                      <text value="_"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="i = 1"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="^n u_i"/>
                    </braces>
                  </command>
                  <command value="\hm">
                    <braces>
                      <text value="+"/>
                    </braces>
                  </command>
                  <command value="\sum"/>
                  <command value="\nolimits">
                    <braces>
                      <text value="_"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="i = 1"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="^n v_i"/>
                    </braces>
                  </command>
                  <formula id="id95" value="$&#10; по\-рож\-да\-ет\-ся     функцией&#10; $"/>
                  <text value="F("/>
                  <command value="\uu">
                    <braces>
                      <text value=")"/>
                    </braces>
                  </command>
                  <command value="\hm">
                    <braces>
                      <text value="="/>
                    </braces>
                  </command>
                  <command value="\sum"/>
                  <command value="\nolimits">
                    <braces>
                      <text value="_"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="i = 1"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="^n u_i"/>
                    </braces>
                  </command>
                  <command value="\log">
                    <braces>
                      <text value="u_i"/>
                    </braces>
                  </command>
                  <command value="\hm">
                    <braces>
                      <text value="-"/>
                    </braces>
                  </command>
                  <command value="\sum"/>
                  <command value="\nolimits">
                    <braces>
                      <text value="_"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="i = 1"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="^n u_i"/>
                    </braces>
                  </command>
                  <formula id="id96" value="$.&#10;    \item[Расстояние  Itakura--Saito]\&#10;&#10;    $"/>
                  <text value="D_F("/>
                  <command value="\uu">
                    <braces>
                      <text value=","/>
                    </braces>
                  </command>
                  <command value="\mathbf">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="v"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value=") ="/>
                    </braces>
                  </command>
                  <command value="\sum"/>
                  <command value="\nolimits">
                    <braces>
                      <text value="_"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="i = 1"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="^n"/>
                    </braces>
                  </command>
                  <command value="\left">
                    <braces>
                      <text value="( (u_i/v_i)"/>
                    </braces>
                  </command>
                  <command value="\hm">
                    <braces>
                      <text value="-"/>
                    </braces>
                  </command>
                  <command value="\log">
                    <braces>
                      <text value="("/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="u_i"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="/"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="v_i"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value=")"/>
                    </braces>
                  </command>
                  <command value="\hm">
                    <braces>
                      <text value="- 1"/>
                    </braces>
                  </command>
                  <command value="\right">
                    <braces>
                      <text value=")"/>
                    </braces>
                  </command>
                  <formula id="id97" value="$ порождается функцией&#10;    $"/>
                  <text value="F("/>
                  <command value="\uu">
                    <braces>
                      <text value=")"/>
                    </braces>
                  </command>
                  <command value="\hm">
                    <braces>
                      <text value="= -"/>
                    </braces>
                  </command>
                  <command value="\sum"/>
                  <command value="\nolimits">
                    <braces>
                      <text value="_"/>
                    </braces>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="i = 1"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces>
                      <text value="^n"/>
                    </braces>
                  </command>
                  <command value="\log">
                    <braces>
                      <text value="u_i"/>
                    </braces>
                  </command>
                  <formula id="id98" value="$.&#10;\end{description}&#10;&#10;\begin{table*}\small&#10;\begin{center}&#10;   \begin{tabular}{|c|c|c|c|c|c|c|c|}&#10;   \multicolumn{8}{c}{Вид записи базы данных железнодорожных перевозок}\\&#10;\multicolumn{8}{c}{\ }\\[-4pt]&#10;  \hline&#10;  \tabcolsep=0pt\begin{tabular}{c}Дата\\ погрузки\end{tabular} &amp;amp;&#10;    \tabcolsep=0pt\begin{tabular}{c}Станция\\ отправления\end{tabular} &amp;amp;&#10;      \tabcolsep=0pt\begin{tabular}{c}Станция\\ назначения\end{tabular} &amp;amp;&#10;        \tabcolsep=0pt\begin{tabular}{c}Количество\\ вагонов\end{tabular} &amp;amp;&#10;          \tabcolsep=0pt\begin{tabular}{c}Код\\ груза\end{tabular} &amp;amp;&#10;            \tabcolsep=0pt\begin{tabular}{c}Род\\ вагона\end{tabular} &amp;amp;&#10;              \tabcolsep=0pt\begin{tabular}{c}Суммарный\\ вес груза\end{tabular} &amp;amp;&#10;                \tabcolsep=0pt\begin{tabular}{c}Признак\\ маршрутной\\ отправки\end{tabular} \\&#10;  \hline&#10;  2007-01-01 &amp;amp; 020108 &amp;amp; 932902 &amp;amp; 1 &amp;amp; 1 &amp;amp; 216 &amp;amp; 56 &amp;amp; 9 \\&#10;  \hline&#10;\end{tabular}&#10;\end{center}&#10;%\vspace*{6pt}&#10;\end{table*}&#10;&#10;&#10;&#10;\section{Эксперимент}&#10;&#10;В экспериментальной части рассматриваются данные о посуточной&#10;загруженности железнодорожных узлов РЖД. Из имеющихся данных были&#10;сформированы временн$"/>
                  <command value="\acute">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\mbox">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <text value="ы"/>
                            </braces>
                          </braces>
                          <braces/>
                          <braces/>
                        </command>
                        <formula id="id99" value="$е ряды, описывающие отправление 37~различных&#10;типов груза со станций 98~железнодорожных веток посуточно.&#10;Рассмотрены два вида иерархии.&#10;&#10;В~случае плоской двухуровневой&#10;иерархии решены задачи согласования прогнозов отправления грузов&#10;по отдельности и~всех грузов в~сумме для каждой ветки, а~так\-же&#10;решены задачи согласования прогнозов отправления груза с~каждой&#10;ветки и~суммарного отправления груза со всех веток для каждого&#10;типа груза.&#10;&#10;В~случае неплоской трехуровневой иерархии решена&#10;задача согласования прогнозов всех име\-ющих\-ся временн$"/>
                        <command value="\acute">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <command value="\mbox">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="ы"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces/>
                              </command>
                              <formula id="id100" value="$х рядов.&#10;Демонстрируется уменьшение значения функции суммарных потерь при&#10;переходе от независимых прогнозов к~согласованным. В~качестве&#10;функции суммарных потерь был использован квад\-рат евклидового&#10;расстояния. Независимые прогнозы были получены алгоритмом Hist,&#10;описанным в~работах~\cite{stenina2014reconciliation, medvednikova2012nonparametric}.&#10;&#10;\vspace*{-5pt}&#10;&#10;\paragraph*{Экспериментальные данные.} В~эксперименте использованы данные о посуточной загруженности&#10;железнодорожных узлов РЖД с~1~января 2007~г.\ по 22~апреля 2008~г. В~таблице&#10;приведен пример записи базы данных.&#10;&#10;&#10;Коды станций представляют собой шестизначные числа. Станции, в~коде которых две первые цифры совпадают, входят в~одну&#10;железнодорожную ветку. Станций отправления~--- 1566, станций&#10;назначения~--- 1902, веток~--- 98. Код груза~--- натуральное число от~1 до~37; также имеются перевозки, где код груза не указан. Род&#10;вагона~--- натуральное число, в~имеющихся данных~75~различных&#10;родов вагонов.&#10;&#10;\vspace*{-5pt}&#10;&#10;\paragraph*{Иерархическая структура.}&#10;Экспериментальные данные удовлетворяют структуре, изображенной на&#10;рис.~3.&#10;&#10;Как видно из рисунка, иерархия не&#10;является плоской и~содержит три уровня временн$"/>
                              <command value="\acute">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <command value="\mbox">
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <text value="ы"/>
                                        </braces>
                                      </braces>
                                      <braces/>
                                      <braces/>
                                    </command>
                                    <formula id="id101" value="$х рядов.&#10;Временн$"/>
                                    <command value="\acute">
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <command value="\mbox">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="ы"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                            <braces/>
                                          </command>
                                          <formula id="id102" value="$е&#10;ряды нижнего уровня этой иерархии\linebreak\vspace*{-12pt}&#10;&#10;&#10;\begin{center}  %fig3&#10;\vspace*{2pt}&#10;\mbox{%&#10; \epsfxsize=80mm&#10; \epsfbox{ste-3.eps}&#10; }&#10;&#10;&#10;\vspace*{6pt}&#10;&#10;%\noindent&#10;{{\figurename~3}\ \ \small{Неплоская трехуровневая иерархия}}&#10;&#10;\end{center}&#10;&#10;&#10;%\vspace*{6pt}&#10;&#10;&#10;\addtocounter{figure}{1}&#10;&#10;&#10;&#10;&#10;&#10; \noindent&#10; имеют два индекса, соответствующих&#10;  номеру  ветки и~коду груза: $"/>
                                          <command value="\x">
                                            <braces>
                                              <text value="(i, j)$, $i"/>
                                            </braces>
                                          </command>
                                          <command value="\hm">
                                            <braces>
                                              <text value="= 1,"/>
                                            </braces>
                                          </command>
                                          <command value="\ldots">
                                            <braces>
                                              <text value=", n$, $j"/>
                                            </braces>
                                          </command>
                                          <command value="\hm">
                                            <braces>
                                              <text value="= 1,"/>
                                            </braces>
                                          </command>
                                          <command value="\ldots">
                                            <braces>
                                              <text value=", m"/>
                                            </braces>
                                          </command>
                                          <formula id="id103" value="$,&#10; где $"/>
                                          <text value="n"/>
                                          <formula id="id104" value="$~--- число веток,&#10;а~$"/>
                                          <text value="m"/>
                                          <formula id="id105" value="$~--- количество грузов.&#10; На среднем уровне~--- два семейства&#10;временн$"/>
                                          <command value="\acute">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <command value="\mbox">
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <text value="ы"/>
                                                    </braces>
                                                  </braces>
                                                  <braces/>
                                                  <braces/>
                                                </command>
                                                <formula id="id106" value="$х&#10; рядов. Временн$"/>
                                                <command value="\acute">
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <command value="\mbox">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <text value="ы"/>
                                                          </braces>
                                                        </braces>
                                                        <braces/>
                                                        <braces/>
                                                      </command>
                                                      <formula id="id107" value="$е ряды, соответствующие&#10;суммарному отправлению всех грузов с~каждой ветки,&#10; обозначаются $"/>
                                                      <command value="\x">
                                                        <braces>
                                                          <text value="(i, :)$,&#10;$i = 1,"/>
                                                        </braces>
                                                      </command>
                                                      <command value="\ldots">
                                                        <braces>
                                                          <text value=", n"/>
                                                        </braces>
                                                      </command>
                                                      <formula id="id108" value="$. Ряды среднего уровня, соответствующие&#10;суммарному отправлению со всех веток каждого из грузов,&#10;обозначаются $"/>
                                                      <command value="\x">
                                                        <braces>
                                                          <text value="(:, j)$, $j"/>
                                                        </braces>
                                                      </command>
                                                      <command value="\hm">
                                                        <braces>
                                                          <text value="= 1,"/>
                                                        </braces>
                                                      </command>
                                                      <command value="\ldots">
                                                        <braces>
                                                          <text value=", m"/>
                                                        </braces>
                                                      </command>
                                                      <formula id="id109" value="$. Временной ряд&#10;верхнего уровня обозначается $"/>
                                                      <command value="\x">
                                                        <braces>
                                                          <text value="(:, :)"/>
                                                        </braces>
                                                      </command>
                                                      <formula id="id110" value="$.&#10;&#10;Условие согласованности&#10;для трехуровневой иерархии задается равенствами ($"/>
                                                      <text value="t"/>
                                                      <command value="\hm">
                                                        <braces>
                                                          <text value="= 1,"/>
                                                        </braces>
                                                      </command>
                                                      <command value="\ldots">
                                                        <braces>
                                                          <text value=", T"/>
                                                        </braces>
                                                      </command>
                                                      <formula id="id111" value="$):&#10;\begin{equation}&#10;\left.&#10;\begin{array}{rl}&#10;    x_t(:, :) &amp;amp;= \displaystyle\sum\limits_{i = 1}^n x_t(i, :)\,;\\[6pt]&#10;    x_t(:, :) &amp;amp;= \displaystyle\sum\limits_{j = 1}^m x_t(:, j)\,;\\[6pt]&#10;    x_t(i, :) &amp;amp;= \displaystyle\sum\limits_{j = 1}^m x_t(i, j)\,, \enskip i = 1, \ldots n\,;  \\[6pt]&#10;    x_t(:, j) &amp;amp;= \displaystyle\sum\limits_{i = 1}^n x_t(i, j)\,, \enskip j = 1, \ldots m\,.&#10;    \end{array}&#10;    \right\}&#10;    \label{eq:3LevelConstraint}&#10;\end{equation}&#10;Векторная запись срезов иерархии, независимых прогнозов и~согласованных&#10;прогнозов имеет размерность $d \hm= 1 \hm+ n \hm+ m \hm+ nm$ и~выглядит&#10;сле\-ду\-ющим образом:&#10;$$&#10;    \boldsymbol{\chi}_t = \left(%&#10;        \begin{array}{c}&#10;            x_t(:, :) \\&#10;            x_t(1, :) \\&#10;            \vdots \\&#10;            x_t(n, :) \\&#10;            x_t(:, 1) \\&#10;            \vdots \\&#10;            x_t(:, m) \\&#10;            x_t(1, 1) \\&#10;            \vdots \\&#10;            x_t(1, m) \\&#10;            \vdots \\&#10;            x_t(n, 1) \\&#10;            \vdots \\&#10;            x_t(n, m) \\&#10;        \end{array}%&#10;        \right)\,; \quad&#10;    \hchi = \left(%&#10;        \begin{array}{c}&#10;            \hx(:, :) \\[2pt]&#10;            \hx(1, :) \\&#10;            \vdots \\&#10;            \hx(n, :) \\[2pt]&#10;            \hx(:, 1) \\&#10;            \vdots \\&#10;            \hx(:, m) \\[2pt]&#10;            \hx(1, 1) \\&#10;            \vdots \\&#10;            \hx(1, m) \\&#10;            \vdots \\&#10;            \hx(n, 1) \\&#10;            \vdots \\&#10;            \hx(n, m) \\&#10;        \end{array}%&#10;        \right)\,;&#10;        $$&#10;&#10;        \noindent&#10;        $$&#10;    \hphi = \left(%&#10;        \begin{array}{c}&#10;            \hy(:, :) \\&#10;            \hy(1, :) \\&#10;            \vdots \\&#10;            \hy(n, :) \\&#10;            \hy(:, 1) \\&#10;            \vdots \\&#10;            \hy(:, m) \\&#10;            \hy(1, 1) \\&#10;            \vdots \\&#10;            \hy(1, m) \\&#10;            \vdots \\&#10;            \hy(n, 1) \\&#10;            \vdots \\&#10;            \hy(n, m) \\&#10;        \end{array}%&#10;        \right).&#10;$$&#10;Матрица связей для условия~(\ref{eq:3LevelConstraint}) имеет размер&#10;$(2 \hm+ n \hm+ m) \times (1\hm+ n \hm+ m \hm+ nm)$:&#10;\begin{multline*}&#10;    S =&#10;\left(%&#10;\begin{array}{c|ccc|ccc|ccc}&#10;  -1 &amp;amp; 1 &amp;amp; \cdots &amp;amp; 1 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots\\&#10;  -1 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 1 &amp;amp; \cdots &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots\\&#10;  \hline&#10;  0 &amp;amp; -1 &amp;amp; \ddots &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; \cdots \\&#10;  \vdots &amp;amp; \ddots &amp;amp; \ddots &amp;amp; \ddots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots\\&#10;  0 &amp;amp; 0 &amp;amp; \ddots &amp;amp; -1 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots\\&#10;  \hline&#10;  0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; -1 &amp;amp; \ddots &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; \cdots\\&#10;  \vdots &amp;amp; \ddots &amp;amp; \ddots &amp;amp;\ddots  &amp;amp;\ddots  &amp;amp; \ddots &amp;amp; \ddots &amp;amp;   \ddots &amp;amp;\ddots  &amp;amp; \ddots\\&#10;  %\ddots &amp;amp; \ddots &amp;amp; \ddots &amp;amp; \ddots &amp;amp; \cdots &amp;amp;  \ddots&amp;amp;\ddots  &amp;amp;\ddots  &amp;amp;\ddots  &amp;amp; \ddots &amp;amp; \vdots \\&#10;  0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; -1 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots\\&#10;\end{array}\right.\\[6pt]&#10;\left.&#10;\begin{array}{cc|cccc|c|cccc}%&#10;  \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 \\&#10;    \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 \\&#10;      \cdots&amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 \\&#10;        \cdots &amp;amp; \cdots &amp;amp;\cdots  &amp;amp;\cdots  &amp;amp; \cdots &amp;amp; \cdots &amp;amp;\cdots  &amp;amp;\cdots  &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \vdots \\&#10;          \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; \cdots &amp;amp; 1 &amp;amp; 1 &amp;amp; \cdots &amp;amp; 1 \\&#10;  \cdots &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 &amp;amp; \cdots &amp;amp; 1 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 \\&#10;    \ddots &amp;amp; \ddots &amp;amp; \ddots &amp;amp; \ddots &amp;amp; \cdots &amp;amp;  \ddots&amp;amp;\ddots  &amp;amp;\ddots  &amp;amp;\ddots  &amp;amp; \ddots &amp;amp; \vdots \\&#10;      \cdots &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 1 &amp;amp; \cdots &amp;amp; 0 &amp;amp; 0 &amp;amp; \cdots &amp;amp; 1 \\&#10;\end{array}\right).&#10;\end{multline*}&#10;&#10;&#10;&#10;Требуется, чтобы все прогнозы были неотрицательны, поэтому&#10;множество $\mathcal{B}$~(\ref{eq:SetPhysicsConstraint}) задается как&#10;$$&#10;    \mathcal{B} = \{ \boldsymbol{\chi} \in \mathbb{R}^d \mid \boldsymbol{\chi}(i) \in [0, +\infty], i = 1, \ldots, d&#10;    \}.&#10;$$&#10;&#10;&#10;&#10;В качестве функции суммарных потерь~$l_h$~(\ref{eq:HierarchyLoss})&#10;используется квадрат евклидового расстояния.&#10;&#10;&#10;&#10;\paragraph*{Оптимизационная задача.} Задача, решенная для согласования&#10;прогнозов рассматриваемой иерархии, имеет вид:&#10;&#10;\columnbreak&#10;&#10;&#10;\noindent&#10;$$&#10;    \left\{%&#10;\begin{array}{l}&#10;    \| \boldsymbol{\chi} - \hchi \|^2 \rightarrow \min\limits_{\boldsymbol{\chi}}\,,  \\[9pt]&#10;    S \boldsymbol{\chi} = 0\,,  \\[9pt]&#10;    \boldsymbol{\chi} \geq 0\,.&#10;\end{array}%&#10;\right.&#10;$"/>
                                                      <formula id="id112" value="$&#10;&#10;&#10;\paragraph*{Результаты эксперимента.}&#10;Для прогноза были использованы временн$"/>
                                                      <command value="\acute">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <command value="\mbox">
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <text value="ы"/>
                                                                </braces>
                                                              </braces>
                                                              <braces/>
                                                              <braces/>
                                                            </command>
                                                            <formula id="id113" value="$е ряды, описывающие&#10;суммарный вес отправленных грузов разных типов по каждой ветке.&#10;Значения временн$"/>
                                                            <command value="\acute">
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <command value="\mbox">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <text value="ы"/>
                                                                      </braces>
                                                                    </braces>
                                                                    <braces/>
                                                                    <braces/>
                                                                  </command>
                                                                  <formula id="id114" value="$х рядов нижнего уровня иерархии были&#10;отнормированы на отрезок $"/>
                                                                </braces>
                                                              </braces>
                                                              <braces/>
                                                              <braces>
                                                                <text value="0; 1"/>
                                                              </braces>
                                                              <braces/>
                                                            </command>
                                                            <formula id="id115" value="$ по формуле&#10;\begin{equation*}&#10;    x_t^{\mathrm{norm}}(i, j) = \fr{x_t(i, j) - m(i, j)}{M(i, j) - m(i,&#10;    j)}\,,&#10;    \end{equation*}&#10;    где&#10;    $"/>
                                                            <formula id="id116" value="$&#10;    m = \min\limits_{t = 1, \ldots, T} x_t(i, j)\,, \enskip&#10;    M = \max\limits_{t = 1, \ldots, T} x_t(i, j)\,.&#10;$"/>
                                                            <formula id="id117" value="$&#10;&#10; Прогнозы были&#10;построены и~согласованы для~100~последних точек истории. Для&#10;каждого отсчета времени строился вектор независимых прогнозов~$"/>
                                                            <command value="\hchi"/>
                                                            <formula id="id118" value="$ и~вектор согласованных прогнозов~$"/>
                                                            <command value="\hphi"/>
                                                            <formula id="id119" value="$. Для каждого&#10;вектора вычислялось значение функции суммарных потерь, затем&#10;вычислялись потери игрока~1 в~игре~(\ref{eq:game}), равные&#10;разности суммарных потерь при использовании согласованных&#10;прогнозов и~суммарных потерь при использовании независимых&#10;прогнозов:&#10;$"/>
                                                            <formula id="id120" value="$&#10;    L_t = l_h(\hphi, \boldsymbol{\chi}_t) - l_h(\hchi, \boldsymbol{\chi}_t),&#10;    \quad t = T -&#10;    100 + 1, \ldots, T\,.&#10;$"/>
                                                            <formula id="id121" value="$&#10;Значения этой величины изображены на рис.~\ref{fig:LossDifference}.&#10;% По оси ординат во всех случаях отложены&#10;%номера контрольных точек. По оси абсцисс на рис.~\ref{fig:LossDifference},\,\textit{а} отложены номера железнодорожных веток,&#10;%на рис.~\ref{fig:LossDifference},\,\textit{б}~--- индексы грузов, на рис.~\ref{fig:LossDifference},\,\textit{в} по оси абсцисс только один отсчет,&#10;%соответствующий трехуровневой иерархии.&#10;Теоретические выкладки&#10;подтверждаются на практике. Для плоских двухуровневых иерархий&#10;есть случаи, когда суммарные потери при переходе к~согласованным&#10;прогнозам не изменяются, и~случаи, когда суммарные потери&#10;уменьшаются. Для неплоской трехуровневой иерархии суммарные потери&#10;во всех контрольных точках уменьшаются.&#10;&#10;&#10;\section{Заключение}&#10;&#10;Предложен алгоритм GTOp для согласования прогнозов иерархических&#10;временн$"/>
                                                            <command value="\acute">
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <command value="\mbox">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <text value="ы"/>
                                                                      </braces>
                                                                    </braces>
                                                                    <braces/>
                                                                    <braces/>
                                                                  </command>
                                                                  <formula id="id122" value="$х рядов. Алгоритм не требует оценки погрешностей&#10;независимых прогнозов и~не требует их несмещенности. Для любого&#10;набора независимых прогнозов временн$"/>
                                                                  <command value="\acute">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <command value="\mbox">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value="ы"/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                          <braces/>
                                                                        </command>
                                                                        <formula id="id123" value="$х рядов алгоритм согласования&#10;не ухудшает качество прогнозирования. Возможна работа с~иерархическими структурами любой сложности. Все свойства алгоритма&#10;согласования прогнозов GTOp под\-тверж\-да\-ются на практике.&#10;&#10;\pagebreak&#10;&#10;\end{multicols}&#10;&#10;        \begin{figure}%fig4&#10;    \vspace*{1pt}&#10; \begin{center}&#10; \mbox{%&#10; \epsfxsize=163.264mm&#10; \epsfbox{ste-4.eps}&#10; }&#10;\end{center}&#10; \vspace*{-9pt}&#10;    \Caption{Изменение суммарных потерь $L_t$:&#10;    (\textit{а})~для каждой ветки;&#10;(\textit{б})~для каждого груза;&#10;(\textit{в})~вся иерархия}&#10;    \label{fig:LossDifference}&#10;%   \vspace*{-9pt}&#10;\end{figure}&#10;&#10;\begin{multicols}{2}&#10;&#10;&#10;{\small\frenchspacing&#10; {%\baselineskip=10.8pt&#10; \addcontentsline{toc}{section}{References}&#10; \begin{thebibliography}{99}&#10;&#10;&#10;&#10;\bibitem{tokmakova2012hyper}&#10;\Au{Токмакова А.\,А., Стрижов В.\,В.} Оценивание&#10;    гиперпараметров линейных и~регрессионных моделей при отборе&#10;    шумовых и~коррелирующих признаков~// Информатика и~её&#10;    применения, 2012. Т.~6. Вып.~4. С.~66--75.&#10;&#10;&#10;&#10;    \bibitem{vasilyev2014using}&#10;\Au{Васильев Н.\,С.} Использование принципа равновесия для&#10;    управления маршрутизацией в~транспортных сетях~// Информатика&#10;    и~её применения, 2014. Т.~8. Вып.~1. С.~28--35.&#10;&#10;&#10;&#10;\bibitem{hong2014global}&#10;\Au{Hong T., Pinson P., Fan~S.} Global energy forecasting competition 2012~// Int.&#10;    J.~Forecasting, 2014. Vol.~30. No.\,2. P.~357--363.&#10;&#10;\bibitem{kaggle}&#10;    Kaggle. {\sf https://www.kaggle.com}.&#10;&#10;\bibitem{hyndman2011optimal}&#10;\Au{Hyndman R.\,J., Ahmed R.\,A., Athanasopoulos~G., Shang~H.\,L.} Optimal&#10;    combination forecasts for hierarchical time series~// Comput.&#10;    Stat. Data Anal., 2011. Vol.~55. No.\,9. P.~2579--2589.&#10;&#10;\bibitem{kuznetsov2011smoothing}&#10;\Au{Кузнецов М.\,П., Мафусалов А.\,А., Животовский~Н.\,К., Зайцев~Е.\,Ю.,&#10;    Сунгуров~Д.\,С.} Сглаживающие алгоритмы прогнозирования~// Машинное&#10;    обучение и~анализ данных, 2011. Т.~1. Вып.~1. С.~104--112.&#10;&#10;\bibitem{stenina2014reconciliation}&#10;\Au{Стенина М.\,М., Стрижов В.\,В.} Согласование агрегированных и~    детализированных прогнозов при решении задач непараметрического&#10;    прогнозирования~//&#10;    Системы и~средства информатики, 2014. Т.~24. Вып.~2. С.~21--34.&#10;&#10;\bibitem{grunfeld1960aggregation} %8&#10;\Au{Grunfeld Y., Griliches Z.} Is aggregation necessarily bad?~// Rev. Econ.&#10;Stat., 1960. Vol.~42. No.\,1. P.~1--13.&#10;&#10;\bibitem{orcutt1968data} %9&#10;\Au{Orcutt G.\,H., Watts H.\,W., Edwards~J.\,B.}&#10;Data aggregation and information loss~// Am. Econ. Rev., 1968. Vol.~58. No.\,4. P.~773--787.&#10;&#10;\bibitem{edwards1969should} %10&#10;\Au{Edwards J.\,B., Orcutt G.\,H.} Should aggregation prior to estimation be the rule?~//&#10;Rev. Econ. Stat., 1969. Vol.~51. No.\,4. P.~409--420.&#10;&#10;\bibitem{shlifer1979aggregation} %11&#10;\Au{Shlifer E., Wolff R.\,W.} Aggregation and proration in forecasting~// Manage.&#10;    Sci., 1979. Vol.~25. No.\,6. P.~594--603.&#10;&#10;    \bibitem{fogarty1991production} %12&#10;\Au{Fogarty D.\,W., Blackstone J.\,H., Hoffman~T.\,R.} Production and inventory&#10;    management.~--- 2nd ed.~--- Cincinnati, OH, USA: South-Western Publication Co.,&#10;    1990. 880~p.&#10;&#10;\bibitem{narasimhan1995production} %13&#10;\Au{Narasimhan S.\,L., McLeavey D.\,W., Billington~P.\,J.} Production planning and inventory&#10;    control.~--- 2nd ed.~--- Englewood Cliffs, NJ, USA: Prentice Hall,&#10;    1995. 716~p.&#10;&#10;\bibitem{schwarzkopf1988top} %14&#10;\Au{Schwarzkopf A.\,B., Tersine R.\,J., Morris~J.\,S.} Top-down versus bottom-up forecasting&#10;    strategies~// Int. J.~Prod. Res., 1998.&#10;    Vol.~26. No.\,11. P.~1833--1843.&#10;&#10;    \bibitem{fliedner1999investigation} %15&#10;\Au{Fliedner G.} An investigation of aggregate variable time series forecast strategies with&#10;    specific subaggregate time series statistical correlation~//&#10;    Comput. Oper. Res., 1999. Vol.~26. No.\,10--11.&#10;    P.~1133--1149.&#10;&#10;\bibitem{vanerven:hal-00920559} %16&#10;\Au{Van Erven T., Cugliari J.}  Game-theoretically optimal reconciliation of contemporaneous&#10;    hierarchical time series forecasts. 2013.&#10;    {\sf https://hal.inria.fr/hal-00920559}.&#10;&#10;&#10;&#10;\bibitem{petrosyan1998theory} %17&#10;\Au{Петросян Л.\,А., Зенкевич Н.\,А., Семина~Е.\,А.}&#10;Теория игр.~--- М.: Университет, 1998. 301~с.&#10;&#10;\bibitem{menshikov2010lections} %18&#10;\Au{Меньшиков И.\,С.} Лекции по теории игр и~экономическому моделированию.~--- 2-е&#10;    изд., испр. и~доп.~---&#10;    М.: Контакт Плюс, 2010. 336~с.&#10;&#10;\bibitem{cesa2006prediction} %19&#10;\Au{Cesa-Bianchi N., Lugosi G.} Prediction, learning, and games.~--- Cambridge: Cambridge&#10;    University Press, 2006. Vol.~1. 403~p.&#10;&#10;\bibitem{boyd2009convex} %20&#10;\Au{Boyd S., Vandenberghe L.} Convex optimization.~---&#10;Cambridge: Cambridge University Press, 2009. 732~p.&#10;&#10;\bibitem{bregman1967relaxation} %21&#10;\Au{Bregman L.\,M.} The relaxation method of finding the common point of convex sets and its&#10;    application to the solution of problems in convex programming~//&#10;    USSR Comput. Math. Math. Phys.,&#10;    1967. Vol.~7. No.\,3. P.~200--217.&#10;&#10;\bibitem{medvednikova2012nonparametric} %22&#10;\Au{Вальков А.\,С., Кожанов Е.\,М., Медведникова~М.\,М.,&#10;    Хусаинов~Ф.\,И.} Непараметрическое прогнозирование загруженности системы железнодорожных&#10;    узлов по историческим данным~// Машинное обучение и~анализ данных, 2012. Т.~1. Вып.~4. С.~448--465.&#10;     \end{thebibliography}&#10;&#10; }&#10; }&#10;&#10;\end{multicols}&#10;&#10;\vspace*{-3pt}&#10;&#10;\hfill{\small\textit{Поступила в~редакцию 27.10.14}}&#10;&#10;%\newpage&#10;&#10;\vspace*{12pt}&#10;&#10;\hrule&#10;&#10;\vspace*{2pt}&#10;&#10;\hrule&#10;&#10;%\vspace*{12pt}&#10;&#10;\def\tit{FORECASTS RECONCILIATION FOR HIERARCHICAL TIME SERIES FORECASTING PROBLEM}&#10;&#10;\def\titkol{Forecasts reconciliation for hierarchical time series forecasting problem}&#10;&#10;\def\aut{M.\,M.~Stenina$^1$ and V.\,V.~Strijov$^2$}&#10;&#10;\def\autkol{M.\,M.~Stenina and V.\,V.~Strijov}&#10;&#10;\titel{\tit}{\aut}{\autkol}{\titkol}&#10;&#10;\index{Stenina M.\,M.}&#10;\index{Strijov V.\,V.}&#10;&#10;\vspace*{-9pt}&#10;&#10;&#10;\noindent&#10;$"/>
                                                                        <text value="^1"/>
                                                                        <formula id="id124" value="$Moscow Institute of Physics and Technology, 9 Institutskiy Per.,&#10;Dolgoprudny, Moscow Region 141700, Russian\linebreak&#10;$"/>
                                                                        <command value="\hphantom">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value="^1"/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                        </command>
                                                                        <formula id="id125" value="$Federation&#10;&#10;\noindent&#10;$"/>
                                                                        <text value="^2"/>
                                                                        <formula id="id126" value="$Dorodnicyn Computing Center, Russian Academy of Sciences, 40~Vavilov Str.,&#10;Moscow 119333, Russian\linebreak&#10;$"/>
                                                                        <command value="\hphantom">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value="^1"/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                        </command>
                                                                        <formula id="id127" value="$Federation&#10;&#10;&#10;\def\leftfootline{\small{\textbf{\thepage}&#10;\hfill INFORMATIKA I EE PRIMENENIYA~--- INFORMATICS AND&#10;APPLICATIONS\ \ \ 2015\ \ \ volume~9\ \ \ issue\ 2}&#10;}%&#10; \def\rightfootline{\small{INFORMATIKA I EE PRIMENENIYA~---&#10;INFORMATICS AND APPLICATIONS\ \ \ 2015\ \ \ volume~9\ \ \ issue\ 2&#10;\hfill \textbf{\thepage}}}&#10;&#10;\vspace*{3pt}&#10;&#10;&#10;\Abste{The hierarchical time series forecasting problem is&#10;    researched. Time series forecasts must satisfy the physical&#10;    constraints and the hierarchical structure. In this paper,&#10;    a~new algorithm for hierarchical time series&#10;    forecasts reconciliation is proposed. The algorithm is called GTOp (Game-theoretically&#10;    optimal reconciliation). It guarantees that the quality of reconciled&#10;    forecasts is not worse than the quality of self-dependent forecasts.&#10;    This approach is based on Nash equilibrium search for the&#10;    antagonistic game and turns the forecasts reconciliation problem into&#10;    the optimization problem with equality and inequality&#10;    constraints. It is proved that the Nash&#10;    equilibrium in pure strategies exists in the game if some assumptions&#10;    about the hierarchical structure, the physical&#10;    constraints, and the loss function are satisfied. The algorithm&#10;    performance is demonstrated for different types of&#10;    hierarchical structures of time series.}&#10;&#10;\KWE{hierarchical time series; reconciliation of time&#10;    series forecasts; antagonistic game; Nash equilibrium}&#10;&#10;&#10;\DOI{10.14357/19922264150209}&#10;&#10;\Ack&#10;\noindent&#10;The research was financially supported by the Russian Foundation for&#10;Basic Research (project~13-07-13139).&#10;&#10;&#10;&#10;%\vspace*{3pt}&#10;&#10;  \begin{multicols}{2}&#10;&#10;\renewcommand{\bibname}{\protect\rmfamily References}&#10;%\renewcommand{\bibname}{\large\protect\rm References}&#10;&#10;&#10;&#10;{\small\frenchspacing&#10; {%\baselineskip=10.8pt&#10; \addcontentsline{toc}{section}{References}&#10; \begin{thebibliography}{99}&#10;&#10; \bibitem{tokmakova2012hyper-1}&#10;\Aue{Tokmakova, A.\,A., and V.\,V.~Strizhov}.&#10;2012. Otsenivanie giperparametrov lineynykh i~regressionnykh&#10;    modeley pri otbore shumovykh i~korreliruyushchikh priznakov [Estimation of linear model&#10;    hyperparameters for noise or correlated feature selection problem].&#10;    \textit{Informatika i~ee Primeneniya}~--- \textit{Inform. Appl.} 6(4):66--75.&#10;&#10;&#10;\bibitem{vasilyev2014using-1}&#10;    \Aue{Vasil&amp;apos;ev, N.\,S.} 2014. Ispol&amp;apos;zovanie printsipa ravnovesiya dlya upravleniya marshrutizatsiey v&#10;    transportnykh setyakh&#10;    [Equilibrium principle application to routing control in packet&#10;    data transmission networks]. \textit{Informatika i~ee Primeneniya}~---&#10;    \textit{Inform. Appl.} 8(1):28--35.&#10;&#10;\bibitem{hong2014global-1}&#10;\Aue{Hong, T., P.~Pinson, and S.~Fan}.&#10;2014. Global energy forecasting competition 2012.  \textit{Int.&#10;    J.~Forecasting} 30(2):357--363.&#10;&#10;\bibitem{kaggle-1}&#10;    Kaggle. Available at: {\sf https://www.kaggle.com} (accessed May~20, 2015).&#10;&#10;\bibitem{hyndman2011optimal-1}&#10;\Aue{Hyndman, R.\,J., R.\,A.~Ahmed, G.~Athanasopoulos, and H.\,L.~Shang}.&#10;2011. Optimal&#10;    combination forecasts for hierarchical time series. \textit{Comput.&#10;    Stat. Data Anal}. 55(9):2579--2589.&#10;&#10;\bibitem{kuznetsov2011smoothing-1} %6&#10;\Aue{Kuznetsov, M.\,P., A.\,A.~Mafusalov, N.\,K.~Zhivotovskiy, E.\,Yu.~Zaytsev,&#10;and D.\,S.~Sungurov}. 2011. Sglazhivayushchie algoritmy prognozirovaniya&#10;[Smoothing forecast algorithms]. \textit{Mashinnoe obuchenie i~analiz dannykh}&#10;[J.~Machine Learning Data Anal.] 1(1):104--112.&#10;&#10;\bibitem{stenina2014reconciliation-1}&#10;\Aue{Stenina, M.\,M., and V.\,V.~Strizhov}. 2014. Soglasovanie agregirovannykh i~detalizirovannykh&#10;prognozov pri re\-she\-nii zadach neparametricheskogo prognozirovaniya [Reconciliation&#10;    of aggregated and disaggregated time series forecasts in nonparametric&#10;    forecasting problem].&#10;\textit{Sistemy i~Sredstva Informatiki}~--- \textit{Systems and Means of&#10;    Informatics} 24(2):21--34.&#10;&#10;\bibitem{grunfeld1960aggregation-1} %8&#10;\Aue{Grunfeld, Y., and Z.~Griliches}.&#10;1960. Is aggregation necessarily bad? \textit{Rev. Econ.&#10;Stat.} 42(1):1--13.&#10;&#10;&#10;&#10;\bibitem{orcutt1968data-1} %9&#10;\Aue{Orcutt, G.\,H., H.\,W.~Watts,  and J.\,B.~Edwards}.&#10;1968. Data aggregation and information loss. \textit{Am. Econ. Rev.} 58(4):773--787.&#10;&#10;\bibitem{edwards1969should-1} %10&#10;\Aue{Edwards, J.\,B., and G.\,H.~Orcutt}. 1969.&#10;Should aggregation prior to estimation be the rule? \textit{Rev. Econ. Stat.} 51(4):409--420.&#10;&#10;\bibitem{shlifer1979aggregation-1} %11&#10;   \Aue{Shlifer, E., and R.\,W.~Wolff}. 1979. Aggregation and proration&#10;    in forecasting. \textit{Manage.&#10;    Sci.} 25(6):594--603.&#10;&#10;    \bibitem{fogarty1991production-1} %12&#10;\Aue{Fogarty, D.\,W., J.\,H.~Blackstone, and T.\,R.~Hoffman}. 1990.&#10;\textit{Production and inventory&#10;    management}. 2nd ed. Cincinnati, OH: South-Western Publication Co. 880~p.&#10;&#10;\bibitem{narasimhan1995production-1} %13&#10;\Aue{Narasimhan, S.\,L., D.\,W.~McLeavey, and P.\,J.~Billington}.&#10;1995. \textit{Production planning and inventory&#10;    control}. 2nd ed. Englewood Cliffs, NJ: Prentice Hall. 716~p.&#10;&#10;\bibitem{schwarzkopf1988top-1} %14&#10;\Aue{Schwarzkopf, A.\,B., R.\,J.~Tersine, and J.\,S.~Morris}.&#10;1998. Top-down versus bottom-up forecasting&#10;    strategies. \textit{Int. J.~Prod. Res}.&#10;    26(11):1833--1843.&#10;&#10;    \bibitem{fliedner1999investigation-1} %15&#10;\Aue{Fliedner, G.} 1999. An investigation of aggregate variable time series forecast strategies with&#10;    specifc subaggregate time series statistical correlation.&#10;    \textit{Comput. Oper. Res.} 26(10--11):1133--1149.&#10;&#10;\bibitem{vanerven:hal-00920559-1} %16&#10;    \Aue{Van Erven, T., and J.~Cugliari}.&#10;    2013. Game-theoretically optimal reconciliation of contemporaneous&#10;    hierarchical time series forecasts.&#10;    Available at: {\sf https://hal.inria.fr/hal-00920559}&#10;    (accessed May~20, 2015).&#10;&#10;    \bibitem{petrosyan1998theory-1} %17&#10;    \Aue{Petrosyan, L.\,A., N.\,A.~Zenkevich, and E.\,A.~Semina}.&#10;    1998. \textit{Teoriya igr} [Games theory]. Moscow: Knizhnyy Dom&#10;    Universitet. 301~p.&#10;&#10;\bibitem{menshikov2010lections-1} %18&#10;\Aue{Men&amp;apos;shikov, I.\,S.} 2010. \textit{Lektsii po teorii igr&#10;i~eko\-no\-mi\-che\-sko\-mu modelirovaniyu}     [Games&#10;    theory and economics modeling lectures]. 2nd~ed.&#10;    Moscow: OOO Kontakt Plyus. 336~p.&#10;&#10;&#10;&#10;\bibitem{cesa2006prediction-1} %19&#10;\Aue{Cesa-Bianchi, N., and G.~Lugosi.} 2006.&#10;\textit{Prediction, learning, and games.} Cambridge: Cambridge&#10;    University Press. Vol.~1. 403~p.&#10;&#10;\bibitem{boyd2009convex-1}&#10;\Aue{Boyd, S., and L.~Vandenberghe}. 2009. \textit{Convex optimization}.&#10;Cambridge: Cambridge University Press. 732~p.&#10;&#10;\bibitem{bregman1967relaxation-1}&#10;\Aue{Bregman, L.\,M.} 1967. The relaxation method of finding the common point&#10;of convex sets and its application to the solution of problems in convex&#10;programming. \textit{USSR Comput. Math. Math. Phys.} 7(3):200--217.&#10;&#10;\bibitem{medvednikova2012nonparametric-1}&#10;\Aue{Val&amp;apos;kov, A.\,S., E.\,M.~Kozhanov, M.\,M.~Medvednikova, and F.\,I.~Khusainov}.&#10;2012.&#10;    Neparametricheskoe prognozirovanie zagruzhennosti sistemy&#10;    zheleznodorozhnykh uzlov po istoricheskim dannym [Nonparametric&#10;    forecasting of railroad stations occupancy according to historical&#10;    data]. \textit{Mashinnoe Obuchenie i~Analiz Dannykh} [J.~Machine&#10;    Learning Data Anal.] 1(4):448--465.&#10;&#10;    \end{thebibliography}&#10;&#10; }&#10; }&#10;&#10;\end{multicols}&#10;&#10;\vspace*{-3pt}&#10;&#10;\hfill{\small\textit{Received October 27, 2014}}&#10;&#10;%\vspace*{-18pt}&#10;&#10;    \Contr&#10;&#10;&#10;    \noindent&#10;    \textbf{Stenina Mariya M.} (b.\ 1991)~---&#10;    student, Moscow Institute of Physics and Technology, 9 Institutskiy Per.,&#10;    Dolgoprudny, Moscow Region 141700, Russian Federation; mmedvednikova@gmail.com&#10;&#10;    \vspace*{3pt}&#10;&#10;    \noindent&#10;    \textbf{Strijov Vadim V.} (b.\ 1967)~--- Doctor of Science&#10;    in physics and mathematics, leading scientist,&#10;    Dorodnicyn Computing Center, Russian Academy of Sciences, 40~Vavilov Str.,&#10;    Moscow 119333, Russian Federation; strijov@gmail.com&#10;&#10;&#10;&#10;&#10;&#10;&#10;\label{end\stat}&#10;&#10;&#10;\renewcommand{\bibname}{\protect\rm Литература}"/>
                                                                      </braces>
                                                                    </braces>
                                                                  </command>
                                                                </braces>
                                                              </braces>
                                                            </command>
                                                          </braces>
                                                        </braces>
                                                      </command>
                                                    </braces>
                                                  </braces>
                                                </command>
                                              </braces>
                                            </braces>
                                          </command>
                                        </braces>
                                      </braces>
                                    </command>
                                  </braces>
                                </braces>
                              </command>
                            </braces>
                          </braces>
                        </command>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
    </fulltext>
  </paper>
</papers>