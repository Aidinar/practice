<?xml version="1.0" encoding="utf-8"?>
<papers>
  <paper>
    <metadata>
      <author value="\index{}"/>
      <author value="\index{}"/>
      <author value="\index{}"/>
      <author value="\index{}"/>
      <annotation value="\Abst{Работа посвящена построению модели многоклассовой классификации временн${{ы}"/>
    </metadata>
    <fulltext>
      <literature/>
      <text value="isachenko"/>
      <text value="МЕТРИЧЕСКОЕ ОБУЧЕНИЕ В ЗАДАЧАХ МУЛЬТИКЛАССОВОЙ КЛАССИФИКАЦИИ ВРЕМЕННЫХ РЯДОВ$^*$"/>
      <text value="Метрическое обучение в задачах мультиклассовой классификации временных рядов"/>
      <text value="Р."/>
      <text value="В. Исаченко$^1$, В."/>
      <text value="В. Стрижов$^2$"/>
      <text value="Р."/>
      <text value="В. Исаченко, В."/>
      <text value="В. Стрижов"/>
      <command value="\titel">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\tit">
              <braces/>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\aut">
                    <braces/>
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\autkol">
                          <braces/>
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <command value="\titkol">
                                <braces/>
                              </command>
                            </braces>
                          </braces>
                        </command>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <text value="Исаченко Р."/>
      <text value="В."/>
      <text value="Стрижов В."/>
      <text value="В."/>
      <text value="Isachenko R."/>
      <text value="V."/>
      <text value="Strijov V."/>
      <text value="V."/>
      <braces>
        <text value="{}"/>
        <command value="\renewcommand">
          <braces>
            <braces>
              <text value="{}"/>
              <command value="\thefootnote">
                <braces/>
                <braces>
                  <braces>
                    <text value="{}"/>
                    <command value="\fnsymbol">
                      <braces>
                        <braces>
                          <text value="{}"/>
                          <text value="footnote"/>
                        </braces>
                      </braces>
                      <braces/>
                      <braces/>
                    </command>
                  </braces>
                </braces>
              </command>
            </braces>
          </braces>
        </command>
      </braces>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[1]{}"/>
        </braces>
      </command>
      <text value="Работа выполнена при финансовой поддержке РФФИ (проект 16-07-01158)."/>
      <command value="\renewcommand">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\thefootnote">
              <braces/>
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\arabic">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="footnote"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[1]{}"/>
        </braces>
      </command>
      <text value="Московский физико-технический институт, isa-ro@yandex.ru"/>
      <command value="\footnotetext">
        <braces>
          <text value="\footnotetext[2]{}"/>
        </braces>
      </command>
      <text value="Вычислительный центр им."/>
      <text value="А."/>
      <text value="А. Дородницына Федерального исследовательского центра &amp;lt;&amp;lt;Информатика и управление&amp;gt;&amp;gt; Российской академии наук, strijov@ccas.ru"/>
      <formula id="id1" value="$х рядов.&#10;    Предлагается выравнивать временн$"/>
      <command value="\acute">
        <braces>
          <braces>
            <text value="{}"/>
            <command value="\mbox">
              <braces>
                <braces>
                  <text value="{}"/>
                  <text value="ы"/>
                </braces>
              </braces>
              <braces/>
              <braces/>
            </command>
            <formula id="id2" value="$е ряды относительно центроидов классов.&#10;    Процедура нахождения центроидов и~выравнивания временн$"/>
            <command value="\acute">
              <braces>
                <braces>
                  <text value="{}"/>
                  <command value="\mbox">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <text value="ы"/>
                      </braces>
                    </braces>
                    <braces/>
                    <braces/>
                  </command>
                  <formula id="id3" value="$х рядов осуществляется с~помощью алгоритма динамической трансформации &#10;    времени.&#10;    Для повышения качества классификации в~данной работе используются методы метрического обучения.&#10;    Метрическое обучение позволяет модифицировать расстояния между временн$"/>
                  <command value="\acute">
                    <braces>
                      <braces>
                        <text value="{}"/>
                        <command value="\mbox">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <text value="ы"/>
                            </braces>
                          </braces>
                          <braces/>
                          <braces/>
                        </command>
                        <formula id="id4" value="$ми рядами, сближая &#10;    временн$"/>
                        <command value="\acute">
                          <braces>
                            <braces>
                              <text value="{}"/>
                              <command value="\mbox">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <text value="ы"/>
                                  </braces>
                                </braces>
                                <braces/>
                                <braces/>
                              </command>
                              <formula id="id5" value="$е ряды из одного класса и~отдаляя временн$"/>
                              <command value="\acute">
                                <braces>
                                  <braces>
                                    <text value="{}"/>
                                    <command value="\mbox">
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <text value="ы"/>
                                        </braces>
                                      </braces>
                                      <braces/>
                                      <braces/>
                                    </command>
                                    <formula id="id6" value="$е ряды из разных классов.&#10;    Расстояние между временн$"/>
                                    <command value="\acute">
                                      <braces>
                                        <braces>
                                          <text value="{}"/>
                                          <command value="\mbox">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="ы"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                            <braces/>
                                          </command>
                                          <formula id="id7" value="$ми рядами измеряется с~помощью метрики Махаланобиса.&#10;    Процедура метрического обучения состоит в~определении оптимальной матрицы трансформаций &#10;    в~метрике Махаланобиса.&#10;    Для анализа качества построенного алгоритма проведен вычислительный эксперимент на синтетических и~реальных данных показаний с~акселерометра мобильного телефона.}&#10;&#10;&#10;\KWE{классификация временных рядов; выравнивание; метрическое обучение; алгоритм LMNN}&#10;&#10;\DOI{10.14357/19922264160205} &#10;&#10;%\vspace*{-4pt}&#10;&#10;\vskip 10pt plus 9pt minus 6pt&#10;&#10;\thispagestyle{headings}&#10;&#10;\begin{multicols}{2}&#10;&#10;\label{st\stat}&#10;&#10;\section{Введение}&#10;&#10;Решается задача мультиклассовой классификации временн$\acute{\mbox{ы}}$х &#10;рядов~\cite{popova2015multiclass, ignatov2015multiclass}.&#10;Для решения этой задачи ранее использовались: метод опорных &#10;векторов~\cite{guler2007mccsvm, ubeyli2007mccsvm2}, нейронные &#10;сети~\cite{anand1995mccnn}, байесовский подход~\cite{kafai2012mccbn}.&#10;В данной работе для классификации временн$\acute{\mbox{ы}}$х рядов используется идея &#10;ближайших соседей~\cite{chaovalitwongse2007knn}.&#10;&#10;Для повышения качества классификации предлагается использовать методы &#10;метрического обучения~[8--10].&#10;%\cite{bellet2013mlsurvey, yang2006mlsurvey2, wang2015mlsurvey3}.&#10;Метрическое обучение позволяет модифицировать расстояния между временн$\acute{\mbox{ы}}$ми &#10;рядами с~помощью линейного преобразования признакового пространства объектов.&#10;В~результате преобразования временн$\acute{\mbox{ы}}$е ряды одного класса оказываются ближе &#10;друг к~другу по выбранной метрике, а~временн$\acute{\mbox{ы}}$е ряды, принадлежащие разным классам, &#10;отдаляются друг от друга.&#10;Методы метрического обучения применяются при ранжировании поисковой &#10;выдачи~\cite{mcfee2010mlranking}, идентификации лиц~\cite{guillaumin2009mlface}, &#10;распознавании рукописных цифр~\cite{weinberger2008mldigits}.&#10;В~данной работе в~качестве алгоритма метрического обучения был выбран &#10;алгоритм LMNN (Large Margin Nearest Neighbor)~\cite{weinberger2005lmnn}.&#10;Данный алгоритм основан на идеях метода $k$ ближайших соседей.&#10;Алгоритм для каж\-до\-го объекта минимизирует расстояния до~$k$~ближайших соседей, &#10;принадлежащих тому же классу, и~штрафует объекты из других классов, попавшие &#10;на расстояние порядка расстояния до~$k$-го ближайшего соседа.&#10;&#10;Алгоритм LMNN позволяет произвести отбор признаков.&#10;С~помощью линейного преобразования алгоритм помещает объекты в~новое пространство.&#10;Если размерность нового пространства меньше размерности исходного пространства, &#10;то происходит снижение размерности, т.\,е.\ отбор признаков.&#10;&#10;Для вычисления расстояний между временн$\acute{\mbox{ы}}$ми рядами в~данной работе &#10;производится &#10;их выравнивание относительно центроидов классов &#10;методом динамической трансформации времени DTW &#10;(Dynamic Time Warping)~\cite{berndt1994dtw}.&#10;Задача поиска оптимального центроида класса решается с~помощью метода &#10;выравненного взвешенного усреднения DBA (DTW Barycenter Averaging)~\cite{petitjean2011dba}.&#10;Классификация, основанная на идее ближайших соседей, чувствительна &#10;к~изменению масштабов признаков.&#10;Для повышения устойчивости классификации выравненные временн$\acute{\mbox{ы}}$е ряды были &#10;отнормированы.&#10;&#10;Таким образом, полученная модель классификации представляет собой &#10;суперпозицию алгоритмов построения центроидов, выравнивания временн$\acute{\mbox{ы}}$х &#10;рядов относительно центроидов классов, метрического обучения и~классификации.&#10;&#10;\renewcommand{\figurename}{\protect\bf Алгоритм}&#10;&#10;\begin{figure*}[b]&#10;\vspace*{9pt}&#10;\hrule&#10;&#10;\vspace*{-4pt}&#10;&#10;\noindent&#10;\Caption{Нахождение центроида $"/>
                                          <command value="\mathrm">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="DBA"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                            <braces>
                                              <text value="("/>
                                            </braces>
                                          </command>
                                          <command value="\mathbf">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="X"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                            <braces>
                                              <text value="_e,"/>
                                            </braces>
                                          </command>
                                          <command value="\mathrm">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="n"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                          </command>
                                          <command value="\_"/>
                                          <command value="\mathrm">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="iter"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                            <braces>
                                              <text value=")"/>
                                            </braces>
                                          </command>
                                          <formula id="id8" value="$}&#10;\label{DBA_pseudo}&#10;&#10;\vspace*{6pt}&#10;&#10;\hrule&#10;&#10;\vspace*{6pt}&#10;&#10;\noindent&#10;\textbf{Вход:}\ $\mathbf{X}_e$~--- множество временн$\acute{\mbox{ы}}$х рядов, принадлежащих &#10;одному и~тому же классу, n\_iter~--- количество&#10;&#10;\ \ \ \ \ \  итераций алгоритма.&#10;&#10;\noindent&#10;\textbf{Выход:}\ $\mathbf{c}$~--- центроид множества $\mathbf{X}_e$.&#10;&#10;\ 1:\ \ задать начальное приближение приближение центроида $\mathbf{c}$;&#10;&#10;\ 2:\ \ \textbf{для}\ $i = 1, \dots, \text{n\_iter}$&#10;&#10;\ 3:\ \ \ \ \textbf{для} $\mathbf{x} \in \mathbf{X}_e$&#10;&#10;\ 4:\ \ \ \ \ \ вычислить выравнивающий путь между $\mathbf{c}$ и~$\mathbf{x}$\newline&#10;\hphantom{\ 4:}\ \ \ \ \ \ $\mathrm{alignment}(\mathbf{x}) := \mathrm{DTWalignment}(\mathbf{c}, \mathbf{x})$;&#10;&#10;\ 5:\ \ \ \ объединить поэлементно множества индексов для каждого отсчета времени\newline&#10;\hphantom{\ 4:}\ \ \ \ $\mathrm{alignment} := \bigcup_{\mathbf{x} \in \mathbf{X}_e} \text{alignment}(\mathbf{x})$;&#10;&#10;\ 6:\ \ \ \ $\mathbf{c} = \text{mean}(\text{alignment})$&#10;&#10;\&#10;&#10;&#10;ПРОЦЕДУРА $\mathrm{DTWalignment}(\mathbf{c}, \mathbf{x})$&#10;&#10;\noindent&#10;\textbf{Вход:}\ $\mathbf{c}, \mathbf{x}$~--- временн$\acute{\mbox{ы}}$е ряды.&#10;&#10;\noindent&#10;\textbf{Выход:}\ alignment~--- выравнивающий путь.~// {каждый индекс &#10;временного ряда~$"/>
                                          <command value="\mathbf">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="x"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                          </command>
                                          <formula id="id9" value="$ поставлен в~однозначное\newline&#10;\hphantom{\ 1:}\ \ соответствие индексу временного ряда~$"/>
                                          <command value="\mathbf">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <text value="c"/>
                                              </braces>
                                            </braces>
                                            <braces/>
                                          </command>
                                          <formula id="id10" value="$}&#10;&#10;\ 1:\ \  {построить $"/>
                                          <text value="n"/>
                                          <command value="\times">
                                            <braces>
                                              <text value="n"/>
                                            </braces>
                                          </command>
                                          <formula id="id11" value="$-матрицу деформаций DTW}\newline&#10;\hphantom{\ 1:}\ \ $\mathrm{cost} := \mathrm{DTW}(\mathbf{c}, \mathbf{x})$;&#10;&#10;\ 2:\ \ {вычислить выравнивающий путь по матрице деформаций}\newline&#10;\hphantom{\ 1:}\ \ $\mathrm{alignment} := \mathrm{DTWpath}(\mathrm{cost})$;&#10;&#10;\vspace*{6pt}&#10;&#10;\hrule&#10;\end{figure*}&#10;&#10;В данной работе вычислительный эксперимент проводился на синтетических временн$\acute{\mbox{ы}}$х &#10;рядах, представляющих аналитические функции, и~реальных данных показаний акселерометра &#10;мобильного телефона.&#10;Цель эксперимента~--- определить вид активности человека по форме сигнала акселерометра.&#10;Получена оценка качества работы построенного алгоритма и~проведен анализ его свойств.&#10;&#10;\section{Постановка задачи}&#10;&#10;Пусть объект $\mathbf{x}_i \hm\in \mathbb{R}^n$~--- временн$\acute{\mbox{о}}$й ряд, последовательность &#10;измерений некоторой исследуемой величины в~различные моменты времени.&#10;Пусть $\mathbf{X}$~--- множество всех временн$\acute{\mbox{ы}}$х рядов фиксированной длины~$n$; &#10;$Y \hm= \{1, \dots, K\}$~--- множество меток классов.&#10;Пусть задана выборка $\mathfrak{D} \hm= \{(\mathbf{x}_i, y_i)\}_{i=1}^\ell$~--- &#10;множество объектов с~известными метками классов $y_i \hm\in Y$.&#10;&#10;Требуется построить точную, простую, устойчивую модель классификации&#10;$$&#10;    a: \mathbf{X} \toY\,.&#10;$$&#10;Данную модель представим в~виде суперпозиции&#10;\begin{equation*}&#10;%\label{eq:classifiers}&#10;a(\mathbf{x}) = b \circ\mathbf{f} \circG(\mathbf{x}, \{\mathbf{c}_e\}_{e = 1} ^ K)\,,&#10;\end{equation*}&#10; где $G$~--- процедура выравнивания временн$\acute{\mbox{ы}}$х рядов относительно &#10; центроидов классов~$\{\mathbf{c}_e\}_{e = 1} ^ K$; $\mathbf{f}$~--- &#10; алгоритм метрического обучения; $b$~--- алгоритм многоклассовой классификации.&#10;&#10;\subsection{Выравнивание временн$"/>
                                          <command value="\acute">
                                            <braces>
                                              <braces>
                                                <text value="{}"/>
                                                <command value="\mbox">
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <text value="ы"/>
                                                    </braces>
                                                  </braces>
                                                  <braces/>
                                                  <braces/>
                                                </command>
                                                <formula id="id12" value="$х рядов}&#10;&#10;Для повышения качества и~устойчивости алгоритма классификации предлагается &#10;провести выравнивание временн$\acute{\mbox{ы}}$х рядов каждого класса относительно центроида.&#10;&#10;Пусть $\mathbf{X}_e$ --- множество объектов обучающей выборки $\mathfrak{D}$, &#10;принадлежащих одному классу $e \hm\in \{1, \dots, K\}$.&#10;Центроидом множества объектов $\mathbf{X}_e \hm= \{\mathbf{x}_i|y_i=e\}_{i=1}^\ell$ &#10;по расстоянию~$\rho$ назовем вектор $\mathbf{c}_e \hm\in \mathbb{R}^n$ такой, что&#10;\begin{equation}&#10;\label{centroid_task}&#10;    \mathbf{c}_e = \mathop{\mathrm{argmin}}\limits_{{\mathbf{c} &#10;    \in \mathbb{R}^n}}\sum\limits_{\mathbf{x}_i \in \mathbf{X}_e}&#10;    {\rho(\mathbf{x}_i ,\mathbf{c})}\,.&#10;\end{equation}&#10;&#10;Для нахождения центроида предлагается в~качестве расстояния между &#10;временн$\acute{\mbox{ы}}$ми рядами использовать путь наименьшей стоимости~\cite{goncharov2015cost}, &#10;найден\-ный методом динамической трансформации времени.&#10;Псевдокод решения оптимизационной задачи~(\ref{centroid_task}) приведен &#10;в~алгоритме~1.&#10;&#10;&#10;&#10;Общая процедура выравнивания имеет сле\-ду\-ющий вид:&#10;\begin{enumerate}[(1)]&#10;    \item&#10;    построить множество центроидов классов $\{\mathbf{c}_e\}_{e = 1}^K$;&#10;    \item&#10;    по множеству центроидов найти пути наименьшей стоимости между каждым&#10;    временн$\acute{\mbox{ы}}$м рядом~$\mathbf{x}_i$ и~центроидом его класса~$\mathbf{c}_{y_i}$;&#10;    \item&#10;    по каждому пути восстановить выравненный временной ряд;&#10;    \item&#10;        привести множества выравненных временн$\acute{\mbox{ы}}$х рядов к~нулевому среднему и~нормировать на дисперсию.&#10;\end{enumerate}&#10;&#10;Результатом выравнивания должно стать множество выравненных временн$\acute{\mbox{ы}}$х рядов.&#10;&#10;\subsection{Метрическое обучение}&#10;&#10;Введем на множестве выравненных временн$\acute{\mbox{ы}}$х рядов расстояние Махаланобиса&#10;$$&#10;    d_\mathbf{A} (\mathbf{x}_i, \mathbf{x}_j) = \sqrt{(\mathbf{x}_i - \mathbf{x}_j)^\mathsf{T} \mathbf{A} (\mathbf{x}_i - \mathbf{x}_j)}\,,&#10;$$&#10;где матрица трансформаций $\mathbf{A} \hm\in \mathbb{R}^{n \times n}$ &#10;является симметричной и~неотрицательно определенной ($\mathbf{A}^\mathsf{T} \hm= &#10;\mathbf{A}$, $\mathbf{A} \succeq 0$).&#10;Представим матрицу~$\mathbf{A}$ в~виде разложения &#10;$\mathbf{A} \hm= \mathbf{L}^\mathsf{T}  \mathbf{L}$.&#10;Матрица $\mathbf{L}\hm\in \mathbb{R}^{p \times n}$~--- мат\-ри\-ца линейного преобразования, &#10;где~$p$ задает раз\-мер\-ность преобразованного пространства. Если па\-ра\-метр $p\hm&amp;lt; n$, &#10;то происходит снижение размерности признакового пространства.&#10;&#10;Расстояние $d_\mathbf{A} (\mathbf{x}_i, \mathbf{x}_j)$ есть евклидово &#10;рас\-сто\-яние между $\mathbf{Lx}_i$ и~$\mathbf{Lx}_j$:&#10;\begin{multline*}&#10;    d_\mathbf{A} (\mathbf{x}_i, \mathbf{x}_j) = \sqrt{(\mathbf{x}_i - &#10;    \mathbf{x}_j)^\mathsf{T} \mathbf{L}^\mathsf{T} \mathbf{L} (\mathbf{x}_i - &#10;    \mathbf{x}_j)} = {}\\&#10;    {}=\sqrt{(\mathbf{L} (\mathbf{x}_i - \mathbf{x}_j))^\mathsf{T} &#10;    (\mathbf{L} (\mathbf{x}_i - \mathbf{x}_j))} =&#10;     \|\mathbf{L} (\mathbf{x}_i - \mathbf{x}_j)\|_2\,.&#10;\end{multline*}&#10;&#10;В качестве алгоритма метрического обучения в~данной работе был выбран &#10;алгоритм LMNN. \mbox{Данный} алгоритм сочетает в~себе идеи метода~$k$~ближайших соседей. &#10;Первая идея заключается в~минимизации расстояний между~$k$~ближайшими объектами, &#10;находящимися в~одном клас\-се. Запишем функционал качества в~виде&#10;$$&#10;    Q_1(\mathbf{L}) = \sum\limits_{j \rightsquigarrow i} \|\mathbf{L}(\mathbf{x}_i - &#10;    \mathbf{x}_j)\|^2 \rightarrow \min\limits_{\mathbf{L}}\,,&#10;$$&#10;где $j \rightsquigarrow i$ означает, что $\mathbf{x}_j$ является одним из~$k$~ближайших соседей для $\mathbf{x}_i$.&#10;Вторая идея состоит в~максимизации расстояния между каждым объектом и~его &#10;объ\-ек\-та\-ми-на\-ру\-ши\-те\-ля\-ми. &#10;Объек\-том-на\-ру\-ши\-те\-лем для $\mathbf{x}_i$ назовем объект~$\mathbf{x}_l$ &#10;такой, что&#10;\begin{equation}&#10;\label{impostor}&#10;    \|\mathbf{L}(\mathbf{x}_i - \mathbf{x}_l)\|^2 \leq &#10;    \|\mathbf{L}(\mathbf{x}_i - \mathbf{x}_j)\|^2 + 1,  &#10;    \mbox{ где } j \rightsquigarrow i.&#10;\end{equation}&#10;Таким образом, необходимо минимизировать следующий функционал:&#10;\begin{multline*}&#10;    Q_2(\mathbf{L}) = \sum\limits_{j \rightsquigarrow i} &#10;    \sum\limits_l(1 - y_{il})&#10;    \bigl[1 + \|\mathbf{L}(\mathbf{x}_i - \mathbf{x}_j)\|^2 -{}\\&#10;    {}- \|\mathbf{L}&#10;    (\mathbf{x}_i - \mathbf{x}_l)\|^2\bigr]_+ &#10;    \rightarrow \min\limits_{\mathbf{L}}\,,&#10;\end{multline*}&#10;где $y_{il} = 1$, если $y_i \hm= y_l$, и~$y_{il} \hm= 0$ в~противном случае.&#10;Положительная срезка позволяет штрафовать только те объекты, которые &#10;удовлетворяют условию~(\ref{impostor}).&#10;&#10;Задача метрического обучения состоит в~на\-хож\-де\-нии линейного &#10;преобразования $\mathbf{f}(\mathbf{x}) \hm= \mathbf{Lx}$, т.\,е.\ &#10;нахождении матрицы~$\mathbf{L}$ в~виде решения оптимизационной задачи&#10;\begin{equation}&#10;\label{Qmin}&#10;    Q(\mathbf{L}) = \mu Q_1(\mathbf{L}) + (1 - \mu) Q_2(\mathbf{L}) &#10;    \rightarrow \min\limits_{\mathbf{L}}\,,&#10;\end{equation}&#10;где $\mu \in (0, 1)$~--- весовой параметр, определяющий вклад каждого из функционалов.&#10;Задача~(\ref{Qmin}) представляет собой задачу полуопределенного &#10;программирования~\cite{vandenberghe1996semidefinite} и~может быть решена &#10;сущест\-ву\-ющи\-ми оптимизационными пакетами.&#10;&#10;\subsection{Классификация временн$"/>
                                                <command value="\acute">
                                                  <braces>
                                                    <braces>
                                                      <text value="{}"/>
                                                      <command value="\mbox">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <text value="ы"/>
                                                          </braces>
                                                        </braces>
                                                        <braces/>
                                                        <braces/>
                                                      </command>
                                                      <formula id="id13" value="$х рядов}&#10;&#10;Пусть $\mathbf{x} \in \mathbf{X}$~--- неразмеченный временной ряд. &#10;Выравниваем временной ряд~$\mathbf{x}$ относительно всех центроидов классов&#10;$    \mathbf{\hat{x}}_e = G(\mathbf{x}, \mathbf{c}_e)\,,  \mbox{ где } &#10;    e \hm= \{1, \dots, K\}.$&#10;&#10;Отнесем временной ряд к~классу, для которого минимально расстояние &#10;до соответствующего центроида. В~качестве расстояния используем обучен\-ную метрику &#10;Махаланобиса с~фиксированной мат\-ри\-цей~$\mathbf{A}$:&#10;$$&#10;    \hat{y} = \mathop{\mathrm{argmin}}\limits_{e \in \{1, \dots, K\}}&#10;    d_\mathbf{A}\left(\mathbf{\hat{x}}_e, \mathbf{c}_e\right)\,.&#10;$$&#10;После нахождения оптимальных центроидов классов и~нахождения &#10;оптимальной матрицы трансформаций процедура классификации заключается &#10;в~измерении расстояния между найденными центроидами и~новыми неразмеченными объектами.&#10;&#10;Для оценки качества работы алгоритма будем вычислять ошибку классификации &#10;как долю неправильно классифицированных объектов тестовой выборки~$\mathfrak{U}$:&#10;$$&#10;    \mathrm{error} = \fr{1}{|\mathfrak{U}|} &#10;    \sum\limits_{i = 1} ^ {|\mathfrak{U}|}\left[a\left(\mathbf{x}_i\right) \ne y_i\right].&#10;$$&#10;&#10;\section{Вычислительный эксперимент}&#10;&#10;Цель вычислительного эксперимента~--- проверить работоспособность предложенного &#10;подхода.&#10;Предполагается, что построенный алгоритм мультиклассовой классификации &#10;способен определить тип активности человека по форме сигнала акселерометра &#10;мобильного телефона.&#10;&#10;\renewcommand{\figurename}{\protect\bf Рис.}&#10;\setcounter{figure}{0}&#10;&#10;&#10;\begin{figure*} %fig1&#10;\vspace*{1pt}&#10; \begin{center}  &#10;\mbox{%&#10; \epsfxsize=79.311mm&#10; \epsfbox{isa-1.eps}&#10; }&#10;\end{center} &#10;\vspace*{-15pt}&#10;\Caption{Центроиды синтетических временн$"/>
                                                      <command value="\acute">
                                                        <braces>
                                                          <braces>
                                                            <text value="{}"/>
                                                            <command value="\mbox">
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <text value="ы"/>
                                                                </braces>
                                                              </braces>
                                                              <braces/>
                                                              <braces/>
                                                            </command>
                                                            <formula id="id14" value="$х рядов двух&#10;    классов: \textit{1}~--- $"/>
                                                            <command value="\sin">
                                                              <braces>
                                                                <text value="(x"/>
                                                              </braces>
                                                            </command>
                                                            <command value="\hm">
                                                              <braces>
                                                                <text value="+b)"/>
                                                              </braces>
                                                            </command>
                                                            <formula id="id15" value="$; \textit{2}~--- пилообразные функции&#10;    с~различными сдвигами по временн$"/>
                                                            <command value="\acute">
                                                              <braces>
                                                                <braces>
                                                                  <text value="{}"/>
                                                                  <command value="\mbox">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <text value="о"/>
                                                                      </braces>
                                                                    </braces>
                                                                    <braces/>
                                                                    <braces/>
                                                                  </command>
                                                                  <formula id="id16" value="$й шкале}&#10;%\end{figure*}&#10;%\begin{figure*} %fig2&#10;\vspace*{1pt}&#10; \begin{center}&#10; \mbox{%&#10; \epsfxsize=163.735mm&#10; \epsfbox{isa-2.eps}&#10; }&#10; \end{center}&#10; \vspace*{-15pt}&#10;    \Caption{Центроиды временн$"/>
                                                                  <command value="\acute">
                                                                    <braces>
                                                                      <braces>
                                                                        <text value="{}"/>
                                                                        <command value="\mbox">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <text value="ы"/>
                                                                            </braces>
                                                                          </braces>
                                                                          <braces/>
                                                                          <braces/>
                                                                        </command>
                                                                        <formula id="id17" value="$х рядов акселерометра: (\textit{а})~ходьба;&#10;(\textit{б})~подъем; (\textit{в})~спуск; (\textit{г})~сидение; &#10;(\textit{д})~стояние; (\textit{е})~лежание}&#10;\label{centroids_real}&#10;\vspace*{-0.15556pt}&#10;\end{figure*}&#10;&#10;%\end{multicols}&#10;&#10;&#10;%\begin{multicols}{2}&#10;&#10;Для проведения базового вычислительного эксперимента были подготовлены &#10;синтетические временн$\acute{\mbox{ы}}$е ряды, принадлежащие двум классам~\cite{Isachenko2015code}.&#10;&#10;Первый класс~--- синусы вида $\sin(x \hm+ b)$, где параметр~$b$ определяет сдвиг &#10;каждого временн$\acute{\mbox{о}}$го ряда.&#10;&#10;Второй класс~--- пилообразные функции с~различными сдвигами по временн$\acute{\mbox{о}}$й шкале.&#10;На каж\-дый временной ряд был наложен нормальный шум.&#10;Число временн$\acute{\mbox{ы}}$х рядов каждого клас\-са\;=\;60.&#10;Длина каждого временн$\acute{\mbox{о}}$го ряда $n \hm= 50$.&#10;%&#10;Построенные центроиды классов проиллюстрированы на рис.~1.&#10;Видно, что процедура корректно определяет сдвиги временн$\acute{\mbox{ы}}$х &#10;рядов.&#10;&#10;&#10;Чтобы убедиться в~целесообразности применения метрического обучения, данные&#10;временн$\acute{\mbox{ы}}$е\linebreak&#10; ряды классифицировались в~пространстве с~евклидовой метрикой &#10;и~в~пространстве с~мет\-ри\-кой Махаланобиса.&#10;Число ближайших соседей $k \hm= 5$; размерность преобразованного пространства &#10;$p \hm= 40$. Полученные ошибки классификации составили:&#10;\begin{itemize}&#10;\item евклидова метрика --- $27\%$;&#10;\item&#10;метрика Махаланобиса --- $6\%$.&#10;\end{itemize}&#10;&#10;\end{multicols}&#10;&#10;\begin{figure*}[b] %fig3&#10;\vspace*{-12pt}&#10; \begin{center}&#10; \mbox{%&#10; \epsfxsize=164.279mm&#10; \epsfbox{isa-3.eps}&#10; }&#10; \end{center}&#10; \vspace*{-9pt}&#10;    \Caption{Временн$"/>
                                                                        <command value="\acute">
                                                                          <braces>
                                                                            <braces>
                                                                              <text value="{}"/>
                                                                              <command value="\mbox">
                                                                                <braces>
                                                                                  <braces>
                                                                                    <text value="{}"/>
                                                                                    <text value="ы"/>
                                                                                  </braces>
                                                                                </braces>
                                                                                <braces/>
                                                                                <braces/>
                                                                              </command>
                                                                              <formula id="id18" value="$е ряды акселерометра:&#10;    (\textit{а})~ходьба;&#10;(\textit{б})~подъем; (\textit{в})~спуск; (\textit{г})~сидение; &#10;(\textit{д})~стояние; (\textit{е})~лежание}&#10;\label{raw_ts}&#10;%\vspace*{-12pt}&#10;\end{figure*}&#10;&#10;\begin{multicols}{2}&#10;&#10;&#10;&#10;&#10;Реальные данные~\cite{UCI_HarDataset} представляли собой вре\-мен\-н$\acute{\mbox{ы}}$е &#10;ряды  акселерометра мобильного телефона.&#10;Каж\-дый из шести классов соответствовал определенной физической активности испытуемых.&#10;Для проведения вычислительного эксперимента было выбрано по~200~объектов каж\-до\-го класса.&#10;Длина каж\-до\-го временн$\acute{\mbox{о}}$го ряда равнялась $n \hm= 128$ отсчетам времени.&#10;&#10;&#10;&#10;Построенные центроиды классов изображены на рис.~\ref{centroids_real}.&#10;Найденные центроиды обладают периодичностью, свойственной временн$\acute{\mbox{ы}}$м &#10;рядам &#10;по-\linebreak %\vspace*{-12pt}&#10;&#10;\columnbreak&#10;&#10;\noindent&#10;казаний активности человека.&#10;На рис.~\ref{raw_ts} показаны примеры временн$\acute{\mbox{ы}}$х рядов каждого класса. &#10;Эти же временн$\acute{\mbox{ы}}$е ряды после процедуры выравнивания относительно построенных &#10;центроидов изображены на рис.~\ref{aligned_ts}.&#10;&#10;&#10;&#10;&#10;Ошибка классификации без использования мет\-ри\-ческого обучения составила~37,5\%.&#10;Алгоритм LMNN позволяет настроить параметры: число ближайших соседей~$k$,&#10;размерность преобразованного евклидова пространства~$p$.&#10;Для выбора оптимальных параметров воспользуемся процедурой кросс-\linebreak %\vspace*{-12pt}&#10;&#10;\end{multicols}&#10;&#10;\begin{figure*}[b] %fig4&#10;\vspace*{-24pt}&#10; \begin{center}&#10; \mbox{%&#10; \epsfxsize=164.306mm&#10; \epsfbox{isa-4.eps}&#10; }&#10; \end{center}&#10; \vspace*{-9pt}&#10;    \Caption{Выравненные временн$"/>
                                                                              <command value="\acute">
                                                                                <braces>
                                                                                  <braces>
                                                                                    <text value="{}"/>
                                                                                    <command value="\mbox">
                                                                                      <braces>
                                                                                        <braces>
                                                                                          <text value="{}"/>
                                                                                          <text value="ы"/>
                                                                                        </braces>
                                                                                      </braces>
                                                                                      <braces/>
                                                                                      <braces/>
                                                                                    </command>
                                                                                    <formula id="id19" value="$е ряды акселерометра:&#10;    (\textit{а})~ходьба;&#10;(\textit{б})~подъем; (\textit{в})~спуск; (\textit{г})~сидение; &#10;(\textit{д})~стояние; (\textit{е})~лежание}&#10;\label{aligned_ts}&#10;%\vspace*{-12pt}&#10;\end{figure*}&#10;&#10;\pagebreak&#10;&#10;&#10;&#10;\begin{figure*} %fig5&#10;\vspace*{1pt}&#10; \begin{center}&#10; \mbox{%&#10; \epsfxsize=109.202mm&#10; \epsfbox{isa-5.eps}&#10; }&#10; \end{center}&#10; \vspace*{-9pt}&#10;    \Caption{Ошибка классификации в~зависимости от параметров}&#10;\label{heat_map}&#10;\vspace*{9pt}&#10;\end{figure*}&#10;&#10;%\pagebreak&#10;&#10;\begin{multicols}{2}&#10;&#10; &#10;&#10;\noindent&#10; про\-вер\-ки.&#10;На рис.~\ref{heat_map} показана ошибка классификации алгоритма &#10;в~зависимости от его параметров.&#10;На данной выборке алгоритм LMNN оказывается слабо чувствителен &#10;к~числу ближайших соседей,&#10;и~при уменьшении размерности пространства объектов ошибка классификации растет.&#10;&#10;&#10;Настроим алгоритм LMNN со следующими параметрами: число &#10;ближайших соседей $k \hm= 30$, размерность&#10;выходного пространства $p \hm= 128$.&#10;Ошибка&#10; классификации составила~17,25\%, что вдвое меньше ошибки классификации &#10;с~использованием евклидовой метрики.&#10;&#10;&#10;В табл.~1 представлены матрицы несоответствий &#10;результатов классификации при использовании&#10;евклидовой метрики и~метрики Махаланобиса.&#10;Столбцы соответствуют истинным меткам классов объектов, &#10;строки~--- предсказанным меткам.&#10;Диагональное преобладание матрицы несоответствий указывает на &#10;высокую предсказательную способность алгоритма.&#10;&#10;В табл.~\ref{improvement} продемонстрировано увеличение точности классификации &#10;при использовании в~качестве меры расстояния метрики Махаланобиса.&#10;Пересече\-ние $i$-го столбца и~$j$-й строки отвечает\linebreak изменению доли объектов класса~$i$, &#10;отнесенных к~классу~$j$. Положительное суммарное значе\-ние диагональных элементов &#10;таблицы соответствует увеличению качества классификации. Значительное улучшение &#10;предсказания происходит при классификации первых трех классов.&#10;Данные клас-\linebreak&#10;&#10;\noindent&#10; \begin{center}  %tabl&#10; \vspace*{-12pt}&#10;{{\tablename~1}\ \ \small{Матрицы несоответствий}}&#10;&#10;{\small &#10;\tabcolsep=4pt&#10;\begin{tabular}{|c|c|c|c|c|c|c|}&#10;\multicolumn{7}{c}{\ }\\[-6pt]&#10;    \hline&#10; Предсказанные&amp;amp; \multicolumn{6}{c|}{Истинные метки классов}\\&#10;  \cline{2-7}&#10;   метки&amp;amp; 1  &amp;amp; 2  &amp;amp; 3  &amp;amp; 4  &amp;amp; 5  &amp;amp; 6  \\ &#10;   \hline&#10;   \multicolumn{7}{|c|}{Евклидова метрика}\\&#10;   \hline&#10;1  &amp;amp; 80\hphantom{9} &amp;amp; \hphantom{9}0  &amp;amp; \hphantom{9}5  &amp;amp; \hphantom{9}0  &amp;amp; \hphantom{9}0  &amp;amp; \hphantom{9}0   \\&#10;%\hline&#10;2  &amp;amp; 4  &amp;amp; 56 &amp;amp; 33 &amp;amp; \hphantom{9}0  &amp;amp; \hphantom{9}0  &amp;amp; \hphantom{9}0  \\&#10;%\hline&#10;3  &amp;amp; 5  &amp;amp; \hphantom{9}5  &amp;amp; 86 &amp;amp; \hphantom{9}0  &amp;amp; \hphantom{9}0  &amp;amp; \hphantom{9}0\\&#10;%\hline&#10;4  &amp;amp; 7  &amp;amp; \hphantom{9}8  &amp;amp; \hphantom{9}5  &amp;amp; 168\hphantom{9}&amp;amp; \hphantom{9}4  &amp;amp; 21 \\&#10;%\hline&#10;5  &amp;amp; 51\hphantom{9} &amp;amp; 61 &amp;amp; 57 &amp;amp; 12 &amp;amp; 192\hphantom{9}&amp;amp; 11 \\&#10;%\hline&#10;6  &amp;amp; 53\hphantom{9} &amp;amp; 70 &amp;amp; 14 &amp;amp; 20 &amp;amp; \hphantom{9}2  &amp;amp; 168\hphantom{9}\\&#10;\hline&#10;\multicolumn{7}{|c|}{Метрика Махаланобиса}\\&#10;\hline&#10;1&amp;amp; 151\hphantom{9} &amp;amp; 12 &amp;amp; 13    &amp;amp; \hphantom{9}0     &amp;amp; \hphantom{9}0    &amp;amp; \hphantom{9}0 \\ &#10;%\hline&#10;  2  &amp;amp; 10  &amp;amp; 142\hphantom{9}&amp;amp; 14    &amp;amp; \hphantom{9}0     &amp;amp; \hphantom{9}0    &amp;amp; \hphantom{9}0 \\ &#10;%  \hline&#10;  3  &amp;amp; \hphantom{9}9   &amp;amp; 10 &amp;amp; 171\hphantom{9}   &amp;amp; \hphantom{9}0     &amp;amp; \hphantom{9}0    &amp;amp; \hphantom{9}0 \\&#10;%  \hline&#10;   4  &amp;amp; 10  &amp;amp; \hphantom{9}7  &amp;amp; \hphantom{9}0     &amp;amp; 173\hphantom{9}   &amp;amp; \hphantom{9}9    &amp;amp; 21\\  &#10;%   \hline&#10;     5  &amp;amp; \hphantom{9}2   &amp;amp; 11 &amp;amp; \hphantom{9}0     &amp;amp; 12    &amp;amp; 186\hphantom{9}  &amp;amp; \hphantom{9}9 \\ &#10;%     \hline&#10;       6  &amp;amp; 18  &amp;amp; 18 &amp;amp; \hphantom{9}2     &amp;amp; 15    &amp;amp; \hphantom{9}5    &amp;amp; 170\hphantom{9}\\ &#10;\hline&#10;\end{tabular}}&#10;\end{center} &#10;&#10; \vspace*{9pt}&#10; &#10; \noindent&#10; сы соответствуют следующим видам физической активности: ходьба, &#10;подъем, спуск.&#10;&#10;&#10;&#10;&#10;\addtocounter{table}{1}&#10;&#10;&#10;\begin{table*}\small&#10;\begin{center}&#10;\parbox{348pt}{\Caption{Увеличение точности классификации при использовании адекватной оценки матрицы трансформаций}&#10;\label{improvement}&#10;&#10;}&#10;&#10;\begin{tabular}{|c|r|r|c|c|c|c|}&#10;\multicolumn{7}{c}{\ }\\[-4pt]&#10;\hline&#10;\multicolumn{1}{|c|}{Предсказанные}&amp;amp; \multicolumn{6}{c|}{Истинные метки классов}       \\ &#10;\cline{2-7}&#10;\multicolumn{1}{|c|}{метки}    &amp;amp; \multicolumn{1}{c|}{1} &amp;amp; \multicolumn{1}{c|}{2} &amp;amp; 3 &amp;amp; 4 &amp;amp; 5 &amp;amp; 6\\ &#10;    \hline&#10;1 &amp;amp; $\mathbf{0{,}355}$&amp;amp; 0,06\hphantom{9,} &amp;amp; \hphantom{$"/>
                                                                                    <text value="-"/>
                                                                                    <formula id="id20" value="$}0,04\hphantom{9} &amp;amp; 0 &amp;amp; 0\hphantom{,999}&amp;amp; 0\hphantom{9}     \\ &#10;%\hline&#10;2 &amp;amp; 0,03\hphantom{9,}   &amp;amp; $\mathbf{0{,}43}$\hphantom{9}   &amp;amp; $-0{,}095$ &amp;amp; 0&amp;amp; 0\hphantom{,999} &amp;amp; 0\hphantom{9} \\ &#10;%\hline&#10;3 &amp;amp; 0,02\hphantom{9,}   &amp;amp; 0,025\hphantom{,}  &amp;amp; \hphantom{9,}$\mathbf{0{,}425}$  &amp;amp; 0  &amp;amp; 0\hphantom{,999} &amp;amp; 0\hphantom{9}\\ &#10;%\hline&#10;4 &amp;amp; 0,015\hphantom{,}  &amp;amp; $-0{,}005$\hphantom{,} &amp;amp; $-0{,}025$ &amp;amp; \hphantom{9.9.9}$\mathbf{0{,}025}$ &amp;amp; 0,025 &amp;amp; 0\hphantom{9}\\ &#10;%\hline&#10;5 &amp;amp; $-0{,}245$\hphantom{,} &amp;amp; $-0{,}25$\hphantom{9,}  &amp;amp; $-0{,}28$\hphantom{9}  &amp;amp; 0 &amp;amp; $\mathbf{-0{,}03}$\hphantom{99} &amp;amp; $-0{,}01$ \\ &#10;%\hline&#10;6 &amp;amp; $-0{,}175$\hphantom{,} &amp;amp; $-0{,}26$\hphantom{9,}  &amp;amp; $-0{,}06$\hphantom{9}  &amp;amp; \hphantom{$"/>
                                                                                    <text value="-"/>
                                                                                    <formula id="id21" value="$,}$-0{,}025$ &amp;amp; 0,005 &amp;amp; $\mathbf{-0{,}01}$ \\ &#10;\hline&#10;\end{tabular}&#10;\end{center}&#10;\end{table*}&#10;&#10;\vspace*{-6pt}&#10;&#10;\section{Заключение}&#10;&#10;В данной работе предложен новый подход к~решению задачи многоклассовой &#10;классификации временн$\acute{\mbox{ы}}$х рядов.&#10;Сравнивались результаты классификации множества временн$\acute{\mbox{ы}}$х рядов, &#10;основанных на измерении расстояний&#10;с помощью евклидовой метрики и~обученной метрики Махаланобиса.&#10;Проведен вычислительный эксперимент на реальных данных показаний &#10;акселерометра мобильного телефона.&#10;Построенная модель классификации показала высокое качество распознавания &#10;активности человека по форме сигнала акселерометра.&#10;&#10;&#10;{\small\frenchspacing&#10; {%\baselineskip=10.8pt&#10; \addcontentsline{toc}{section}{References}&#10; \begin{thebibliography}{99}&#10;&#10;\bibitem{popova2015multiclass}&#10;\Au{Попова~М.\,С., Стрижов~В.\,В.}&#10;Выбор оптимальной модели классификации физической активности по&#10;измерениям акселерометра~// Информатика и~её применения,&#10;2015. Т.~9. Вып.~1. С.~79--89.&#10;&#10;\bibitem{ignatov2015multiclass}&#10;\Au{Ignatov~A.\,D., Strijov~V.\,V.}&#10;Human activity recognition using quasiperiodic time series collected&#10;  from a~single tri-axial accelerometer~// Multimed. Tools  Appl., 2015. 14~p.&#10;  doi: 10.1007/s11042-015-26430.&#10;&#10;\bibitem{guler2007mccsvm}&#10;\Au{G$\ddot{\mbox{u}}$ler~I., $\ddot{\mbox{\!U}}$beyli~E.~D.}&#10;Multiclass support vector machines for eeg-signals classification~//&#10;IEEE Trans. Inf. Technol. Biomedicine, 2007. Vol.~11. No.\,2. P.~117--126.&#10;&#10;\bibitem{ubeyli2007mccsvm2}&#10;\Au{$\ddot{\mbox{U}}$beyli~E.\,D.}&#10;Ecg beats classification using multiclass support vector machines&#10;  with error correcting output codes~// Digit. Signal Process., 2007. Vol.~17. No.\,3. P.~675--684.&#10;&#10;\bibitem{anand1995mccnn}&#10;\Au{Anand~R., Mehrotra~K., Mohan~C.~K., Ranka~S.}&#10;Efficient classification for multiclass problems using modular neural&#10;  networks~// IEEE Trans. Neural Networ., 1995. Vol.~6. No.\,1. P.~117--124.&#10;&#10;\bibitem{kafai2012mccbn}&#10;\Au{Kafai~M., Bhanu~B.}&#10;Dynamic bayesian networks for vehicle classification in video~// IEEE Trans. &#10;Ind. Inform., 2012. Vol.~8. No.\,1. P.~100--109.&#10;&#10;\bibitem{chaovalitwongse2007knn}&#10;\Au{Chaovalitwongse~W.\,A., Fan~Y.-J., Sachdeo~R.\,C.}&#10;On the time series $k$-nearest neighbor classification of abnormal&#10;  brain activity~// IEEE Trans. Syst. Man  Cy. A,&#10;2007. Vol.~37. No.\,6. P.~1005--1016.&#10;&#10;\bibitem{yang2006mlsurvey2} %8&#10;\Au{Yang~L., Jin~R.}&#10;Distance metric learning: A~comprehensive survey.~--- &#10;Michigan State University, 2006. Vol.~2. 51~p.&#10;&#10;\bibitem{bellet2013mlsurvey} %9&#10;\Au{Bellet~A., Habrard~A., Sebban~M.}&#10;A~survey on metric learning for feature vectors and structured data.&#10;arXiv preprint arXiv:1306.6709, 2013.&#10;&#10;&#10;&#10;\bibitem{wang2015mlsurvey3}&#10;\Au{Wang~F., Sun~J.}&#10;Survey on distance metric learning and dimensionality reduction in data mining~//&#10;Data Min. Knowl. Disc., 2015. Vol.~29. No.\,2. P.~534--564.&#10;&#10;\bibitem{mcfee2010mlranking}&#10;\Au{McFee~B., Lanckriet~G.\,R.}&#10;Metric learning to rank~// 27th  Conference (International) on Machine&#10;  Learning Proceedings, 2010. P.~775--782.&#10;&#10;\bibitem{guillaumin2009mlface}&#10;\Au{Guillaumin~M., Verbeek~J., Schmid~C.}&#10;Is that you? Metric learning approaches for face identification~// &#10;IEEE 12th  Conference (International) on Computer Vision Proceedings.~--- IEEE, 2009. P.~498--505.&#10;&#10;\bibitem{weinberger2008mldigits}&#10;\Au{Weinberger~K.\,Q., Saul~L.\,K.}&#10;Fast solvers and efficient implementations for distance metric&#10;  learning~// 25th  Conference (International) on Machine&#10;Learning Proceedings, 2008. P.~1160--1167.&#10;&#10;\bibitem{weinberger2005lmnn}&#10;\Au{Weinberger~K.\,Q., Blitzer~J., Saul~L.\,K.}&#10;Distance metric learning for large margin nearest neighbor&#10;  classification~// Advances in&#10;  Neural Information Processing Systems.~--- Cambridge, MA,&#10;  USA: MIT Press, 2006. P.~1473--1480.&#10;&#10;\bibitem{berndt1994dtw}&#10;\Au{Berndt~D.\,J., Clifford~J.}&#10;Using dynamic time warping to find patterns in time series~// KDD Workshop, &#10;1994. Vol.~10. No.\,16. P.~359--370.&#10;&#10;\bibitem{petitjean2011dba}&#10;\Au{Petitjean~F., Ketterlin~A., \mbox{Gan\!{\!\ptb{\c{c}}}arski}~P.}&#10;A~global averaging method for dynamic time warping, with applications&#10;  to clustering~// Pattern Recogn., 2011. Vol.~44. No.\,3. P.~678--693.&#10;&#10;\bibitem{goncharov2015cost}&#10;\Au{Гончаров~А.\,В., Попова~М.\,С., Стрижов~В.\,В.}&#10;Метрическая классификация временных рядов с~выравниванием&#10;  относительно центроидов классов~// Системы &#10;  и~средства информатики, 2015. Т.~25. №\,4. С.~52--64.&#10;&#10;\bibitem{vandenberghe1996semidefinite}&#10;\Au{Vandenberghe~L., Boyd~S.}&#10;Semidefinite programming // SIAM Rev., 1996. Vol.~38. No.\,1. P.~49--95.&#10;&#10;\bibitem{Isachenko2015code}&#10;\Au{Исаченко~Р.\,В.}&#10;Реализация алгоритма классификации временных рядов~// Sourceforge.net, 2015.&#10;{\sf http://sourceforge.net/p/mlalgorithms/code/HEAD/\linebreak tree/Group274/Isachenko2015TimeSeries/code}.&#10;&#10;&#10;\bibitem{UCI_HarDataset}&#10;UCI repository. Human activity recognition using smartphones dataset.&#10;{\sf https://archive.ics.uci.edu/\linebreak ml/datasets/Human+Activity+Recognition+Using+\linebreak Smartphones}.&#10;\end{thebibliography}&#10;&#10; }&#10; }&#10;&#10;\end{multicols}&#10;&#10;\vspace*{-3pt}&#10;&#10;\hfill{\small\textit{Поступила в~редакцию 18.03.16}}&#10;&#10;%\vspace*{8pt}&#10;&#10;\newpage&#10;&#10;\vspace*{-24pt}&#10;&#10;%\hrule&#10;&#10;%\vspace*{2pt}&#10;&#10;%\hrule&#10;&#10;%\vspace*{8pt}&#10;&#10;&#10;&#10;\def\tit{METRIC LEARNING IN~MULTICLASS TIME SERIES CLASSIFICATION PROBLEM}&#10;&#10;\def\titkol{Metric learning in multiclass time series classification problem}&#10;&#10;\def\aut{R.\,V.~Isachenko$"/>
                                                                                    <text value="^1"/>
                                                                                    <formula id="id22" value="$ and V.\,V.~Strijov$"/>
                                                                                    <text value="^2"/>
                                                                                    <formula id="id23" value="$}&#10;&#10;\def\autkol{R.\,V.~Isachenko and V.\,V.~Strijov}&#10;&#10;\titel{\tit}{\aut}{\autkol}{\titkol}&#10;&#10;\vspace*{-9pt}&#10;&#10;\noindent&#10;$^1$Moscow Institute of Physics and Technology, &#10; 9~Institutskiy Institutskiy Per., Dolgoprudny, Moscow Region\linebreak&#10; $\hphantom{^1}$141700,  Russian Federation&#10;&#10;\noindent&#10;$^2$A.\,A.~Dorodnicyn Computing Centre, Federal Research Center &#10;``Computer Science and Control&amp;apos;&amp;apos; of the Russian\linebreak&#10;  $\hphantom{^1}$Academy of Sciences, &#10;40~Vavilov Str., Moscow 119333, Russian Federation&#10;\def\leftfootline{\small{\textbf{\thepage}&#10;\hfill INFORMATIKA I EE PRIMENENIYA~--- INFORMATICS AND&#10;APPLICATIONS\ \ \ 2016\ \ \ volume~10\ \ \ issue\ 2}&#10;}%&#10; \def\rightfootline{\small{INFORMATIKA I EE PRIMENENIYA~---&#10;INFORMATICS AND APPLICATIONS\ \ \ 2016\ \ \ volume~10\ \ \ issue\ 2&#10;\hfill \textbf{\thepage}}}&#10;&#10;\vspace*{3pt}&#10;&#10;&#10;&#10;&#10;\Abste{This paper is devoted to the problem of multiclass time series classification.&#10;    It is proposed to align time series in relation to class centroids.&#10;    Building of centroids and alignment of time series is carried out by &#10;    the dynamic time warping algorithm.&#10;    The accuracy of classification depends significantly on the metric used to compute distances between time series.&#10;   The distance metric learning approach is used to improve classification accuracy.&#10;    The metric learning procedure modifies distances between objects to make objects from the same cluster closer&#10;    and from the different clusters more distant.&#10;    The distance between time series is measured by the Mahalanobis metric.&#10;    The distance metric learning procedure finds the optimal transformation matrix for &#10;    the Mahalanobis metric.&#10;    To calculate quality of classification,&#10;    a~computational experiment on synthetic data and&#10;    real data of human activity recognition was carried out.}&#10;&#10;\KWE{time series classification; time series alignment; distance metric learning; LMNN algorithm}&#10;&#10;\DOI{10.14357/19922264160205}&#10;&#10;%\vspace*{-12pt}&#10;&#10;\Ack&#10;\noindent&#10;The work was financially supported by the Russian Foundation&#10;for Basic Research (project 16-07-01158).&#10;&#10;&#10;%\vspace*{3pt}&#10;&#10;  \begin{multicols}{2}&#10;&#10;\renewcommand{\bibname}{\protect\rmfamily References}&#10;%\renewcommand{\bibname}{\large\protect\rm References}&#10;&#10;{\small\frenchspacing&#10; {%\baselineskip=10.8pt&#10; \addcontentsline{toc}{section}{References}&#10; \begin{thebibliography}{99}&#10;&#10;\bibitem{1-is}&#10;\Aue{Popova, M.\,S., and V.\,V.~Strijov}.&#10;2015.&#10;Vybor optimal&amp;apos;noy modeli klassifikatsii fizicheskoy aktivnosti po izmereniyam&#10;  akselerometra [Selection of optimal physical activity&#10;  classification model using measurements of accelerometer].&#10;\textit{Informatika i ee primeneniya}~--- \textit{Inform. Appl}.&#10;9(1):79--89.&#10;&#10;\bibitem{2-is}&#10;\Aue{Ignatov, A.\,D., and V.\,V.~Strijov}.&#10;2015.&#10;Human activity recognition using quasiperiodic time series collected from &#10;a~single tri-axial accelerometer.&#10;\textit{Multimed. Tools  Appl}. 14~p.&#10;  doi: 10.1007/s11042-015-26430.&#10;&#10;\bibitem{3-is}&#10;\Aue{G$\ddot{\mbox{u}}$ler, I., and E.\,D.~$\ddot{\mbox{U}}$beyli}.&#10;2007.&#10;Multiclass support vector machines for eeg-signals classification.&#10;\textit{IEEE Trans. Inf. Technol. Biomedicine}&#10;11(2):117--126.&#10;&#10;\bibitem{4-is}&#10;\Aue{$\ddot{\mbox{U}}$beyli, E.\,D.}&#10;2007.&#10;Ecg beats classification using multiclass support vector machines with error&#10;  correcting output codes.&#10;\textit{Digit. Signal Process.} 17(3):675--684.&#10;&#10;\bibitem{5-is}&#10;\Aue{Anand, R., K.~Mehrotra, C.~K. Mohan,  and S.~Ranka}.&#10;1995.&#10;Efficient classification for multiclass problems using modular neural networks.&#10;\textit{IEEE Trans. Neural Networ.} 6(1):117--124.&#10;&#10;\bibitem{6-is}&#10;\Aue{Kafai, M., and B.~Bhanu.}&#10;2012. Dynamic bayesian networks for vehicle classification in video.&#10;\textit{IEEE Trans. Ind. Inform.} 8(1):100--109.&#10;&#10;\bibitem{7-is}&#10;\Aue{Chaovalitwongse, W.\,A., Y.-J.~Fan,  and R.\,C.~Sachdeo.}&#10;2007. On the time series $k$-nearest neighbor classification of abnormal brain&#10;  activity.&#10;\textit{IEEE Trans. Syst. Man Cy. A}&#10;37(6):1005--1016.&#10;&#10;&#10;&#10;\bibitem{9-is} %8&#10;\Aue{Yang, L., and R.~Jin.}&#10;2006.&#10;\textit{Distance metric learning: A~comprehensive survey}.&#10;{Michigan State University}. Vol.~2. 51~p.&#10;&#10;\bibitem{8-is} %9&#10;\Aue{Bellet, A., A.~Habrard,  and M.~Sebban.}&#10;2013.&#10;A survey on metric learning for feature vectors and structured data.&#10;{arXiv preprint arXiv:1306.6709}.&#10;&#10;\bibitem{10-is}&#10;\Aue{Wang, F., and J.~Sun.}&#10;2015.&#10;Survey on distance metric learning and dimensionality reduction in data mining.&#10;\textit{Data Min. Knowl. Disc.} 29(2):534--564.&#10;&#10;\bibitem{11-is}&#10;\Aue{McFee, B., and G.\,R.~Lanckriet.}&#10;2010.&#10;Metric learning to rank.&#10;\textit{27th  Conference (International) on Machine Learning Proceedings}.&#10;775--782.&#10;&#10;\bibitem{12-is}&#10;\Aue{Guillaumin, M., J.~Verbeek,  and C.~Schmid.}&#10;2009.&#10;Is that you? Metric learning approaches for face identification.&#10;\textit{IEEE 12th Conference (International) on Computer Vision}.&#10;498--505.&#10;&#10;\bibitem{13-is}&#10;\Aue{Weinberger, K.\,Q., and L.\,K.~Saul.}&#10;2008.&#10;Fast solvers and efficient implementations for distance metric learning.&#10;\textit{25th  Conference (International) on Machine Learning Proceedings}.&#10;1160--1167.&#10;&#10;\bibitem{14-is}&#10;\Aue{Weinberger, K.\,Q., J.~Blitzer,  and L.\,K.~Saul}.&#10;2005.&#10;Distance metric learning for large margin nearest neighbor classification.&#10;\textit{Advances in neural information processing systems}.&#10;Cambridge, MA: MIT Press. 1473--1480.&#10;&#10;\bibitem{15-is}&#10;\Aue{Berndt, D.\,J., and J.~Clifford}.&#10;1994.&#10;Using dynamic time warping to find patterns in time series.&#10;\textit{KDD Workshop}. 10(16):359--370.&#10;&#10;\bibitem{16-is}&#10;\Aue{Petitjean, F., A.~Ketterlin,  and P.~\mbox{Gan{\!\ptb{\c{c}}}arski}}.&#10;2011.&#10;A~global averaging method for dynamic time warping, with applications to&#10;  clustering.&#10;\textit{Pattern Recogn.} 44(3):678--693.&#10;&#10;\bibitem{17-is}&#10;\Aue{Goncharov, A.\,B., M.\,S.~Popova, and V.\,V.~Strijov}.&#10;2015.&#10;Metricheskaya klassifikatsiya vremennykh ryadov s~vyravnivaniem otnositel&amp;apos;no&#10;  tsentroidov klassov [Metric time series classification using&#10;  dynamic warping relative to centroids of classes].&#10;\textit{Sistemy i~Sredstva Informatiki}~--- \textit{Systems and Means of Informatics}&#10;25(4):52--64.&#10;&#10;\bibitem{18-is}&#10;\Aue{Vandenberghe, L.,  and S.~Boyd}.&#10;1996.&#10;Semidefinite programming.&#10;\textit{SIAM Rev.} 38(1):49--95.&#10;&#10;\bibitem{19-is}&#10;\Aue{Isachenko,~R.\,V.} 2015.&#10;Project code. \textit{Sourceforge.net.} &#10;Available at:&#10;{\sf https://sourceforge.net/p/mlalgorithms/\linebreak &#10;code/HEAD/tree/Group274/Isachenko2015TimeSeries\linebreak /code/}&#10;(accessed March~18, 2016).&#10;&#10;\bibitem{20-is}&#10;UCI repository. Human activity recognition using smartphones dataset.&#10;Available at:&#10;{\sf https://archive.ics. uci.edu/ml/datasets/Human+Activity+Recognition+\linebreak Using+Smartphones}&#10;(accessed March~18, 2016).&#10;\end{thebibliography}&#10;&#10; }&#10; }&#10;&#10;\end{multicols}&#10;&#10;\vspace*{-3pt}&#10;&#10;\hfill{\small\textit{Received March 18, 2016}}&#10;&#10;&#10;\Contr&#10;&#10;\noindent&#10;\textbf{Isachenko Roman V.} (b.\ 1994)~---&#10; student, Moscow Institute of Physics and Technology, &#10; 9~Institutskiy Institutskiy Per., Dolgoprudny, Moscow Region 141700, &#10; Russian Federation;   \mbox{isa-ro@yandex.ru}&#10;&#10;&#10;&#10;&#10;\vspace*{3pt}&#10;&#10;\noindent&#10;\textbf{Strijov Vadim V.} (b.\ 1967)~---&#10;Doctor of Science in physics and mathematics, leading scientist, &#10;A.\,A.~Dorodnicyn Computing Centre, Federal Research Center &#10;``Computer Science and Control&amp;apos;&amp;apos; of the Russian Academy of Sciences, &#10;40~Vavilov Str., Moscow 119333, Russian Federation; \mbox{strijov@ccas.ru}&#10;&#10;&#10;\label{end\stat}&#10;&#10;&#10;\renewcommand{\bibname}{\protect\rm Литература}"/>
                                                                                  </braces>
                                                                                </braces>
                                                                              </command>
                                                                            </braces>
                                                                          </braces>
                                                                        </command>
                                                                      </braces>
                                                                    </braces>
                                                                  </command>
                                                                </braces>
                                                              </braces>
                                                            </command>
                                                          </braces>
                                                        </braces>
                                                      </command>
                                                    </braces>
                                                  </braces>
                                                </command>
                                              </braces>
                                            </braces>
                                          </command>
                                        </braces>
                                      </braces>
                                    </command>
                                  </braces>
                                </braces>
                              </command>
                            </braces>
                          </braces>
                        </command>
                      </braces>
                    </braces>
                  </command>
                </braces>
              </braces>
            </command>
          </braces>
        </braces>
      </command>
    </fulltext>
  </paper>
</papers>